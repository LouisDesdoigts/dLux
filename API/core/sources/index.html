
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for dLux.">
      
      
        <meta name="author" content="Louis Desdoigts">
      
      
        <link rel="canonical" href="https://louisdesdoigts.github.io/dlux/API/core/sources/">
      
      
        <link rel="prev" href="../spectra/">
      
      
        <link rel="next" href="../psfs/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Sources - dLux</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sources" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dLux" class="md-header__button md-logo" aria-label="dLux" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.9 8.9-1.7 1-4-6.9 1.7-1 4 6.9m-12.1-1 3 5.2 6.1-3.5-3-5.2-6.1 3.5m1.6 4.8-2-3.5-4.3 2.5 2 3.5 4.3-2.5m-9.3 1.9 1 1.7 2.6-1.5-1-1.7-2.6 1.5m10-.6-.3-.4-4.3 2.5.3.4c.2.3.5.6.8.8L7 22h2l1.4-4.3h.1L12 22h2l-1.9-5.6c.5-.7.5-1.6 0-2.4Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dLux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sources
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dLux" class="md-nav__button md-logo" aria-label="dLux" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.9 8.9-1.7 1-4-6.9 1.7-1 4 6.9m-12.1-1 3 5.2 6.1-3.5-3-5.2-6.1 3.5m1.6 4.8-2-3.5-4.3 2.5 2 3.5 4.3-2.5m-9.3 1.9 1 1.7 2.6-1.5-1-1.7-2.6 1.5m10-.6-.3-.4-4.3 2.5.3.4c.2.3.5.6.8.8L7 22h2l1.4-4.3h.1L12 22h2l-1.9-5.6c.5-.7.5-1.6 0-2.4Z"/></svg>

    </a>
    dLux
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introductory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Introductory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/introductory/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A Basic Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/introductory/optical_systems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optical Systems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/introductory/sources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sources & Spectra
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How-To's
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            How-To's
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/howtos/dLux_objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with dLux objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/howtos/custom_apertures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Apertures
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/examples/phase_retrieval_demo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phase Retrieval
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/examples/designing_a_mask/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phase Mask Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/examples/flatfield_calibration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pixel Level Calibration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/examples/fisher_information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fisher Information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/examples/HMC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameter Inference
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Core API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wavefronts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavefronts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optical_systems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optical Systems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spectra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spectra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Sources
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Sources
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSource" class="md-nav__link">
    <span class="md-ellipsis">
      PointSource
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSource.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSource.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSources" class="md-nav__link">
    <span class="md-ellipsis">
      PointSources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSources.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSources.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.BinarySource" class="md-nav__link">
    <span class="md-ellipsis">
      BinarySource
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.BinarySource.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.BinarySource.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.ResolvedSource" class="md-nav__link">
    <span class="md-ellipsis">
      ResolvedSource
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.ResolvedSource.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.ResolvedSource.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.ResolvedSource.normalise" class="md-nav__link">
    <span class="md-ellipsis">
      normalise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointResolvedSource" class="md-nav__link">
    <span class="md-ellipsis">
      PointResolvedSource
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointResolvedSource.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointResolvedSource.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene" class="md-nav__link">
    <span class="md-ellipsis">
      Scene
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene.normalise" class="md-nav__link">
    <span class="md-ellipsis">
      normalise
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../psfs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PSFs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../detectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detectors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../instruments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instruments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Layers API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Layers API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/optical_layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optical Layers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/optics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/propagators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Propagators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/apertures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apertures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/aberrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aberrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/detector_layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detector Layers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../layers/unified_layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unified Layers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Utils API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/array_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Array Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coordinates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/helpers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Helpers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/interpolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interpolation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Math
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/propagation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Propagation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/source/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Source
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/units/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Units
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/zernikes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zernikes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ & Troubleshooting
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change Log
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSource" class="md-nav__link">
    <span class="md-ellipsis">
      PointSource
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSource.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSource.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSources" class="md-nav__link">
    <span class="md-ellipsis">
      PointSources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSources.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointSources.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.BinarySource" class="md-nav__link">
    <span class="md-ellipsis">
      BinarySource
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.BinarySource.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.BinarySource.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.ResolvedSource" class="md-nav__link">
    <span class="md-ellipsis">
      ResolvedSource
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.ResolvedSource.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.ResolvedSource.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.ResolvedSource.normalise" class="md-nav__link">
    <span class="md-ellipsis">
      normalise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointResolvedSource" class="md-nav__link">
    <span class="md-ellipsis">
      PointResolvedSource
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointResolvedSource.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.PointResolvedSource.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene" class="md-nav__link">
    <span class="md-ellipsis">
      Scene
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.sources.Scene.normalise" class="md-nav__link">
    <span class="md-ellipsis">
      normalise
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="sources">Sources</h1>
<details class="info" open="open">
<summary>PointSource</summary>


<div class="doc doc-object doc-class">



<a id="dLux.sources.PointSource"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dLux.sources.Source">Source</span></code></p>


      <p>A simple point source with a spectrum, position and flux.</p>
<details class="abstract">
<summary>UML</summary>
<p><img alt="UML" src="../../../assets/uml/PointSource.png" /></p>
</details>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointSource.position">position</span></code></td>
            <td>
                  <code>(<span title="jax.Array">Array</span>, radians)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The (x, y) on-sky position of this object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointSource.flux">flux</span></code></td>
            <td>
                  <code>(float, photons)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flux of the object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointSource.spectrum">spectrum</span></code></td>
            <td>
                  <code><span title="dLux.sources.Spectrum">Spectrum</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/dLux/sources.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PointSource</span><span class="p">(</span><span class="n">Source</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simple point source with a spectrum, position and flux.</span>

<span class="sd">    ??? abstract &quot;UML&quot;</span>
<span class="sd">        ![UML](../../assets/uml/PointSource.png)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : float, photons</span>
<span class="sd">        The flux of the object.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">position</span><span class="p">:</span> <span class="n">Array</span>
    <span class="n">flux</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelengths : Array, metres = None</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined. This input is</span>
<span class="sd">            ignored if a Spectrum object is provided.</span>
<span class="sd">        position : Array, radians = np.zeros(2)</span>
<span class="sd">            The (x, y) on-sky position of this object.</span>
<span class="sd">        flux : float, photons = 1.</span>
<span class="sd">            The flux of the object.</span>
<span class="sd">        spectrum : Spectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Position and Flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">flux</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;position must be a 1d array of shape (2,).&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">,</span>
        <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Models the source object through the provided optics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source object.</span>
<span class="sd">        return_wf : bool = False</span>
<span class="sd">            Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">        return_psf : bool = False</span>
<span class="sd">            Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object : Array, Wavefront, PSF</span>
<span class="sd">            if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">            if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">                object.</span>
<span class="sd">            if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span>
        <span class="k">return</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">return_wf</span><span class="p">,</span> <span class="n">return_psf</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dLux.sources.PointSource.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">flux</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>wavelengths</code></td>
            <td>
                  <code>Array, metres = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of wavelengths at which the spectrum is defined. This input is
ignored if a Spectrum object is provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>position</code></td>
            <td>
                  <code>Array, radians = np.zeros(2)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The (x, y) on-sky position of this object.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.zeros">zeros</span>(2)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>flux</code></td>
            <td>
                  <code>float, photons = 1.</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flux of the object.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>spectrum</code></td>
            <td>
                  <code>Spectrum = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelengths : Array, metres = None</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined. This input is</span>
<span class="sd">        ignored if a Spectrum object is provided.</span>
<span class="sd">    position : Array, radians = np.zeros(2)</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : float, photons = 1.</span>
<span class="sd">        The flux of the object.</span>
<span class="sd">    spectrum : Spectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Position and Flux</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">flux</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;position must be a 1d array of shape (2,).&quot;</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.PointSource.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_psf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Models the source object through the provided optics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>optics</code></td>
            <td>
                  <code><span title="dLux.sources.Optics">Optics</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optics through which to model the source object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_wf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the Wavefront object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_psf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the PSF object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>object</code></td>            <td>
                  <code>(<span title="jax.Array">Array</span>, <a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="../wavefronts/#dLux.wavefronts.Wavefront">Wavefront</a>, <a class="autorefs autorefs-internal" title="dLux.psfs.PSF" href="../psfs/#dLux.psfs.PSF">PSF</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>return_wf</code> is False and <code>return_psf</code> is False, returns the psf Array.
if <code>return_wf</code> is True and <code>return_psf</code> is False, returns the Wavefront
    object.
if <code>return_wf</code> is False and <code>return_psf</code> is True, returns the PSF object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">,</span>
    <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Models the source object through the provided optics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source object.</span>
<span class="sd">    return_wf : bool = False</span>
<span class="sd">        Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">    return_psf : bool = False</span>
<span class="sd">        Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object : Array, Wavefront, PSF</span>
<span class="sd">        if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">        if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">            object.</span>
<span class="sd">        if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span>
    <span class="k">return</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">return_wf</span><span class="p">,</span> <span class="n">return_psf</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></details>
<details class="info" open="open">
<summary>PointSources</summary>


<div class="doc doc-object doc-class">



<a id="dLux.sources.PointSources"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dLux.sources.Source">Source</span></code></p>


      <p>A set of point sources with the same spectrum, but different positions and fluxes.</p>
<details class="abstract">
<summary>UML</summary>
<p><img alt="UML" src="../../../assets/uml/PointSources.png" /></p>
</details>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointSources.position">position</span></code></td>
            <td>
                  <code>(<span title="jax.Array">Array</span>, radians)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ((x0, y0), (x1, y1), ...) on-sky positions of these sources.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointSources.flux">flux</span></code></td>
            <td>
                  <code>(<span title="jax.Array">Array</span>, photons)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fluxes of the sources.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointSources.spectrum">spectrum</span></code></td>
            <td>
                  <code><span title="dLux.sources.Spectrum">Spectrum</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/dLux/sources.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PointSources</span><span class="p">(</span><span class="n">Source</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of point sources with the same spectrum, but different positions and fluxes.</span>

<span class="sd">    ??? abstract &quot;UML&quot;</span>
<span class="sd">        ![UML](../../assets/uml/PointSources.png)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The ((x0, y0), (x1, y1), ...) on-sky positions of these sources.</span>
<span class="sd">    flux : Array, photons</span>
<span class="sd">        The fluxes of the sources.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">position</span><span class="p">:</span> <span class="n">Array</span>
    <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelengths : Array, metres</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">        position : Array, radians = np.zeros((1, 2))</span>
<span class="sd">            The (x, y) on-sky position of this object.</span>
<span class="sd">        flux : Array, photons = None</span>
<span class="sd">            The flux of the object.</span>
<span class="sd">        weights : Array = None</span>
<span class="sd">            The spectral weights of the object.</span>
<span class="sd">        spectrum : Spectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span>
        <span class="p">)</span>

        <span class="c1"># More complex parameter checks here because of extra dims</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;position must be a 2d array.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">flux</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;flux must be a 1d array.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Length of flux must be equal to length of &quot;</span> <span class="s2">&quot;positions.&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">,</span>
        <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Models the source object through the provided optics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source object.</span>
<span class="sd">        return_wf : bool = False</span>
<span class="sd">            Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">        return_psf : bool = False</span>
<span class="sd">            Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object : Array, Wavefront, PSF</span>
<span class="sd">            if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">            if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">                object.</span>
<span class="sd">            if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_wf</span> <span class="ow">and</span> <span class="n">return_psf</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;return_wf and return_psf cannot both be True. &quot;</span>
                <span class="s2">&quot;Please choose one.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">prop_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">wfs</span> <span class="o">=</span> <span class="n">filter_vmap</span><span class="p">(</span><span class="n">prop_fn</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wfs</span>
        <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">wfs</span><span class="o">.</span><span class="n">psf</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">wfs</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wfs</span><span class="o">.</span><span class="n">psf</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dLux.sources.PointSources.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">flux</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>wavelengths</code></td>
            <td>
                  <code>(<span title="jax.Array">Array</span>, metres)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of wavelengths at which the spectrum is defined.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>position</code></td>
            <td>
                  <code>Array, radians = np.zeros((1, 2))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The (x, y) on-sky position of this object.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.zeros">zeros</span>((1, 2))</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>flux</code></td>
            <td>
                  <code>Array, photons = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flux of the object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>weights</code></td>
            <td>
                  <code>Array = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectral weights of the object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>spectrum</code></td>
            <td>
                  <code>Spectrum = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
    <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelengths : Array, metres</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">    position : Array, radians = np.zeros((1, 2))</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : Array, photons = None</span>
<span class="sd">        The flux of the object.</span>
<span class="sd">    weights : Array = None</span>
<span class="sd">        The spectral weights of the object.</span>
<span class="sd">    spectrum : Spectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span>
    <span class="p">)</span>

    <span class="c1"># More complex parameter checks here because of extra dims</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;position must be a 2d array.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">flux</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;flux must be a 1d array.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Length of flux must be equal to length of &quot;</span> <span class="s2">&quot;positions.&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.PointSources.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_psf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Models the source object through the provided optics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>optics</code></td>
            <td>
                  <code><span title="dLux.sources.Optics">Optics</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optics through which to model the source object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_wf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the Wavefront object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_psf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the PSF object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>object</code></td>            <td>
                  <code>(<span title="jax.Array">Array</span>, <a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="../wavefronts/#dLux.wavefronts.Wavefront">Wavefront</a>, <a class="autorefs autorefs-internal" title="dLux.psfs.PSF" href="../psfs/#dLux.psfs.PSF">PSF</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>return_wf</code> is False and <code>return_psf</code> is False, returns the psf Array.
if <code>return_wf</code> is True and <code>return_psf</code> is False, returns the Wavefront
    object.
if <code>return_wf</code> is False and <code>return_psf</code> is True, returns the PSF object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">,</span>
    <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Models the source object through the provided optics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source object.</span>
<span class="sd">    return_wf : bool = False</span>
<span class="sd">        Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">    return_psf : bool = False</span>
<span class="sd">        Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object : Array, Wavefront, PSF</span>
<span class="sd">        if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">        if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">            object.</span>
<span class="sd">        if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">return_wf</span> <span class="ow">and</span> <span class="n">return_psf</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;return_wf and return_psf cannot both be True. &quot;</span>
            <span class="s2">&quot;Please choose one.&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">prop_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">wfs</span> <span class="o">=</span> <span class="n">filter_vmap</span><span class="p">(</span><span class="n">prop_fn</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wfs</span>
    <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">wfs</span><span class="o">.</span><span class="n">psf</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">wfs</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wfs</span><span class="o">.</span><span class="n">psf</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></details>
<details class="info" open="open">
<summary>BinarySource</summary>


<div class="doc doc-object doc-class">



<a id="dLux.sources.BinarySource"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dLux.sources.Source">Source</span></code></p>


      <p>A binary source parameterised by the position, flux, separation, position_angle,
and contrast between the two sources.</p>
<details class="abstract">
<summary>UML</summary>
<p><img alt="UML" src="../../../assets/uml/BinarySource.png" /></p>
</details>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.BinarySource.position">position</span></code></td>
            <td>
                  <code>(<span title="jax.Array">Array</span>, radians)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mean (x, y) on-sky position of this object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.BinarySource.mean_flux">mean_flux</span></code></td>
            <td>
                  <code>(float, photons)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mean flux of the sources.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.BinarySource.separation">separation</span></code></td>
            <td>
                  <code>(float, radians)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The separation of the two sources in radians.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.BinarySource.position_angle">position_angle</span></code></td>
            <td>
                  <code>(float, radians)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The position angle between the two sources measured clockwise from the
vertical axis.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.BinarySource.contrast">contrast</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contrast ratio between the two sources.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.BinarySource.spectrum">spectrum</span></code></td>
            <td>
                  <code><span title="dLux.sources.Spectrum">Spectrum</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/dLux/sources.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BinarySource</span><span class="p">(</span><span class="n">Source</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A binary source parameterised by the position, flux, separation, position_angle,</span>
<span class="sd">    and contrast between the two sources.</span>

<span class="sd">    ??? abstract &quot;UML&quot;</span>
<span class="sd">        ![UML](../../assets/uml/BinarySource.png)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The mean (x, y) on-sky position of this object.</span>
<span class="sd">    mean_flux : float, photons</span>
<span class="sd">        The mean flux of the sources.</span>
<span class="sd">    separation : float, radians</span>
<span class="sd">        The separation of the two sources in radians.</span>
<span class="sd">    position_angle : float, radians</span>
<span class="sd">        The position angle between the two sources measured clockwise from the</span>
<span class="sd">        vertical axis.</span>
<span class="sd">    contrast : float</span>
<span class="sd">        The contrast ratio between the two sources.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">position</span><span class="p">:</span> <span class="n">Array</span>
    <span class="n">mean_flux</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">separation</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">position_angle</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">mean_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">separation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">position_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelengths : Array, metres = None</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">        position : Array, radians = np.zeros(2)</span>
<span class="sd">            The (x, y) on-sky position of this object.</span>
<span class="sd">        mean_flux : float, photons = 1.</span>
<span class="sd">            The mean flux of the sources.</span>
<span class="sd">        separation : float, radians = 0.</span>
<span class="sd">            The separation of the two sources in radians.</span>
<span class="sd">        position_angle : float, radians = np.pi / 2</span>
<span class="sd">            The position angle between the two sources measured clockwise from the</span>
<span class="sd">            vertical axis.</span>
<span class="sd">        contrast : float = 1.</span>
<span class="sd">            The contrast ratio between the two sources.</span>
<span class="sd">        spectrum : Spectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)))</span>

        <span class="c1"># Position and Flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_flux</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mean_flux</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;position must be a 1d array of shape (2,).&quot;</span><span class="p">)</span>

        <span class="c1"># Binary values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separation</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">separation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position_angle</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">position_angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contrast</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">contrast</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span>
            <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">,</span>
        <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Models the source object through the provided optics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source object.</span>
<span class="sd">        return_wf : bool = False</span>
<span class="sd">            Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">        return_psf : bool = False</span>
<span class="sd">            Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object : Array, Wavefront, PSF</span>
<span class="sd">            if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">            if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">                object.</span>
<span class="sd">            if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Normalise and get input values</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">positions_from_sep</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position_angle</span>
        <span class="p">)</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">fluxes_from_contrast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_flux</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">contrast</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="n">flux</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

        <span class="c1"># Return wf case is simple</span>
        <span class="n">prop_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">return_wf</span><span class="p">,</span> <span class="n">return_psf</span>
        <span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">filter_vmap</span><span class="p">(</span><span class="n">prop_fn</span><span class="p">)(</span><span class="n">positions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>

        <span class="c1"># Return wf is simple case</span>
        <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">output</span>

        <span class="c1"># Return psf just requires constructing object</span>
        <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">output</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

        <span class="c1"># Return array is simple</span>
        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dLux.sources.BinarySource.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">mean_flux</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">position_angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>wavelengths</code></td>
            <td>
                  <code>Array, metres = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of wavelengths at which the spectrum is defined.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>position</code></td>
            <td>
                  <code>Array, radians = np.zeros(2)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The (x, y) on-sky position of this object.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.zeros">zeros</span>(2)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>mean_flux</code></td>
            <td>
                  <code>float, photons = 1.</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mean flux of the sources.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>separation</code></td>
            <td>
                  <code>float, radians = 0.</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The separation of the two sources in radians.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>position_angle</code></td>
            <td>
                  <code>float, radians = np.pi / 2</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The position angle between the two sources measured clockwise from the
vertical axis.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.pi">pi</span> / 2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>contrast</code></td>
            <td>
                  <code>float = 1.</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contrast ratio between the two sources.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>spectrum</code></td>
            <td>
                  <code>Spectrum = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">mean_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">separation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">position_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelengths : Array, metres = None</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">    position : Array, radians = np.zeros(2)</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    mean_flux : float, photons = 1.</span>
<span class="sd">        The mean flux of the sources.</span>
<span class="sd">    separation : float, radians = 0.</span>
<span class="sd">        The separation of the two sources in radians.</span>
<span class="sd">    position_angle : float, radians = np.pi / 2</span>
<span class="sd">        The position angle between the two sources measured clockwise from the</span>
<span class="sd">        vertical axis.</span>
<span class="sd">    contrast : float = 1.</span>
<span class="sd">        The contrast ratio between the two sources.</span>
<span class="sd">    spectrum : Spectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)))</span>

    <span class="c1"># Position and Flux</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mean_flux</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mean_flux</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;position must be a 1d array of shape (2,).&quot;</span><span class="p">)</span>

    <span class="c1"># Binary values</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">separation</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">separation</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">position_angle</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">position_angle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">contrast</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">contrast</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span>
        <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.BinarySource.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_psf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Models the source object through the provided optics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>optics</code></td>
            <td>
                  <code><span title="dLux.sources.Optics">Optics</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optics through which to model the source object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_wf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the Wavefront object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_psf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the PSF object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>object</code></td>            <td>
                  <code>(<span title="jax.Array">Array</span>, <a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="../wavefronts/#dLux.wavefronts.Wavefront">Wavefront</a>, <a class="autorefs autorefs-internal" title="dLux.psfs.PSF" href="../psfs/#dLux.psfs.PSF">PSF</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>return_wf</code> is False and <code>return_psf</code> is False, returns the psf Array.
if <code>return_wf</code> is True and <code>return_psf</code> is False, returns the Wavefront
    object.
if <code>return_wf</code> is False and <code>return_psf</code> is True, returns the PSF object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">,</span>
    <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Models the source object through the provided optics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source object.</span>
<span class="sd">    return_wf : bool = False</span>
<span class="sd">        Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">    return_psf : bool = False</span>
<span class="sd">        Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object : Array, Wavefront, PSF</span>
<span class="sd">        if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">        if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">            object.</span>
<span class="sd">        if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Normalise and get input values</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">positions_from_sep</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">separation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position_angle</span>
    <span class="p">)</span>
    <span class="n">flux</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">fluxes_from_contrast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_flux</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">contrast</span><span class="p">)</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="n">flux</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># Return wf case is simple</span>
    <span class="n">prop_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">position</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">return_wf</span><span class="p">,</span> <span class="n">return_psf</span>
    <span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">filter_vmap</span><span class="p">(</span><span class="n">prop_fn</span><span class="p">)(</span><span class="n">positions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>

    <span class="c1"># Return wf is simple case</span>
    <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="c1"># Return psf just requires constructing object</span>
    <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">output</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

    <span class="c1"># Return array is simple</span>
    <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></details>
<details class="info" open="open">
<summary>ResolvedSource</summary>


<div class="doc doc-object doc-class">



<a id="dLux.sources.ResolvedSource"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dLux.sources.PointSource" href="#dLux.sources.PointSource">PointSource</a></code></p>


      <p>A single resolved source with a spectrum, position, flux, and distribution array
that represents the resolved component.</p>
<details class="abstract">
<summary>UML</summary>
<p><img alt="UML" src="../../../assets/uml/ResolvedSource.png" /></p>
</details>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.ResolvedSource.position">position</span></code></td>
            <td>
                  <code>(<span title="jax.Array">Array</span>, radians)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The (x, y) on-sky position of this object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.ResolvedSource.flux">flux</span></code></td>
            <td>
                  <code>(float, photons)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flux of the object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.ResolvedSource.distribution">distribution</span></code></td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of intensities representing the resolved source.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.ResolvedSource.spectrum">spectrum</span></code></td>
            <td>
                  <code><span title="dLux.sources.Spectrum">Spectrum</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/dLux/sources.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ResolvedSource</span><span class="p">(</span><span class="n">PointSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A single resolved source with a spectrum, position, flux, and distribution array</span>
<span class="sd">    that represents the resolved component.</span>

<span class="sd">    ??? abstract &quot;UML&quot;</span>
<span class="sd">        ![UML](../../assets/uml/ResolvedSource.png)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : float, photons</span>
<span class="sd">        The flux of the object.</span>
<span class="sd">    distribution : Array</span>
<span class="sd">        The array of intensities representing the resolved source.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelengths : Array, metres</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">        position : Array, radians = np.zeros(2)</span>
<span class="sd">            The (x, y) on-sky position of this object.</span>
<span class="sd">        flux : float, photons = 1.</span>
<span class="sd">            The flux of the object.</span>
<span class="sd">        distribution : Array = np.ones((3, 3))</span>
<span class="sd">            The array of intensities representing the resolved source.</span>
<span class="sd">        weights : Array = None</span>
<span class="sd">            The spectral weights of the object.</span>
<span class="sd">        spectrum : Spectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span> <span class="o">/</span> <span class="n">distribution</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;distribution must be a 2d array.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
            <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span>
            <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
            <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Source</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for returning a new source object with a normalised total</span>
<span class="sd">        spectrum and source distribution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        source : Source</span>
<span class="sd">            The source object with the normalised spectrum and distribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">distribution_floor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution_floor</span> <span class="o">/</span> <span class="n">distribution_floor</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s2">&quot;spectrum&quot;</span><span class="p">,</span> <span class="s2">&quot;distribution&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">distribution</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Models the source object through the provided optics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source object.</span>
<span class="sd">        return_wf : bool = False</span>
<span class="sd">            Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">        return_psf : bool = False</span>
<span class="sd">            Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object : Array, Wavefront, PSF</span>
<span class="sd">            if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">            if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">                object.</span>
<span class="sd">            if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_wf</span> <span class="ow">and</span> <span class="n">return_psf</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;return_wf and return_psf cannot both be True. &quot;</span>
                <span class="s2">&quot;Please choose one.&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Normalise and get parameters</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span>

        <span class="c1"># Note we always return wf here so we can convolve each wavelength</span>
        <span class="c1"># individually if a chromatic wavefront output is required.</span>
        <span class="n">wf</span> <span class="o">=</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="c1"># Returning wf is a special case</span>
        <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
            <span class="n">conv_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">psf</span><span class="p">:</span> <span class="n">convolve</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">wf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="n">vmap</span><span class="p">(</span><span class="n">conv_fn</span><span class="p">)(</span><span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># Return psf object</span>
        <span class="n">conv_psf</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">conv_psf</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

        <span class="c1"># Return array psf</span>
        <span class="k">return</span> <span class="n">conv_psf</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dLux.sources.ResolvedSource.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">flux</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>wavelengths</code></td>
            <td>
                  <code>(<span title="jax.Array">Array</span>, metres)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of wavelengths at which the spectrum is defined.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>position</code></td>
            <td>
                  <code>Array, radians = np.zeros(2)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The (x, y) on-sky position of this object.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.zeros">zeros</span>(2)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>flux</code></td>
            <td>
                  <code>float, photons = 1.</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The flux of the object.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>distribution</code></td>
            <td>
                  <code>Array = np.ones((3, 3))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of intensities representing the resolved source.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.ones">ones</span>((3, 3))</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>weights</code></td>
            <td>
                  <code>Array = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectral weights of the object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>spectrum</code></td>
            <td>
                  <code>Spectrum = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelengths : Array, metres</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">    position : Array, radians = np.zeros(2)</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : float, photons = 1.</span>
<span class="sd">        The flux of the object.</span>
<span class="sd">    distribution : Array = np.ones((3, 3))</span>
<span class="sd">        The array of intensities representing the resolved source.</span>
<span class="sd">    weights : Array = None</span>
<span class="sd">        The spectral weights of the object.</span>
<span class="sd">    spectrum : Spectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span> <span class="o">/</span> <span class="n">distribution</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;distribution must be a 2d array.&quot;</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
        <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span>
        <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
        <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.ResolvedSource.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_psf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Models the source object through the provided optics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>optics</code></td>
            <td>
                  <code><span title="dLux.sources.Optics">Optics</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optics through which to model the source object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_wf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the Wavefront object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_psf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the PSF object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>object</code></td>            <td>
                  <code>(<span title="jax.Array">Array</span>, <a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="../wavefronts/#dLux.wavefronts.Wavefront">Wavefront</a>, <a class="autorefs autorefs-internal" title="dLux.psfs.PSF" href="../psfs/#dLux.psfs.PSF">PSF</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>return_wf</code> is False and <code>return_psf</code> is False, returns the psf Array.
if <code>return_wf</code> is True and <code>return_psf</code> is False, returns the Wavefront
    object.
if <code>return_wf</code> is False and <code>return_psf</code> is True, returns the PSF object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Models the source object through the provided optics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source object.</span>
<span class="sd">    return_wf : bool = False</span>
<span class="sd">        Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">    return_psf : bool = False</span>
<span class="sd">        Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object : Array, Wavefront, PSF</span>
<span class="sd">        if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">        if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">            object.</span>
<span class="sd">        if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">return_wf</span> <span class="ow">and</span> <span class="n">return_psf</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;return_wf and return_psf cannot both be True. &quot;</span>
            <span class="s2">&quot;Please choose one.&quot;</span>
        <span class="p">)</span>
    <span class="c1"># Normalise and get parameters</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span>

    <span class="c1"># Note we always return wf here so we can convolve each wavelength</span>
    <span class="c1"># individually if a chromatic wavefront output is required.</span>
    <span class="n">wf</span> <span class="o">=</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># Returning wf is a special case</span>
    <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
        <span class="n">conv_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">psf</span><span class="p">:</span> <span class="n">convolve</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="n">vmap</span><span class="p">(</span><span class="n">conv_fn</span><span class="p">)(</span><span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Return psf object</span>
    <span class="n">conv_psf</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">conv_psf</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

    <span class="c1"># Return array psf</span>
    <span class="k">return</span> <span class="n">conv_psf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.ResolvedSource.normalise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalise</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Method for returning a new source object with a normalised total
spectrum and source distribution.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>source</code></td>            <td>
                  <code><span title="dLux.sources.Source">Source</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source object with the normalised spectrum and distribution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Source</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method for returning a new source object with a normalised total</span>
<span class="sd">    spectrum and source distribution.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    source : Source</span>
<span class="sd">        The source object with the normalised spectrum and distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">distribution_floor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution_floor</span> <span class="o">/</span> <span class="n">distribution_floor</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s2">&quot;spectrum&quot;</span><span class="p">,</span> <span class="s2">&quot;distribution&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">distribution</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></details>
<details class="info" open="open">
<summary>PointResolvedSource</summary>


<div class="doc doc-object doc-class">



<a id="dLux.sources.PointResolvedSource"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dLux.sources.ResolvedSource" href="#dLux.sources.ResolvedSource">ResolvedSource</a></code></p>


      <p>A class for modelling a point source and a resolved source that is defined
relative to the point source. An example would be an unresolved star with
a resolved dust shell or debris disk. These two objects share the same
spectra but have their flux defined by flux (the mean flux) and the flux
ratio (contrast) between the point source and resolved distribution. The
resolved component is defined by an array of intensities that represent
the resolved distribution.</p>
<details class="abstract">
<summary>UML</summary>
<p><img alt="UML" src="../../../assets/uml/PointResolvedSource.png" /></p>
</details>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointResolvedSource.position">position</span></code></td>
            <td>
                  <code>(<span title="jax.Array">Array</span>, radians)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The (x, y) on-sky position of this object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointResolvedSource.flux">flux</span></code></td>
            <td>
                  <code>(float, photons)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mean flux of the point and resolved source.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointResolvedSource.distribution">distribution</span></code></td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of intensities representing the resolved source.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointResolvedSource.contrast">contrast</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contrast ratio between the point source and the resolved source.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.PointResolvedSource.spectrum">spectrum</span></code></td>
            <td>
                  <code><span title="dLux.sources.Spectrum">Spectrum</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/dLux/sources.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PointResolvedSource</span><span class="p">(</span><span class="n">ResolvedSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for modelling a point source and a resolved source that is defined</span>
<span class="sd">    relative to the point source. An example would be an unresolved star with</span>
<span class="sd">    a resolved dust shell or debris disk. These two objects share the same</span>
<span class="sd">    spectra but have their flux defined by flux (the mean flux) and the flux</span>
<span class="sd">    ratio (contrast) between the point source and resolved distribution. The</span>
<span class="sd">    resolved component is defined by an array of intensities that represent</span>
<span class="sd">    the resolved distribution.</span>

<span class="sd">    ??? abstract &quot;UML&quot;</span>
<span class="sd">        ![UML](../../assets/uml/PointResolvedSource.png)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : float, photons</span>
<span class="sd">        The mean flux of the point and resolved source.</span>
<span class="sd">    distribution : Array</span>
<span class="sd">        The array of intensities representing the resolved source.</span>
<span class="sd">    contrast : float</span>
<span class="sd">        The contrast ratio between the point source and the resolved source.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
        <span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Source</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelengths : Array, metres = None</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">        position : Array, radians = np.zeros(2)</span>
<span class="sd">            The (x, y) on-sky position of this object.</span>
<span class="sd">        flux : float, photons = 1.</span>
<span class="sd">            The mean flux of the point and resolved source.</span>
<span class="sd">        distribution : Array = np.ones((3, 3))</span>
<span class="sd">            The array of intensities representing the resolved source.</span>
<span class="sd">        contrast : float = 1.</span>
<span class="sd">            The contrast ratio between the point source and the resolved source.</span>
<span class="sd">        weights : Array = None</span>
<span class="sd">            The spectral weights of the object.</span>
<span class="sd">        spectrum : Spectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">contrast</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">contrast</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span>
            <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
            <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span>
            <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
            <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
            <span class="c1"># contrast=contrast,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
        <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">,</span>
        <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Models the source object through the provided optics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source object.</span>
<span class="sd">        return_wf : bool = False</span>
<span class="sd">            Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">        return_psf : bool = False</span>
<span class="sd">            Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object : Array, Wavefront, PSF</span>
<span class="sd">            if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">            if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">                object.</span>
<span class="sd">            if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">return_wf</span> <span class="ow">and</span> <span class="n">return_psf</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;return_wf and return_psf cannot both be True. &quot;</span>
                <span class="s2">&quot;Please choose one.&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Normalise and get parameters</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">fluxes_from_contrast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">contrast</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="n">flux</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

        <span class="c1"># Note we always return wf here so we can convolve each wavelength</span>
        <span class="c1"># individually if a chromatic wavefront output is required. We also</span>
        <span class="c1"># Can not propagate the weights since they have different values</span>
        <span class="c1"># for the point and resolved source.</span>
        <span class="n">wf</span> <span class="o">=</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Returning wf is a special case, we need to convolve each psf with</span>
        <span class="c1"># the distribution, and them re-combine them into a vectorised wf</span>
        <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
            <span class="c1"># Perform convolution</span>
            <span class="n">conv_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">psf</span><span class="p">:</span> <span class="n">convolve</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
            <span class="n">conv_wf</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="n">vmap</span><span class="p">(</span><span class="n">conv_fn</span><span class="p">)(</span><span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>

            <span class="c1"># Stack leaves manually, this is a bit of a hack to get around</span>
            <span class="c1"># string leaf errors from tree_map, and to avoid</span>
            <span class="c1"># flattening/unflattening with partition and combine</span>
            <span class="n">stack_leaves</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">amplitudes</span> <span class="o">=</span> <span class="n">stack_leaves</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">conv_wf</span><span class="o">.</span><span class="n">amplitude</span><span class="p">)</span>
            <span class="n">phases</span> <span class="o">=</span> <span class="n">stack_leaves</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">conv_wf</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>
            <span class="n">pixel_scales</span> <span class="o">=</span> <span class="n">stack_leaves</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="n">conv_wf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">)</span>
            <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">stack_leaves</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">conv_wf</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>

            <span class="c1"># Combine into single wf and finally apply weights</span>
            <span class="n">combined_wf</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;wavelength&quot;</span><span class="p">,</span> <span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_scale&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">amplitudes</span><span class="p">,</span> <span class="n">phases</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_wf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="n">weights</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>

        <span class="c1"># Create singe array psf object</span>
        <span class="n">point_psf</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">resolved_psf</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">conv_psf</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">resolved_psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
        <span class="n">psf</span> <span class="o">=</span> <span class="n">point_psf</span> <span class="o">+</span> <span class="n">conv_psf</span>
        <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

        <span class="c1"># Return array psf</span>
        <span class="k">return</span> <span class="n">psf</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dLux.sources.PointResolvedSource.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">flux</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>wavelengths</code></td>
            <td>
                  <code>Array, metres = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of wavelengths at which the spectrum is defined.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>position</code></td>
            <td>
                  <code>Array, radians = np.zeros(2)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The (x, y) on-sky position of this object.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.zeros">zeros</span>(2)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>flux</code></td>
            <td>
                  <code>float, photons = 1.</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mean flux of the point and resolved source.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>distribution</code></td>
            <td>
                  <code>Array = np.ones((3, 3))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of intensities representing the resolved source.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.ones">ones</span>((3, 3))</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>contrast</code></td>
            <td>
                  <code>float = 1.</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contrast ratio between the point source and the resolved source.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>weights</code></td>
            <td>
                  <code>Array = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectral weights of the object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>spectrum</code></td>
            <td>
                  <code>Spectrum = None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spectrum of this object, represented by a Spectrum object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
    <span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Source</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelengths : Array, metres = None</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">    position : Array, radians = np.zeros(2)</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : float, photons = 1.</span>
<span class="sd">        The mean flux of the point and resolved source.</span>
<span class="sd">    distribution : Array = np.ones((3, 3))</span>
<span class="sd">        The array of intensities representing the resolved source.</span>
<span class="sd">    contrast : float = 1.</span>
<span class="sd">        The contrast ratio between the point source and the resolved source.</span>
<span class="sd">    weights : Array = None</span>
<span class="sd">        The spectral weights of the object.</span>
<span class="sd">    spectrum : Spectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">contrast</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">contrast</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
        <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span>
        <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
        <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="c1"># contrast=contrast,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.PointResolvedSource.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_psf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Models the source object through the provided optics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>optics</code></td>
            <td>
                  <code><span title="dLux.sources.Optics">Optics</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optics through which to model the source object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_wf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the Wavefront object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_psf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the PSF object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>object</code></td>            <td>
                  <code>(<span title="jax.Array">Array</span>, <a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="../wavefronts/#dLux.wavefronts.Wavefront">Wavefront</a>, <a class="autorefs autorefs-internal" title="dLux.psfs.PSF" href="../psfs/#dLux.psfs.PSF">PSF</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>return_wf</code> is False and <code>return_psf</code> is False, returns the psf Array.
if <code>return_wf</code> is True and <code>return_psf</code> is False, returns the Wavefront
    object.
if <code>return_wf</code> is False and <code>return_psf</code> is True, returns the PSF object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
    <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">,</span>
    <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Models the source object through the provided optics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source object.</span>
<span class="sd">    return_wf : bool = False</span>
<span class="sd">        Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">    return_psf : bool = False</span>
<span class="sd">        Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object : Array, Wavefront, PSF</span>
<span class="sd">        if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">        if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">            object.</span>
<span class="sd">        if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">return_wf</span> <span class="ow">and</span> <span class="n">return_psf</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;return_wf and return_psf cannot both be True. &quot;</span>
            <span class="s2">&quot;Please choose one.&quot;</span>
        <span class="p">)</span>
    <span class="c1"># Normalise and get parameters</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">flux</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">fluxes_from_contrast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">contrast</span><span class="p">)</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="n">flux</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># Note we always return wf here so we can convolve each wavelength</span>
    <span class="c1"># individually if a chromatic wavefront output is required. We also</span>
    <span class="c1"># Can not propagate the weights since they have different values</span>
    <span class="c1"># for the point and resolved source.</span>
    <span class="n">wf</span> <span class="o">=</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Returning wf is a special case, we need to convolve each psf with</span>
    <span class="c1"># the distribution, and them re-combine them into a vectorised wf</span>
    <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
        <span class="c1"># Perform convolution</span>
        <span class="n">conv_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">psf</span><span class="p">:</span> <span class="n">convolve</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
        <span class="n">conv_wf</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="n">vmap</span><span class="p">(</span><span class="n">conv_fn</span><span class="p">)(</span><span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># Stack leaves manually, this is a bit of a hack to get around</span>
        <span class="c1"># string leaf errors from tree_map, and to avoid</span>
        <span class="c1"># flattening/unflattening with partition and combine</span>
        <span class="n">stack_leaves</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">amplitudes</span> <span class="o">=</span> <span class="n">stack_leaves</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">conv_wf</span><span class="o">.</span><span class="n">amplitude</span><span class="p">)</span>
        <span class="n">phases</span> <span class="o">=</span> <span class="n">stack_leaves</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">conv_wf</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>
        <span class="n">pixel_scales</span> <span class="o">=</span> <span class="n">stack_leaves</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="n">conv_wf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">)</span>
        <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">stack_leaves</span><span class="p">(</span><span class="n">wf</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">conv_wf</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>

        <span class="c1"># Combine into single wf and finally apply weights</span>
        <span class="n">combined_wf</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;wavelength&quot;</span><span class="p">,</span> <span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="s2">&quot;pixel_scale&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">amplitudes</span><span class="p">,</span> <span class="n">phases</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">combined_wf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="n">weights</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>

    <span class="c1"># Create singe array psf object</span>
    <span class="n">point_psf</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">resolved_psf</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">wf</span><span class="o">.</span><span class="n">psf</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">conv_psf</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">resolved_psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
    <span class="n">psf</span> <span class="o">=</span> <span class="n">point_psf</span> <span class="o">+</span> <span class="n">conv_psf</span>
    <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

    <span class="c1"># Return array psf</span>
    <span class="k">return</span> <span class="n">psf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></details>
<details class="info" open="open">
<summary>Scene</summary>


<div class="doc doc-object doc-class">



<a id="dLux.sources.Scene"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dLux.sources.BaseSource">BaseSource</span></code></p>


      <p>A source object that holds a set of sources that are model simultaneously.</p>
<details class="abstract">
<summary>UML</summary>
<p><img alt="UML" src="../../../assets/uml/Scene.png" /></p>
</details>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="dLux.sources.Scene.sources">sources</span></code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of source objects to model simultaneously.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/dLux/sources.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Scene</span><span class="p">(</span><span class="n">BaseSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A source object that holds a set of sources that are model simultaneously.</span>

<span class="sd">    ??? abstract &quot;UML&quot;</span>
<span class="sd">        ![UML](../../assets/uml/Scene.png)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    sources : dict</span>
<span class="sd">        A dictionary of source objects to model simultaneously.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sources</span><span class="p">:</span> <span class="nb">dict</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Scene</span><span class="p">,</span> <span class="n">sources</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Source</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sources : list[Source]</span>
<span class="sd">            A list of source objects to model simultaneously.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="p">(</span><span class="n">BaseSource</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">sources</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">list2dictionary</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">BaseSource</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Scene</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Scene</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for returning a new scene with normalised source objects.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        scene : Scene</span>
<span class="sd">            The normalised scene object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_source</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">leaf</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">BaseSource</span><span class="p">)</span>
        <span class="n">norm_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">source</span><span class="p">:</span> <span class="n">source</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="n">norm_fn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_source</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;sources&quot;</span><span class="p">,</span> <span class="n">sources</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Raises the individual sources via their keys.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The key of the item to be searched for in the sub-dictionaries.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        item : object</span>
<span class="sd">            The item corresponding to the supplied key in the sub-dictionaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> has no attribute &quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Scene</span><span class="p">,</span>
        <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">(),</span>
        <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Models the source object through the provided optics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source object.</span>
<span class="sd">        return_wf : bool = False</span>
<span class="sd">            Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">        return_psf : bool = False</span>
<span class="sd">            Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object : Array, Wavefront, PSF</span>
<span class="sd">            if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">            if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">                object.</span>
<span class="sd">            if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>

        <span class="c1"># Define leaf_fn and map across sources</span>
        <span class="n">leaf_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">leaf</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">BaseSource</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">,</span> <span class="n">return_wf</span><span class="p">,</span> <span class="n">return_psf</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span>
            <span class="n">is_leaf</span><span class="o">=</span><span class="n">leaf_fn</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Return wf case is simple</span>
        <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">output</span>

        <span class="c1"># Return psf case requires mapping across the psf outputs</span>
        <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
            <span class="c1"># Define mapping function</span>
            <span class="n">leaf_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">leaf</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">PSF</span><span class="p">)</span>
            <span class="n">get_psfs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">psf</span><span class="p">:</span> <span class="n">psf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">ndim</span><span class="p">)))</span>
            <span class="n">get_pscales</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">psf</span><span class="p">:</span> <span class="n">psf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

            <span class="c1"># Get values and return PSF</span>
            <span class="n">psf</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">map2array</span><span class="p">(</span><span class="n">get_psfs</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">leaf_fn</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">map2array</span><span class="p">(</span><span class="n">get_pscales</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">leaf_fn</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">)</span>

        <span class="c1"># Return array is simple</span>
        <span class="k">return</span> <span class="n">dlu</span><span class="o">.</span><span class="n">map2array</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dLux.sources.Scene.__getattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Raises the individual sources via their keys.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>key</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key of the item to be searched for in the sub-dictionaries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>item</code></td>            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The item corresponding to the supplied key in the sub-dictionaries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raises the individual sources via their keys.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The key of the item to be searched for in the sub-dictionaries.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    item : object</span>
<span class="sd">        The item corresponding to the supplied key in the sub-dictionaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> has no attribute &quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.Scene.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sources</code></td>
            <td>
                  <code>list[<span title="dLux.sources.Source">Source</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of source objects to model simultaneously.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Scene</span><span class="p">,</span> <span class="n">sources</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Source</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sources : list[Source]</span>
<span class="sd">        A list of source objects to model simultaneously.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="p">(</span><span class="n">BaseSource</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">sources</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">list2dictionary</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">BaseSource</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.Scene.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">,</span> <span class="n">return_wf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_psf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Models the source object through the provided optics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>optics</code></td>
            <td>
                  <code><span title="dLux.sources.Optics">Optics</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optics through which to model the source object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_wf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the Wavefront object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_psf</code></td>
            <td>
                  <code>bool = False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the PSF object be returned instead of the psf Array?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>object</code></td>            <td>
                  <code>(<span title="jax.Array">Array</span>, <a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="../wavefronts/#dLux.wavefronts.Wavefront">Wavefront</a>, <a class="autorefs autorefs-internal" title="dLux.psfs.PSF" href="../psfs/#dLux.psfs.PSF">PSF</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>return_wf</code> is False and <code>return_psf</code> is False, returns the psf Array.
if <code>return_wf</code> is True and <code>return_psf</code> is False, returns the Wavefront
    object.
if <code>return_wf</code> is False and <code>return_psf</code> is True, returns the PSF object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Scene</span><span class="p">,</span>
    <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">(),</span>
    <span class="n">return_wf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_psf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Models the source object through the provided optics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source object.</span>
<span class="sd">    return_wf : bool = False</span>
<span class="sd">        Should the Wavefront object be returned instead of the psf Array?</span>
<span class="sd">    return_psf : bool = False</span>
<span class="sd">        Should the PSF object be returned instead of the psf Array?</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object : Array, Wavefront, PSF</span>
<span class="sd">        if `return_wf` is False and `return_psf` is False, returns the psf Array.</span>
<span class="sd">        if `return_wf` is True and `return_psf` is False, returns the Wavefront</span>
<span class="sd">            object.</span>
<span class="sd">        if `return_wf` is False and `return_psf` is True, returns the PSF object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>

    <span class="c1"># Define leaf_fn and map across sources</span>
    <span class="n">leaf_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">leaf</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">BaseSource</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">,</span> <span class="n">return_wf</span><span class="p">,</span> <span class="n">return_psf</span><span class="p">),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span>
        <span class="n">is_leaf</span><span class="o">=</span><span class="n">leaf_fn</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Return wf case is simple</span>
    <span class="k">if</span> <span class="n">return_wf</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="c1"># Return psf case requires mapping across the psf outputs</span>
    <span class="k">if</span> <span class="n">return_psf</span><span class="p">:</span>
        <span class="c1"># Define mapping function</span>
        <span class="n">leaf_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">leaf</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">PSF</span><span class="p">)</span>
        <span class="n">get_psfs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">psf</span><span class="p">:</span> <span class="n">psf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">ndim</span><span class="p">)))</span>
        <span class="n">get_pscales</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">psf</span><span class="p">:</span> <span class="n">psf</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="c1"># Get values and return PSF</span>
        <span class="n">psf</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">map2array</span><span class="p">(</span><span class="n">get_psfs</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">leaf_fn</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">map2array</span><span class="p">(</span><span class="n">get_pscales</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">leaf_fn</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">PSF</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">)</span>

    <span class="c1"># Return array is simple</span>
    <span class="k">return</span> <span class="n">dlu</span><span class="o">.</span><span class="n">map2array</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="dLux.sources.Scene.normalise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalise</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Method for returning a new scene with normalised source objects.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>scene</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="dLux.sources.Scene" href="#dLux.sources.Scene">Scene</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The normalised scene object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/dLux/sources.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Scene</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Scene</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method for returning a new scene with normalised source objects.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    scene : Scene</span>
<span class="sd">        The normalised scene object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_source</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">leaf</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">BaseSource</span><span class="p">)</span>
    <span class="n">norm_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">source</span><span class="p">:</span> <span class="n">source</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="n">norm_fn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_source</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;sources&quot;</span><span class="p">,</span> <span class="n">sources</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></details>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>