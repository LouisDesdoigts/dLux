
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/logo.jpg">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Optical System (depreceated) - ∂Lux - Differentiable Optical Simulation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dLux.core.OpticalSystem" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="∂Lux - Differentiable Optical Simulation" class="md-header__button md-logo" aria-label="∂Lux - Differentiable Optical Simulation" data-md-component="logo">
      
  <img src="../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ∂Lux - Differentiable Optical Simulation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Optical System (depreceated)
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dLux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="∂Lux - Differentiable Optical Simulation" class="md-nav__button md-logo" aria-label="∂Lux - Differentiable Optical Simulation" data-md-component="logo">
      
  <img src="../../assets/logo.jpg" alt="logo">

    </a>
    ∂Lux - Differentiable Optical Simulation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dLux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/phase_retrieval_demo/" class="md-nav__link">
        Phase Retrieval in dLux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/designing_a_mask/" class="md-nav__link">
        Phase Mask Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/flatfield_calibration/" class="md-nav__link">
        Pixel Level Calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/fisher_information/" class="md-nav__link">
        Fisher Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/HMC/" class="md-nav__link">
        Numpyro and Hamiltonian Monte Carlo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Core
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Core" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instrument/" class="md-nav__link">
        Telescope
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scene/" class="md-nav__link">
        Scene
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detector/" class="md-nav__link">
        Detector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../filter/" class="md-nav__link">
        Filter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        model
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Optical System (depreceated)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Optical System (depreceated)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem" class="md-nav__link">
    dLux.core.OpticalSystem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.Nims" class="md-nav__link">
    Nims
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.Nstars" class="md-nav__link">
    Nstars
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.Nwavels" class="md-nav__link">
    Nwavels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.detector_layers" class="md-nav__link">
    detector_layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.dithers" class="md-nav__link">
    dithers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.fluxes" class="md-nav__link">
    fluxes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.layers" class="md-nav__link">
    layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.positions" class="md-nav__link">
    positions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.wavels" class="md-nav__link">
    wavels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.weights" class="md-nav__link">
    weights
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.apply_detector_layers" class="md-nav__link">
    apply_detector_layers()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.debug_prop" class="md-nav__link">
    debug_prop()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.dither_positions" class="md-nav__link">
    dither_positions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.propagate" class="md-nav__link">
    propagate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.propagate_mono" class="md-nav__link">
    propagate_mono()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.propagate_single" class="md-nav__link">
    propagate_single()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.reshape_psfs" class="md-nav__link">
    reshape_psfs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.weight_psfs" class="md-nav__link">
    weight_psfs()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Optical Layers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Optical Layers" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Optical Layers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/create_wavefront/" class="md-nav__link">
        Create Wavefront
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/normalise_wavefront/" class="md-nav__link">
        Normalise Wavefront
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/tilt_wavefront/" class="md-nav__link">
        Tilt Wavefront
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/circular_aperture/" class="md-nav__link">
        Circular Aperture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/compound_aperture/" class="md-nav__link">
        Compound Aperture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/transmissive_optic/" class="md-nav__link">
        Transmissive Optic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/add_phase/" class="md-nav__link">
        Add Phase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/add_opd/" class="md-nav__link">
        Add OPD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/apply_basis_opd/" class="md-nav__link">
        Apply Basis OPD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../optics/apply_basis_climb/" class="md-nav__link">
        Apply Basis CLIMB
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_11" type="checkbox" id="__nav_4_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_11">
          Propagators
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Propagators" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          Propagators
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../propagators/concrete/cartesian_mft/" class="md-nav__link">
        Cartesian MFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../propagators/concrete/angular_mft/" class="md-nav__link">
        Angular MFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../propagators/concrete/cartesian_fft/" class="md-nav__link">
        Cartesian FFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../propagators/concrete/angular_fft/" class="md-nav__link">
        Angular FFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../propagators/concrete/cartesian_fresnel/" class="md-nav__link">
        Cartesian Fresnel
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Wavefronts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Wavefronts" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Wavefronts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../wavefronts/wavefront/" class="md-nav__link">
        Wavefront
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../wavefronts/cartesian_wavefront/" class="md-nav__link">
        Cartesian Wavefront
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../wavefronts/angular_wavefront/" class="md-nav__link">
        Angular Wavefront
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../wavefronts/far_field_fresnel_wavefront/" class="md-nav__link">
        Far Field Fresnel Wavefront
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Sources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sources" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Sources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/point_source/" class="md-nav__link">
        Point Source
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/multi_point_source/" class="md-nav__link">
        Multiple Point Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/binary_source/" class="md-nav__link">
        Binary Source
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/array_distribution/" class="md-nav__link">
        Array Distribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/point_extended_source/" class="md-nav__link">
        Point Extended Source
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/point_and_extended_source/" class="md-nav__link">
        Point And Extended Source
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Spectrums
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Spectrums" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Spectrums
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spectrums/array_spectrum/" class="md-nav__link">
        Array Spectrum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spectrums/polynomial_spectrum/" class="md-nav__link">
        Polynomial Spectrum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spectrums/combined_spectrum/" class="md-nav__link">
        Combined Spectrum
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Detectors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Detectors" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Detectors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../detectors/apply_pixel_response/" class="md-nav__link">
        Apply Pixel Response
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../detectors/apply_jitter/" class="md-nav__link">
        Apply Jitter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../detectors/apply_saturation/" class="md-nav__link">
        Apply Saturation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../detectors/add_constant/" class="md-nav__link">
        Add Constant
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../detectors/integer_downsample/" class="md-nav__link">
        Integer Downsample
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utils" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1" type="checkbox" id="__nav_9_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_1">
          Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Models" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_1">
          <span class="md-nav__icon md-icon"></span>
          Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/models/simple_optical_system/" class="md-nav__link">
        simple optical system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/models/toliman/" class="md-nav__link">
        toliman
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_2" type="checkbox" id="__nav_9_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_2">
          Units
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Units" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_2">
          <span class="md-nav__icon md-icon"></span>
          Units
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/units/radians_to_arcseconds/" class="md-nav__link">
        radians to arcseconds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/units/arcseconds_to_radians/" class="md-nav__link">
        arcseconds to radians
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_3" type="checkbox" id="__nav_9_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_3">
          Coordinates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Coordinates" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_3">
          <span class="md-nav__icon md-icon"></span>
          Coordinates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/cartesian_to_polar/" class="md-nav__link">
        cartesian to polar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/polar_to_cartesian/" class="md-nav__link">
        polar to cartesian
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/get_coordinates_vector/" class="md-nav__link">
        get coordinates vector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/get_positions_vector/" class="md-nav__link">
        get positions vector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/get_pixel_positions/" class="md-nav__link">
        get pixel positions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/get_pixel_coordinates/" class="md-nav__link">
        get pixel coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/get_polar_positions/" class="md-nav__link">
        get polar positions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/get_polar_coordinates/" class="md-nav__link">
        get polar coordinates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_4" type="checkbox" id="__nav_9_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_4">
          Interpolation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Interpolation" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_4">
          <span class="md-nav__icon md-icon"></span>
          Interpolation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/interpolation/scale_array/" class="md-nav__link">
        scale array
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/interpolation/generate_coordinates/" class="md-nav__link">
        generate coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/interpolation/interpolate/" class="md-nav__link">
        interpolate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/interpolation/interpolate_field/" class="md-nav__link">
        interpolate field
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/interpolation/rotate/" class="md-nav__link">
        rotate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/interpolation/fourier_rotate/" class="md-nav__link">
        fourier_rotate
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_5" type="checkbox" id="__nav_9_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_5">
          Optics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Optics" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_5">
          <span class="md-nav__icon md-icon"></span>
          Optics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optics/opd_to_phase/" class="md-nav__link">
        opd to phase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optics/phase_to_opd/" class="md-nav__link">
        phase to opd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optics/get_fringe_size/" class="md-nav__link">
        get fringe size
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optics/get_pixels_per_fringe/" class="md-nav__link">
        get pixels per fringe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optics/get_pixel_scale/" class="md-nav__link">
        get pixel scale
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/optics/get_airy_pixel_scale/" class="md-nav__link">
        get airy pixel scale
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_6" type="checkbox" id="__nav_9_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_6">
          Bayes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Bayes" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_6">
          <span class="md-nav__icon md-icon"></span>
          Bayes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bayes/poisson_likelihood/" class="md-nav__link">
        poisson likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bayes/poisson_log_likelihood/" class="md-nav__link">
        poisson log likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bayes/chi2_likelihood/" class="md-nav__link">
        chi2 likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bayes/chi2_log_likelihood/" class="md-nav__link">
        chi2 log likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bayes/calculate_covariance/" class="md-nav__link">
        calculate covariance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bayes/calculate_entropy/" class="md-nav__link">
        calculate entropy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_7" type="checkbox" id="__nav_9_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_7">
          Gradient Energy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Gradient Energy" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_7">
          <span class="md-nav__icon md-icon"></span>
          Gradient Energy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/gradient_energy/get_GE/" class="md-nav__link">
        get GE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/gradient_energy/get_RGE/" class="md-nav__link">
        get RGE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/gradient_energy/get_RWGE/" class="md-nav__link">
        get RWGE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/gradient_energy/get_radial_mask/" class="md-nav__link">
        get radial mask
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_8" type="checkbox" id="__nav_9_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_8">
          Helpers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Helpers" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_8">
          <span class="md-nav__icon md-icon"></span>
          Helpers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/helpers/list_to_dictionary/" class="md-nav__link">
        list to dictionary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem" class="md-nav__link">
    dLux.core.OpticalSystem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.Nims" class="md-nav__link">
    Nims
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.Nstars" class="md-nav__link">
    Nstars
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.Nwavels" class="md-nav__link">
    Nwavels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.detector_layers" class="md-nav__link">
    detector_layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.dithers" class="md-nav__link">
    dithers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.fluxes" class="md-nav__link">
    fluxes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.layers" class="md-nav__link">
    layers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.positions" class="md-nav__link">
    positions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.wavels" class="md-nav__link">
    wavels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.weights" class="md-nav__link">
    weights
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.apply_detector_layers" class="md-nav__link">
    apply_detector_layers()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.debug_prop" class="md-nav__link">
    debug_prop()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.dither_positions" class="md-nav__link">
    dither_positions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.propagate" class="md-nav__link">
    propagate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.propagate_mono" class="md-nav__link">
    propagate_mono()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.propagate_single" class="md-nav__link">
    propagate_single()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.reshape_psfs" class="md-nav__link">
    reshape_psfs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dLux.core.OpticalSystem.weight_psfs" class="md-nav__link">
    weight_psfs()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/LouisDesdoigts/dLux/edit/master/docs/core/optical_system.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>Optical System (depreceated)</h1>

<div class="doc doc-object doc-class">


<a id="dLux.core.OpticalSystem"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="zodiax.ExtendedBase">ExtendedBase</span></code></p>

  
      <p>Optical System class, Equinox Modle</p>
<p>DOCSTRING NOT COMPLETE</p>
<p>A Class to store and apply properties external to the optical system
Ie: stellar positions and spectra</p>
<p>positions: (Nstars, 2) array
wavels: (Nwavels) array
weights: (Nwavel)/(Nwavels, Nstars) array</p>
<p>dLux currently does not check that inputs are correctly shaped/formatted!</p>
<p>Notes:
 - Take in layers in order to re-intialise the model every call?</p>
<p>General images output shape: (Nimages, Nstars, Nwavels, Npix, Npix)</p>
<ul>
<li>Currently doesnt allow temporal variation in spectrum </li>
<li>Currently doesnt allow temporal variation in flux</li>
</ul>
<p>ToDo: Add getter methods for accessing weights and fluxes attributes that
use np.squeeze to remove empy axes</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>layers</code></td>
          <td>
                <code>list, required</code>
          </td>
          <td><ul>
<li>A list of layers that defines the tranformaitons and operations of the system (typically optical)</li>
</ul></td>
        </tr>
        <tr>
          <td><code>wavels</code></td>
          <td>
                <code>ndarray</code>
          </td>
          <td><ul>
<li>An array of wavelengths in meters to simulate</li>
<li>The shape must be 1d - stellar spectrums are controlled through the weights parameter</li>
<li>No default value is set if not provided and this will throw an error if you try to call functions that depend on this parameter</li>
<li>It is left as optional so that functions that allow wavelength input can be called on objects without having to pre-input wavelengths</li>
</ul></td>
        </tr>
        <tr>
          <td><code>positions</code></td>
          <td>
                <code>ndarray, optional</code>
          </td>
          <td><ul>
<li>An array of (x,y) stellar positions in units of radians, measured as deviation of the optical axis. </li>
<li>Its input shape should be (Nstars, 2), defining an x, y position for each star. </li>
<li>If not provided, the value defaults to (0, 0) - on axis</li>
</ul></td>
        </tr>
        <tr>
          <td><code>fluxes</code></td>
          <td>
                <code>ndarray, optional</code>
          </td>
          <td><ul>
<li>An array of stellar fluxes, its length must match the positions inputs size to work properly</li>
<li>Theoretically this has arbitrary units, but we think of it as photons</li>
<li>Defaults to 1 (ie, returning a unitary flux psf if not specified)</li>
</ul></td>
        </tr>
        <tr>
          <td><code>weights</code></td>
          <td>
                <code>ndarray, optional</code>
          </td>
          <td><ul>
<li>An array of stellar spectral weights (arb units)</li>
<li>This can take multiple shapes</li>
<li>Default is to weight all wavelengths equally (top-hat)</li>
<li>If a 1d array is provided this is applied to all stars, shape (Nwavels)</li>
<li>if a 2d array is provided each is applied to each individual star, shape (Nstars, Nwavels)</li>
<li>Note the inputs values are always normalised and will not directly change total output flux (inderectly it can change it by weighting more flux to wavelengths with more aperture losses, for example)</li>
</ul></td>
        </tr>
        <tr>
          <td><code>dithers</code></td>
          <td>
                <code>ndarray, optional</code>
          </td>
          <td><ul>
<li>An arary of (x, y) positional dithers in units of radians</li>
<li>Its input shape should be (Nims, 2), defining the (x,y) dither for each image</li>
<li>if not provided, defualts to no-dither</li>
</ul></td>
        </tr>
        <tr>
          <td><code>detector_layers</code></td>
          <td>
                <code>list, optional</code>
          </td>
          <td><ul>
<li>A second list of layer objects designed to allow processing of psfs, rather than wavefronts</li>
<li>It is applied to each image after psfs have been approraitely weighted and summed</li>
</ul></td>
        </tr>
    </tbody>
  </table>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.Nims" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Nims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dithers</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.Nstars" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Nstars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.Nwavels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Nwavels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavels</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.detector_layers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">detector_layers</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">detector_layers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">detector_layers</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.dithers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dithers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="k">if</span> <span class="n">dithers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dithers</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.fluxes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fluxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">))</span> <span class="k">if</span> <span class="n">fluxes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fluxes</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.layers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">layers</span> <span class="o">=</span> <span class="n">layers</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.positions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="k">if</span> <span class="n">positions</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.wavels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wavels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wavels</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.core.OpticalSystem.weights" class="doc doc-heading">
<code class="highlight language-python"><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavels</span><span class="p">))</span> <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">wavels</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fluxes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dithers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">detector_layers</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.apply_detector_layers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">apply_detector_layers</span><span class="p">(</span><span class="n">image</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.debug_prop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">debug_prop</span><span class="p">(</span><span class="n">wavel</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>I believe this is diffable but there is no reason to force it to be</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.dither_positions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dither_positions</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Dithers the input positions, returned with shape (Npsfs, 2)</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.propagate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">propagate</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Maps the wavelength and position calcualtions across multiple dimesions</p>
<p>To Do: Reformat the vmaps such that we only vmap over wavelengths and
positions in order to simplify the dimensionality</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.propagate_mono" class="doc doc-heading">
<code class="highlight language-python"><span class="n">propagate_mono</span><span class="p">(</span><span class="n">wavel</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span></code>

</h2>


  <div class="doc doc-contents ">
  
      

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.propagate_single" class="doc doc-heading">
<code class="highlight language-python"><span class="n">propagate_single</span><span class="p">(</span><span class="n">wavels</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">weights</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">apply_detector</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Only propagates a single star, allowing wavelength input
sums output to single array</p>
<p>Wavels must be an array and the same shape as weights if provided</p>

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.reshape_psfs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reshape_psfs</span><span class="p">(</span><span class="n">psfs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.core.OpticalSystem.weight_psfs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">weight_psfs</span><span class="p">(</span><span class="n">psfs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Normalise Weights, and format weights/fluxes
Psfs output shape: (Nims, Nstars, Nwavels, npix, npix)
We want weights shape: (1, 1, Nwavels, 1, 1)
We want fluxes shape: (1, Nstars, 1, 1, 1)</p>

  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../model/" class="md-footer__link md-footer__link--prev" aria-label="Previous: model" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              model
            </div>
          </div>
        </a>
      
      
        
        <a href="../../optics/create_wavefront/" class="md-footer__link md-footer__link--next" aria-label="Next: Create Wavefront" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Create Wavefront
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/gh/rod2ik/cdn@main/mkdocs/javascripts/mkdocs-graphviz.js"></script>
      
    
  </body>
</html>