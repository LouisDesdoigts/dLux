
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for dLux.">
      
      
        <meta name="author" content="Louis Desdoigts">
      
      
        <link rel="canonical" href="https://louisdesdoigts.github.io/dlux/docs/API/optics/">
      
      
        <link rel="prev" href="../core/">
      
      
        <link rel="next" href="../apertures/">
      
      <link rel="icon" href="../../../material/telescope">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.14">
    
    
      
        <title>Optics - dLux</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#optics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dLux" class="md-header__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dLux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Optics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dLux" class="md-nav__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    dLux
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../creating_a_layer/" class="md-nav__link">
        Creating a Layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/phase_retrieval_demo/" class="md-nav__link">
        Phase Retrieval in dLux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/designing_a_mask/" class="md-nav__link">
        Phase Mask Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/flatfield_calibration/" class="md-nav__link">
        Pixel Level Calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/fisher_information/" class="md-nav__link">
        Fisher Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/HMC/" class="md-nav__link">
        Numpyro and Hamiltonian Monte Carlo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          dLux API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          dLux API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        Core
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Optics
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../apertures/" class="md-nav__link">
        Apertures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aberrations/" class="md-nav__link">
        Aberrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../propagators/" class="md-nav__link">
        Propagators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wavefronts/" class="md-nav__link">
        Wavefronts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detectors/" class="md-nav__link">
        Detectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/" class="md-nav__link">
        Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spectrums/" class="md-nav__link">
        Spectrums
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observations/" class="md-nav__link">
        Observations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Utils API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Utils API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics_util/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../math.md" class="md-nav__link">
        Math
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coordinates/" class="md-nav__link">
        Coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bayes/" class="md-nav__link">
        Bayes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/" class="md-nav__link">
        Helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        Change Log
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="optics">Optics<a class="headerlink" href="#optics" title="Permanent link">¤</a></h1>
<p>The <code>optics.py</code> script contains the general <code>OpticalLayer</code> classes. The main class is <code>OpticalLayer</code> which is the base class for all other optical layers, including those in <code>apertures.py</code>, <code>aberrations.py</code> and <code>propagators.py</code>. Unless you are creating a new optical layer, you will not need to use this class directly.</p>
<hr />
<h2 id="create-wavefront">Create Wavefront<a class="headerlink" href="#create-wavefront" title="Permanent link">¤</a></h2>
<p>This layer should be the first layer of almost all set of optical layers. It is used to initialise the wavefront object by specifying the number of pixels and the diameter of the wavefront.</p>
<details class="info">
<summary>CreateWavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.CreateWavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Initialises the relevant Wavefront class with the specified attributes.
Also applies the tilt specified by the source object, defined in the
parameters dictionary. All wavefronts are cosntructed in the Pupil plane.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels used to represent the wavefront.</p></td>
        </tr>
        <tr>
          <td><code>diameter</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, meters</code>
          </td>
          <td><p>The diameter of the wavefront in the Pupil plane.</p></td>
        </tr>
        <tr>
          <td><code>wavefront_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Determines the type of wavefront class to create. Currently supports
'Cartesian', 'Angular', 'FarFieldFresnel'.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CreateWavefront</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialises the relevant Wavefront class with the specified attributes.</span>
<span class="sd">    Also applies the tilt specified by the source object, defined in the</span>
<span class="sd">    parameters dictionary. All wavefronts are cosntructed in the Pupil plane.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels used to represent the wavefront.</span>
<span class="sd">    diameter: Array, meters</span>
<span class="sd">        The diameter of the wavefront in the Pupil plane.</span>
<span class="sd">    wavefront_type: str</span>
<span class="sd">        Determines the type of wavefront class to create. Currently supports</span>
<span class="sd">        &#39;Cartesian&#39;, &#39;Angular&#39;, &#39;FarFieldFresnel&#39;.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npixels</span>        <span class="p">:</span> <span class="nb">int</span>
    <span class="n">diameter</span>       <span class="p">:</span> <span class="n">Array</span>
    <span class="n">wavefront_type</span> <span class="p">:</span> <span class="nb">str</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>           <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">npixels</span>        <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">diameter</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">wavefront_type</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Angular&#39;</span><span class="p">,</span>
                 <span class="n">name</span>           <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;CreateWavefront&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the CreateWavefront class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels used to represent the wavefront.</span>
<span class="sd">        diameter: Array, meters</span>
<span class="sd">            The diameter of the wavefront in the Pupil plane.</span>
<span class="sd">        wavefront_type: str = &#39;Angular&#39;</span>
<span class="sd">            Determines the type of wavefront class to create. Currently supports</span>
<span class="sd">            &#39;Cartesian&#39;, &#39;Angular&#39;, &#39;FarFieldFresnel&#39;.</span>
<span class="sd">        name : str = &#39;CreateWavefront&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">            Default is &#39;CreateWavefront&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>        <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">npixels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">diameter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavefront_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">wavefront_type</span><span class="p">)</span>

        <span class="c1"># Input checks</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;diameter must be &quot;</span>
        <span class="s2">&quot;a scalar array.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">wavefront_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Cartesian&#39;</span><span class="p">,</span> <span class="s1">&#39;Angular&#39;</span><span class="p">,</span> <span class="s1">&#39;FarFieldFresnel&#39;</span><span class="p">),</span> \
        <span class="p">(</span><span class="s2">&quot;wavefront_type must be either &#39;Cartesian&#39;, &#39;Angular&#39; or &quot;</span>
         <span class="s2">&quot;&#39;FarFieldFresnel&#39;&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span>               <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">wavefront</span>          <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">parameters</span>         <span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                 <span class="n">returns_parameters</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a wavefront obect based on the parameters of the class and</span>
<span class="sd">        the parameters within the parameters dictionary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : None</span>
<span class="sd">            Any empty None type input to the class in order to maintain the</span>
<span class="sd">            input conventions determied by the apply method of OpticalLayers.</span>
<span class="sd">        parameters : dict</span>
<span class="sd">            A dictionary of parameters needed to construct the wavefront.</span>
<span class="sd">        returns_parameters : bool = True</span>
<span class="sd">            Determines if the class returns the parameters dictionary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront, parameters : (Wavefront, dict)</span>
<span class="sd">            Returns the constructed wavefront and the updated parameters</span>
<span class="sd">            dictionary. If returns_parameters is False, only the wavefront is</span>
<span class="sd">            returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the wavelength</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;wavelength&quot;</span><span class="p">]</span>

        <span class="c1"># Determine the pixel scale</span>
        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>

        <span class="c1"># Construct normalised Amplitude</span>
        <span class="n">amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">))</span>
        <span class="n">amplitude</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span>

        <span class="c1"># Construct empty phases</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(((</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">)))</span>

        <span class="c1"># Get correct Wavefront type</span>
        <span class="n">wavefront_constructor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dLux</span><span class="o">.</span><span class="n">wavefronts</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">wavefront_type</span> <span class="o">+</span> <span class="s2">&quot;Wavefront&quot;</span><span class="p">)</span>

        <span class="c1"># Construct Wavefront</span>
        <span class="n">wavefront</span> <span class="o">=</span> <span class="n">wavefront_constructor</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span>
                                      <span class="n">phase</span><span class="p">,</span> <span class="n">dLux</span><span class="o">.</span><span class="n">wavefronts</span><span class="o">.</span><span class="n">PlaneType</span><span class="o">.</span><span class="n">Pupil</span><span class="p">)</span>

        <span class="c1"># Tilt wavefront from source offset</span>
        <span class="n">wavefront</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">tilt_wavefront</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="p">])</span>

        <span class="c1"># Kill PlaneType Gradients</span>
        <span class="n">is_leaf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dLux</span><span class="o">.</span><span class="n">wavefronts</span><span class="o">.</span><span class="n">PlaneType</span><span class="p">)</span>
        <span class="n">kill_gradient</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">stop_gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
        <span class="n">wavefront</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="n">kill_gradient</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_leaf</span><span class="p">)</span>

        <span class="c1"># Update the parameters dictionary with the constructed wavefront</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;Wavefront&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wavefront</span>

        <span class="c1"># Return either the wavefront or wavefront and parameters dictionary</span>
        <span class="k">if</span> <span class="n">returns_parameters</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wavefront</span><span class="p">,</span> <span class="n">parameters</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wavefront</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Creates a </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wavefront_type</span><span class="si">}</span><span class="s2"> wavefront of &quot;</span> 
                <span class="sa">f</span><span class="s2">&quot;size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="si">}</span><span class="s2"> pixels and diameter </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">diameter</span><span class="si">}</span><span class="s2"> m.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.CreateWavefront.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">returns_parameters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#dLux.optics.CreateWavefront.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructs a wavefront obect based on the parameters of the class and
the parameters within the parameters dictionary.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>None</code>
          </td>
          <td><p>Any empty None type input to the class in order to maintain the
input conventions determied by the apply method of OpticalLayers.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>parameters</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>A dictionary of parameters needed to construct the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>returns_parameters</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the class returns the parameters dictionary.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>wavefront, parameters</code>
          </td>
          <td><p>Returns the constructed wavefront and the updated parameters
dictionary. If returns_parameters is False, only the wavefront is
returned.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span>               <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">wavefront</span>          <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">parameters</span>         <span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
             <span class="n">returns_parameters</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs a wavefront obect based on the parameters of the class and</span>
<span class="sd">    the parameters within the parameters dictionary.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : None</span>
<span class="sd">        Any empty None type input to the class in order to maintain the</span>
<span class="sd">        input conventions determied by the apply method of OpticalLayers.</span>
<span class="sd">    parameters : dict</span>
<span class="sd">        A dictionary of parameters needed to construct the wavefront.</span>
<span class="sd">    returns_parameters : bool = True</span>
<span class="sd">        Determines if the class returns the parameters dictionary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront, parameters : (Wavefront, dict)</span>
<span class="sd">        Returns the constructed wavefront and the updated parameters</span>
<span class="sd">        dictionary. If returns_parameters is False, only the wavefront is</span>
<span class="sd">        returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the wavelength</span>
    <span class="n">wavelength</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;wavelength&quot;</span><span class="p">]</span>

    <span class="c1"># Determine the pixel scale</span>
    <span class="n">pixel_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>

    <span class="c1"># Construct normalised Amplitude</span>
    <span class="n">amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">))</span>
    <span class="n">amplitude</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span>

    <span class="c1"># Construct empty phases</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(((</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">)))</span>

    <span class="c1"># Get correct Wavefront type</span>
    <span class="n">wavefront_constructor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dLux</span><span class="o">.</span><span class="n">wavefronts</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">wavefront_type</span> <span class="o">+</span> <span class="s2">&quot;Wavefront&quot;</span><span class="p">)</span>

    <span class="c1"># Construct Wavefront</span>
    <span class="n">wavefront</span> <span class="o">=</span> <span class="n">wavefront_constructor</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span>
                                  <span class="n">phase</span><span class="p">,</span> <span class="n">dLux</span><span class="o">.</span><span class="n">wavefronts</span><span class="o">.</span><span class="n">PlaneType</span><span class="o">.</span><span class="n">Pupil</span><span class="p">)</span>

    <span class="c1"># Tilt wavefront from source offset</span>
    <span class="n">wavefront</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">tilt_wavefront</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="p">])</span>

    <span class="c1"># Kill PlaneType Gradients</span>
    <span class="n">is_leaf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dLux</span><span class="o">.</span><span class="n">wavefronts</span><span class="o">.</span><span class="n">PlaneType</span><span class="p">)</span>
    <span class="n">kill_gradient</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">stop_gradient</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
    <span class="n">wavefront</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="n">kill_gradient</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_leaf</span><span class="p">)</span>

    <span class="c1"># Update the parameters dictionary with the constructed wavefront</span>
    <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;Wavefront&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wavefront</span>

    <span class="c1"># Return either the wavefront or wavefront and parameters dictionary</span>
    <span class="k">if</span> <span class="n">returns_parameters</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="p">,</span> <span class="n">parameters</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wavefront</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.CreateWavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="n">wavefront_type</span><span class="o">=</span><span class="s1">&#39;Angular&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CreateWavefront&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.CreateWavefront.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the CreateWavefront class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels used to represent the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>diameter</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The diameter of the wavefront in the Pupil plane.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>wavefront_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Determines the type of wavefront class to create. Currently supports
'Cartesian', 'Angular', 'FarFieldFresnel'.</p></td>
          <td>
                <code>&#39;Angular&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.
Default is 'CreateWavefront'.</p></td>
          <td>
                <code>&#39;CreateWavefront&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>           <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">npixels</span>        <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">diameter</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">wavefront_type</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Angular&#39;</span><span class="p">,</span>
             <span class="n">name</span>           <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;CreateWavefront&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the CreateWavefront class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels used to represent the wavefront.</span>
<span class="sd">    diameter: Array, meters</span>
<span class="sd">        The diameter of the wavefront in the Pupil plane.</span>
<span class="sd">    wavefront_type: str = &#39;Angular&#39;</span>
<span class="sd">        Determines the type of wavefront class to create. Currently supports</span>
<span class="sd">        &#39;Cartesian&#39;, &#39;Angular&#39;, &#39;FarFieldFresnel&#39;.</span>
<span class="sd">    name : str = &#39;CreateWavefront&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        Default is &#39;CreateWavefront&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>        <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">npixels</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">diameter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wavefront_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">wavefront_type</span><span class="p">)</span>

    <span class="c1"># Input checks</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;diameter must be &quot;</span>
    <span class="s2">&quot;a scalar array.&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">wavefront_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Cartesian&#39;</span><span class="p">,</span> <span class="s1">&#39;Angular&#39;</span><span class="p">,</span> <span class="s1">&#39;FarFieldFresnel&#39;</span><span class="p">),</span> \
    <span class="p">(</span><span class="s2">&quot;wavefront_type must be either &#39;Cartesian&#39;, &#39;Angular&#39; or &quot;</span>
     <span class="s2">&quot;&#39;FarFieldFresnel&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.CreateWavefront.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.CreateWavefront.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Creates a </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wavefront_type</span><span class="si">}</span><span class="s2"> wavefront of &quot;</span> 
            <span class="sa">f</span><span class="s2">&quot;size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="si">}</span><span class="s2"> pixels and diameter </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">diameter</span><span class="si">}</span><span class="s2"> m.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.CreateWavefront"><a class="headerlink" href="#dLux.optics.CreateWavefront" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.CreateWavefront.__call__"><a class="headerlink" href="#dLux.optics.CreateWavefront.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.CreateWavefront.__init__"><a class="headerlink" href="#dLux.optics.CreateWavefront.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.CreateWavefront.summary"><a class="headerlink" href="#dLux.optics.CreateWavefront.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h2 id="normalise-wavefront">Normalise Wavefront<a class="headerlink" href="#normalise-wavefront" title="Permanent link">¤</a></h2>
<p>This layer is used to normalise the wavefront to a unit intensity. This simply controls at what point the wavefront is normalised to unity power. Since most calculations in optics use the collecting area of the aperture, most use cases will require this layer at some point after an aperture layer.</p>
<details class="info">
<summary>NormaliseWavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.NormaliseWavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Normalises the input wavefront using the in-built wavefront normalisation
method.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NormaliseWavefront</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalises the input wavefront using the in-built wavefront normalisation</span>
<span class="sd">    method.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">name</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;NormaliseWavefront&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the NormaliseWavefront class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : string = &#39;NormaliseWavefront&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers</span>
<span class="sd">            dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalises the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront with the wavefront normalisation method applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Normalises the wavefront to unity power.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.NormaliseWavefront.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.optics.NormaliseWavefront.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Normalises the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to operate on.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront with the wavefront normalisation method applied.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalises the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront with the wavefront normalisation method applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.NormaliseWavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NormaliseWavefront&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.NormaliseWavefront.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the NormaliseWavefront class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>string</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers
dictionary.</p></td>
          <td>
                <code>&#39;NormaliseWavefront&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">name</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;NormaliseWavefront&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the NormaliseWavefront class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : string = &#39;NormaliseWavefront&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers</span>
<span class="sd">        dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.NormaliseWavefront.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.NormaliseWavefront.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Normalises the wavefront to unity power.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.NormaliseWavefront"><a class="headerlink" href="#dLux.optics.NormaliseWavefront" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.NormaliseWavefront.__call__"><a class="headerlink" href="#dLux.optics.NormaliseWavefront.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.NormaliseWavefront.__init__"><a class="headerlink" href="#dLux.optics.NormaliseWavefront.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.NormaliseWavefront.summary"><a class="headerlink" href="#dLux.optics.NormaliseWavefront.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h2 id="tilt-wavefront">Tilt Wavefront<a class="headerlink" href="#tilt-wavefront" title="Permanent link">¤</a></h2>
<p>This class is used to tilt the wavefront by a specified angle in radians.</p>
<details class="info">
<summary>TiltWavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.TiltWavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Tilts the wavefront by the input tilt_angles.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tilt_angles</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, radians</code>
          </td>
          <td><p>The (x, y) angles by which to tilt the wavefront.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TiltWavefront</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tilts the wavefront by the input tilt_angles.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    tilt_angles : Array, radians</span>
<span class="sd">        The (x, y) angles by which to tilt the wavefront.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tilt_angles</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">tilt_angles</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;TiltWavefront&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the TiltWavefront class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tilt_angles : Array, radians</span>
<span class="sd">            The (x, y) angles by which to tilt the wavefront.</span>
<span class="sd">        name : str = TiltWavefront</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">            Default is &#39;TiltWavefront&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tilt_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tilt_angles</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Input checks</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">tilt_angles</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> \
        <span class="p">(</span><span class="s2">&quot;tilt_angles must be an array of shape (2,), ie (x, y).&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the tilt_angle to the phase of the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront with the optical layer applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">tilt_wavefront</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tilt_angles</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tilt_angles</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Tilts the wavefront by </span><span class="si">{</span><span class="n">angles</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2"> in the (x, y) dimension.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.TiltWavefront.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.optics.TiltWavefront.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the tilt_angle to the phase of the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to operate on.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront with the optical layer applied.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the tilt_angle to the phase of the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront with the optical layer applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">tilt_wavefront</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tilt_angles</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.TiltWavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">tilt_angles</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TiltWavefront&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.TiltWavefront.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the TiltWavefront class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tilt_angles</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, radians</code>
          </td>
          <td><p>The (x, y) angles by which to tilt the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.
Default is 'TiltWavefront'.</p></td>
          <td>
                <code>&#39;TiltWavefront&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">tilt_angles</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;TiltWavefront&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the TiltWavefront class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tilt_angles : Array, radians</span>
<span class="sd">        The (x, y) angles by which to tilt the wavefront.</span>
<span class="sd">    name : str = TiltWavefront</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        Default is &#39;TiltWavefront&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tilt_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tilt_angles</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Input checks</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">tilt_angles</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> \
    <span class="p">(</span><span class="s2">&quot;tilt_angles must be an array of shape (2,), ie (x, y).&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.TiltWavefront.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.TiltWavefront.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tilt_angles</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Tilts the wavefront by </span><span class="si">{</span><span class="n">angles</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2"> in the (x, y) dimension.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.TiltWavefront"><a class="headerlink" href="#dLux.optics.TiltWavefront" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.TiltWavefront.__call__"><a class="headerlink" href="#dLux.optics.TiltWavefront.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.TiltWavefront.__init__"><a class="headerlink" href="#dLux.optics.TiltWavefront.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.TiltWavefront.summary"><a class="headerlink" href="#dLux.optics.TiltWavefront.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h2 id="transmissive-optic">Transmissive Optic<a class="headerlink" href="#transmissive-optic" title="Permanent link">¤</a></h2>
<p>This layer takes in an array of per-pixel tranmission values and multiplies the wavefront amplitude by these values. Input arrays must be the same size as the wavefront. Values should be between 0 and 1, but this is not enforced.</p>
<details class="info">
<summary>TransmissiveOptic API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.TransmissiveOptic"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Represents an arbitrary transmissive optic.</p>
<p>Note this class does not normalise the 'transmission' between 0 and 1, but
simply multiplies the wavefront amplitude by the transmision array.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>transmission</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>An array representing the transmission of the optic.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TransmissiveOptic</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents an arbitrary transmissive optic.</span>

<span class="sd">    Note this class does not normalise the &#39;transmission&#39; between 0 and 1, but</span>
<span class="sd">    simply multiplies the wavefront amplitude by the transmision array.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    transmission : Array</span>
<span class="sd">        An array representing the transmission of the optic.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transmission</span><span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">transmission</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;TransmissiveOptic&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the TransmissiveOptic class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        transmission : Array</span>
<span class="sd">            The array representing the transmission of the aperture. This must</span>
<span class="sd">            a 0, 2 or 3 dimensional array with equal to that of the wavefront</span>
<span class="sd">            at time of aplication.</span>
<span class="sd">        name : str = &#39;TransmissiveOptic&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transmission</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">transmission</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Input checks</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">transmission</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;transmission must be &quot;</span>
        <span class="s2">&quot;either a scalar array, or a 2 or 3 dimensional array.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the tranmission of the optical to the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront with the tranmission applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">multiply_amplitude</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transmission</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Applies an array of tranmission values to the &quot;</span>
                <span class="s2">&quot;Wavefront.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.TransmissiveOptic.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.optics.TransmissiveOptic.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the tranmission of the optical to the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to operate on.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront with the tranmission applied.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the tranmission of the optical to the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront with the tranmission applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">multiply_amplitude</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transmission</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.TransmissiveOptic.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">transmission</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TransmissiveOptic&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.TransmissiveOptic.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the TransmissiveOptic class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>transmission</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The array representing the transmission of the aperture. This must
a 0, 2 or 3 dimensional array with equal to that of the wavefront
at time of aplication.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;TransmissiveOptic&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">transmission</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;TransmissiveOptic&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the TransmissiveOptic class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    transmission : Array</span>
<span class="sd">        The array representing the transmission of the aperture. This must</span>
<span class="sd">        a 0, 2 or 3 dimensional array with equal to that of the wavefront</span>
<span class="sd">        at time of aplication.</span>
<span class="sd">    name : str = &#39;TransmissiveOptic&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transmission</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">transmission</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Input checks</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">transmission</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;transmission must be &quot;</span>
    <span class="s2">&quot;either a scalar array, or a 2 or 3 dimensional array.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.TransmissiveOptic.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.TransmissiveOptic.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Applies an array of tranmission values to the &quot;</span>
            <span class="s2">&quot;Wavefront.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.TransmissiveOptic"><a class="headerlink" href="#dLux.optics.TransmissiveOptic" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.TransmissiveOptic.__call__"><a class="headerlink" href="#dLux.optics.TransmissiveOptic.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.TransmissiveOptic.__init__"><a class="headerlink" href="#dLux.optics.TransmissiveOptic.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.TransmissiveOptic.summary"><a class="headerlink" href="#dLux.optics.TransmissiveOptic.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h2 id="add-phase">Add Phase<a class="headerlink" href="#add-phase" title="Permanent link">¤</a></h2>
<p>This layer takes in an array of per-pixel phase values in radians and adds it to the wavefront. Input arrays must be the same size as the wavefront.</p>
<details class="info">
<summary>AddPhase API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.AddPhase"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Adds an array of phase values to the wavefront.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, radians</code>
          </td>
          <td><p>The Array of phase values to be applied to the input wavefront.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AddPhase</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an array of phase values to the wavefront.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    phase: Array, radians</span>
<span class="sd">        The Array of phase values to be applied to the input wavefront.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">phase</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>  <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">phase</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">name</span>  <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;AddPhase&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the AddPhase class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phase : Array, radians</span>
<span class="sd">            Array of phase values to be applied to the input wavefront. This</span>
<span class="sd">            must a 0, 2 or 3 dimensional array with equal to that of the </span>
<span class="sd">            wavefront at time of aplication.</span>
<span class="sd">        name : str = &#39;AddPhase&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Input checks</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;phase must be either a scalar &quot;</span>
        <span class="s2">&quot;array, or a 2 or 3 dimensional array.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the phase to the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront with the phase added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Add an array of phase values to the wavefront.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.AddPhase.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.optics.AddPhase.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Adds the phase to the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to operate on.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront with the phase added.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds the phase to the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront with the phase added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.AddPhase.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;AddPhase&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.AddPhase.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the AddPhase class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, radians</code>
          </td>
          <td><p>Array of phase values to be applied to the input wavefront. This
must a 0, 2 or 3 dimensional array with equal to that of the 
wavefront at time of aplication.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;AddPhase&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>  <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">phase</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">name</span>  <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;AddPhase&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the AddPhase class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        Array of phase values to be applied to the input wavefront. This</span>
<span class="sd">        must a 0, 2 or 3 dimensional array with equal to that of the </span>
<span class="sd">        wavefront at time of aplication.</span>
<span class="sd">    name : str = &#39;AddPhase&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Input checks</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;phase must be either a scalar &quot;</span>
    <span class="s2">&quot;array, or a 2 or 3 dimensional array.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.AddPhase.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.AddPhase.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Add an array of phase values to the wavefront.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.AddPhase"><a class="headerlink" href="#dLux.optics.AddPhase" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.AddPhase.__call__"><a class="headerlink" href="#dLux.optics.AddPhase.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.AddPhase.__init__"><a class="headerlink" href="#dLux.optics.AddPhase.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.AddPhase.summary"><a class="headerlink" href="#dLux.optics.AddPhase.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h2 id="add-opd">Add OPD<a class="headerlink" href="#add-opd" title="Permanent link">¤</a></h2>
<p>This layer takes in an array of per-pixel Optical Path Difference (OPD) values in meters and adds it to the wavefront. Input arrays must be the same size as the wavefront.</p>
<details class="info">
<summary>AddOPD API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.AddOPD"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Adds an Optical Path Difference (OPD) to the wavefront.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>opd</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, meters</code>
          </td>
          <td><p>Array of OPD values to be applied to the input wavefront.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AddOPD</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an Optical Path Difference (OPD) to the wavefront.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    opd : Array, meters</span>
<span class="sd">        Array of OPD values to be applied to the input wavefront.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opd</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">opd</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">name</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;AddOPD&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the ApplyOPD class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        opd : float, meters</span>
<span class="sd">            The Array of OPDs to be applied to the input wavefront. This must</span>
<span class="sd">            a 0, 2 or 3 dimensional array with equal to that of the wavefront</span>
<span class="sd">            at time of aplication.</span>
<span class="sd">        name : str = &#39;AddOPD&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">opd</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Input checks</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">opd</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;opd must be either a scalar &quot;</span>
        <span class="s2">&quot;array, or a 2 or 3 dimensional array.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the OPD array to the input wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront with the OPD added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opd</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Add an array of Optical Path Differences (OPD) &quot;</span>
                <span class="s2">&quot;to the wavefront.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.AddOPD.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.optics.AddOPD.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Apply the OPD array to the input wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to operate on.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront with the OPD added.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the OPD array to the input wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront with the OPD added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opd</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.AddOPD.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">opd</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;AddOPD&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.AddOPD.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the ApplyOPD class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>opd</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The Array of OPDs to be applied to the input wavefront. This must
a 0, 2 or 3 dimensional array with equal to that of the wavefront
at time of aplication.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;AddOPD&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">opd</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">name</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;AddOPD&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the ApplyOPD class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    opd : float, meters</span>
<span class="sd">        The Array of OPDs to be applied to the input wavefront. This must</span>
<span class="sd">        a 0, 2 or 3 dimensional array with equal to that of the wavefront</span>
<span class="sd">        at time of aplication.</span>
<span class="sd">    name : str = &#39;AddOPD&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">opd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">opd</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Input checks</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">opd</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;opd must be either a scalar &quot;</span>
    <span class="s2">&quot;array, or a 2 or 3 dimensional array.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.AddOPD.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.AddOPD.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Add an array of Optical Path Differences (OPD) &quot;</span>
            <span class="s2">&quot;to the wavefront.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.AddOPD"><a class="headerlink" href="#dLux.optics.AddOPD" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.AddOPD.__call__"><a class="headerlink" href="#dLux.optics.AddOPD.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.AddOPD.__init__"><a class="headerlink" href="#dLux.optics.AddOPD.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.AddOPD.summary"><a class="headerlink" href="#dLux.optics.AddOPD.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h2 id="apply-basis-opd">Apply Basis OPD<a class="headerlink" href="#apply-basis-opd" title="Permanent link">¤</a></h2>
<p>This layer takes in a set of basis vectors and (optionally) coefficients, which is then used to calculate the total OPD and adds the resulting OPD to the wavefront. The basis vectors should have three dimensions and the coefficients one. This can be used to add a set of (typically) Zernike polynomials to the wavefront, although any set of basis vectors can be used.</p>
<details class="info">
<summary>ApplyBasisOPD API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.ApplyBasisOPD"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Adds an array of phase values to the input wavefront calculated from the
Optical Path Difference (OPD). The OPDs are calculated from the basis
arrays, and weighted by the coefficients, and converted to phases by the
wavefront methods.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>basis</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, meters</code>
          </td>
          <td><p>Arrays holding the pre-calculated basis vectors.</p></td>
        </tr>
        <tr>
          <td><code>coefficients</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The Array of coefficients to be applied to each basis vector.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ApplyBasisOPD</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an array of phase values to the input wavefront calculated from the</span>
<span class="sd">    Optical Path Difference (OPD). The OPDs are calculated from the basis</span>
<span class="sd">    arrays, and weighted by the coefficients, and converted to phases by the</span>
<span class="sd">    wavefront methods.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    basis: Array, meters</span>
<span class="sd">        Arrays holding the pre-calculated basis vectors.</span>
<span class="sd">    coefficients: Array</span>
<span class="sd">        The Array of coefficients to be applied to each basis vector.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basis</span>        <span class="p">:</span> <span class="n">Array</span>
    <span class="n">coefficients</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">basis</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">coefficients</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ApplyBasisOPD&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the ApplyBasisOPD class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        basis : Array, meters</span>
<span class="sd">            The Array of basis polynomials. This should be a 3 dimensional Array</span>
<span class="sd">            with the first dimension being the number of basis vectors, and the</span>
<span class="sd">            last two dimensions being equal to the wavefront shape at the time</span>
<span class="sd">            of application to the wavefront.</span>
<span class="sd">        coefficients : Array = None</span>
<span class="sd">            The coefficients by which to weight the basis vectors. This must</span>
<span class="sd">            have the same length as the first dimension of the basis Array. If</span>
<span class="sd">            None is supplied an Array of zeros is constructed.</span>
<span class="sd">        name : str = &#39;ApplyBasisOPD&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">coefficients</span> <span class="ow">is</span> <span class="kc">None</span> \
                            <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Input checks</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;basis must be a 3 dimensional array, ie (nterms, npixels, npixels).&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
        <span class="p">(</span><span class="s2">&quot;coefficients must be a 1 dimensional array with length equal to the &quot;</span>
        <span class="s2">&quot;First dimension of the basis array.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function to calculate the total OPD from the basis vector and the</span>
<span class="sd">        coefficients.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OPD : Array, meters</span>
<span class="sd">            The total OPD calulated from the basis vectors and coefficients.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate and apply the appropriate phase shift to the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront with the appropriate phase applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_opd</span><span class="p">())</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Applies an Optical Path Difference (OPD) to the &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;wavefront calculated from the basis vectors and coefficients.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.ApplyBasisOPD.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.optics.ApplyBasisOPD.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculate and apply the appropriate phase shift to the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to operate on.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront with the appropriate phase applied.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate and apply the appropriate phase shift to the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront with the appropriate phase applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_opd</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.ApplyBasisOPD.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">coefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ApplyBasisOPD&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.ApplyBasisOPD.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the ApplyBasisOPD class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>basis</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, meters</code>
          </td>
          <td><p>The Array of basis polynomials. This should be a 3 dimensional Array
with the first dimension being the number of basis vectors, and the
last two dimensions being equal to the wavefront shape at the time
of application to the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>coefficients</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The coefficients by which to weight the basis vectors. This must
have the same length as the first dimension of the basis Array. If
None is supplied an Array of zeros is constructed.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;ApplyBasisOPD&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">basis</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">coefficients</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ApplyBasisOPD&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the ApplyBasisOPD class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    basis : Array, meters</span>
<span class="sd">        The Array of basis polynomials. This should be a 3 dimensional Array</span>
<span class="sd">        with the first dimension being the number of basis vectors, and the</span>
<span class="sd">        last two dimensions being equal to the wavefront shape at the time</span>
<span class="sd">        of application to the wavefront.</span>
<span class="sd">    coefficients : Array = None</span>
<span class="sd">        The coefficients by which to weight the basis vectors. This must</span>
<span class="sd">        have the same length as the first dimension of the basis Array. If</span>
<span class="sd">        None is supplied an Array of zeros is constructed.</span>
<span class="sd">    name : str = &#39;ApplyBasisOPD&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">basis</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">coefficients</span> <span class="ow">is</span> <span class="kc">None</span> \
                        <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Input checks</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;basis must be a 3 dimensional array, ie (nterms, npixels, npixels).&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
    <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
    <span class="p">(</span><span class="s2">&quot;coefficients must be a 1 dimensional array with length equal to the &quot;</span>
    <span class="s2">&quot;First dimension of the basis array.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.ApplyBasisOPD.get_opd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_opd</span><span class="p">()</span></code>

<a href="#dLux.optics.ApplyBasisOPD.get_opd" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>A function to calculate the total OPD from the basis vector and the
coefficients.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>OPD</code></td>          <td>
                <code><span title="dLux.optics.Array">Array</span>, meters</code>
          </td>
          <td><p>The total OPD calulated from the basis vectors and coefficients.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function to calculate the total OPD from the basis vector and the</span>
<span class="sd">    coefficients.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    OPD : Array, meters</span>
<span class="sd">        The total OPD calulated from the basis vectors and coefficients.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.ApplyBasisOPD.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.ApplyBasisOPD.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Applies an Optical Path Difference (OPD) to the &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;wavefront calculated from the basis vectors and coefficients.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.ApplyBasisOPD"><a class="headerlink" href="#dLux.optics.ApplyBasisOPD" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.ApplyBasisOPD.__call__"><a class="headerlink" href="#dLux.optics.ApplyBasisOPD.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.ApplyBasisOPD.__init__"><a class="headerlink" href="#dLux.optics.ApplyBasisOPD.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.ApplyBasisOPD.get_opd"><a class="headerlink" href="#dLux.optics.ApplyBasisOPD.get_opd" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.ApplyBasisOPD.summary"><a class="headerlink" href="#dLux.optics.ApplyBasisOPD.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h2 id="rotate">Rotate<a class="headerlink" href="#rotate" title="Permanent link">¤</a></h2>
<p>This layer rotates the wavefront by a specified angle in radians.</p>
<details class="info">
<summary>Rotate API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.Rotate"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Applies a rotation to the wavefront using interpolation methods.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angle</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span>, radians</code>
          </td>
          <td><p>The angle by which to rotate the wavefront in the clockwise direction.</p></td>
        </tr>
        <tr>
          <td><code>real_imaginary</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the rotation be performed on the amplitude and phase array
or the real and imaginary arrays.</p></td>
        </tr>
        <tr>
          <td><code>fourier</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the rotation be done using fourier methods or interpolation.</p></td>
        </tr>
        <tr>
          <td><code>order</code></td>
          <td>
                <code>int = 1</code>
          </td>
          <td><p>The order of the interpolation to use. Only applies if fourier is
False. Must be 0, 1, or 3.</p></td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The amount of padding to use if the fourier method is used.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Rotate</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies a rotation to the wavefront using interpolation methods.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    angle : Array, radians</span>
<span class="sd">        The angle by which to rotate the wavefront in the clockwise direction.</span>
<span class="sd">    real_imaginary : bool</span>
<span class="sd">        Should the rotation be performed on the amplitude and phase array</span>
<span class="sd">        or the real and imaginary arrays.</span>
<span class="sd">    fourier : bool</span>
<span class="sd">        Should the rotation be done using fourier methods or interpolation.</span>
<span class="sd">    order : int = 1</span>
<span class="sd">        The order of the interpolation to use. Only applies if fourier is</span>
<span class="sd">        False. Must be 0, 1, or 3.</span>
<span class="sd">    padding : int</span>
<span class="sd">        The amount of padding to use if the fourier method is used.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle</span>          <span class="p">:</span> <span class="n">Array</span>
    <span class="n">real_imaginary</span> <span class="p">:</span> <span class="nb">bool</span>
    <span class="n">fourier</span>        <span class="p">:</span> <span class="nb">bool</span>
    <span class="n">order</span>          <span class="p">:</span> <span class="nb">int</span>
    <span class="n">padding</span>        <span class="p">:</span> <span class="nb">int</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>           <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">angle</span>          <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">real_imaginary</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">fourier</span>        <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">order</span>          <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="n">padding</span>        <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span>           <span class="p">:</span> <span class="nb">str</span>  <span class="o">=</span> <span class="s1">&#39;Rotate&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the Rotate class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle: float, radians</span>
<span class="sd">            The angle by which to rotate the wavefront in the clockwise </span>
<span class="sd">            direction.</span>
<span class="sd">        real_imaginary : bool = False</span>
<span class="sd">            Should the rotation be performed on the amplitude and phase array</span>
<span class="sd">            or the real and imaginary arrays.</span>
<span class="sd">        fourier : bool = False</span>
<span class="sd">            Should the fourier rotation method be used (True), or regular</span>
<span class="sd">            interpolation method be used (False).</span>
<span class="sd">        order : int = 1</span>
<span class="sd">            The order of the interpolation to use. Only applies if fourier is</span>
<span class="sd">            False. Must be 0, 1, or 3.</span>
<span class="sd">        padding : int = None</span>
<span class="sd">            The amount of fourier padding to use. Only applies if fourier is</span>
<span class="sd">            True.</span>
<span class="sd">        name : str = &#39;Rotate&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_imaginary</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">real_imaginary</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Order must be 0, 1, or 3.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fourier</span>        <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">fourier</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span> <span class="k">if</span> <span class="n">padding</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;angle must be scalar array.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the rotation to a wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The rotated wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_imaginary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">]</span>
        <span class="n">args</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;a Fourier method with padding of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;an Interpolation method of order 1&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_imaginary</span><span class="p">:</span>
            <span class="n">wf_type</span> <span class="o">=</span> <span class="s2">&quot;real and imaginary arrays&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wf_type</span> <span class="o">=</span> <span class="s2">&quot;amplitude and phase arrays&quot;</span>

        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Applies a </span><span class="si">{</span><span class="n">angle</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;rotation to the wavefront </span><span class="si">{</span><span class="n">wf_type</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.Rotate.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.optics.Rotate.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the rotation to a wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to operate on.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The rotated wavefront.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the rotation to a wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The rotated wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_imaginary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">]</span>
    <span class="n">args</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.Rotate.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">real_imaginary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fourier</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Rotate&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.Rotate.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the Rotate class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angle</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The angle by which to rotate the wavefront in the clockwise 
direction.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>real_imaginary</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the rotation be performed on the amplitude and phase array
or the real and imaginary arrays.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>fourier</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the fourier rotation method be used (True), or regular
interpolation method be used (False).</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>order</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The order of the interpolation to use. Only applies if fourier is
False. Must be 0, 1, or 3.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The amount of fourier padding to use. Only applies if fourier is
True.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;Rotate&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>           <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">angle</span>          <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">real_imaginary</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">fourier</span>        <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">order</span>          <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">padding</span>        <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">name</span>           <span class="p">:</span> <span class="nb">str</span>  <span class="o">=</span> <span class="s1">&#39;Rotate&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the Rotate class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angle: float, radians</span>
<span class="sd">        The angle by which to rotate the wavefront in the clockwise </span>
<span class="sd">        direction.</span>
<span class="sd">    real_imaginary : bool = False</span>
<span class="sd">        Should the rotation be performed on the amplitude and phase array</span>
<span class="sd">        or the real and imaginary arrays.</span>
<span class="sd">    fourier : bool = False</span>
<span class="sd">        Should the fourier rotation method be used (True), or regular</span>
<span class="sd">        interpolation method be used (False).</span>
<span class="sd">    order : int = 1</span>
<span class="sd">        The order of the interpolation to use. Only applies if fourier is</span>
<span class="sd">        False. Must be 0, 1, or 3.</span>
<span class="sd">    padding : int = None</span>
<span class="sd">        The amount of fourier padding to use. Only applies if fourier is</span>
<span class="sd">        True.</span>
<span class="sd">    name : str = &#39;Rotate&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angle</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">real_imaginary</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">real_imaginary</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Order must be 0, 1, or 3.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fourier</span>        <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">fourier</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span> <span class="k">if</span> <span class="n">padding</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;angle must be scalar array.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.Rotate.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.Rotate.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier</span><span class="p">:</span>
        <span class="n">method</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;a Fourier method with padding of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;an Interpolation method of order 1&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_imaginary</span><span class="p">:</span>
        <span class="n">wf_type</span> <span class="o">=</span> <span class="s2">&quot;real and imaginary arrays&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wf_type</span> <span class="o">=</span> <span class="s2">&quot;amplitude and phase arrays&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Applies a </span><span class="si">{</span><span class="n">angle</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;rotation to the wavefront </span><span class="si">{</span><span class="n">wf_type</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.Rotate"><a class="headerlink" href="#dLux.optics.Rotate" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.Rotate.__call__"><a class="headerlink" href="#dLux.optics.Rotate.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.Rotate.__init__"><a class="headerlink" href="#dLux.optics.Rotate.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.Rotate.summary"><a class="headerlink" href="#dLux.optics.Rotate.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h2 id="apply-basis-climb">Apply Basis CLIMB<a class="headerlink" href="#apply-basis-climb" title="Permanent link">¤</a></h2>
<p>This layer takes a set of basis vectors and (optionally) coefficients, which is then used to calculate a binary version of the resulting output in a continuous manner using the <a href="https://arxiv.org/abs/2107.00952">"CLIMB" algorithm</a>.</p>
<details class="info">
<summary>ApplyBasisCLIMB API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.optics.ApplyBasisCLIMB"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.optics.OpticalLayer">OpticalLayer</span></code></p>

  
      <p>Adds an array of binary phase values to the input wavefront from a set of
continuous basis vectors. This uses the CLIMB algorithm in order to
generate the binary values in a continous manner as described in the
paper Wong et al. 2021. The basis vectors are taken as an Optical Path
Difference (OPD), and applied to the phase of the wavefront. The ideal
wavelength parameter described the wavelength that will have a perfect
anti-phase relationship given by the Optical Path Difference.</p>
<p>Note: Many of the methods in the class still need doccumentation.
Note: This currently only outputs 256 pixel arrays and uses a 3x oversample,
therefore requiring a 768 pixel basis array.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>basis</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>Arrays holding the continous pre-calculated basis vectors.</p></td>
        </tr>
        <tr>
          <td><code>coefficients</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The Array of coefficients to be applied to each basis vector.</p></td>
        </tr>
        <tr>
          <td><code>ideal_wavelength</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The target wavelength at which a perfect anti-phase relationship is
applied via the OPD.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/optics.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ApplyBasisCLIMB</span><span class="p">(</span><span class="n">OpticalLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an array of binary phase values to the input wavefront from a set of</span>
<span class="sd">    continuous basis vectors. This uses the CLIMB algorithm in order to</span>
<span class="sd">    generate the binary values in a continous manner as described in the</span>
<span class="sd">    paper Wong et al. 2021. The basis vectors are taken as an Optical Path</span>
<span class="sd">    Difference (OPD), and applied to the phase of the wavefront. The ideal</span>
<span class="sd">    wavelength parameter described the wavelength that will have a perfect</span>
<span class="sd">    anti-phase relationship given by the Optical Path Difference.</span>

<span class="sd">    Note: Many of the methods in the class still need doccumentation.</span>
<span class="sd">    Note: This currently only outputs 256 pixel arrays and uses a 3x oversample,</span>
<span class="sd">    therefore requiring a 768 pixel basis array.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    basis: Array</span>
<span class="sd">        Arrays holding the continous pre-calculated basis vectors.</span>
<span class="sd">    coefficients: Array</span>
<span class="sd">        The Array of coefficients to be applied to each basis vector.</span>
<span class="sd">    ideal_wavelength : Array</span>
<span class="sd">        The target wavelength at which a perfect anti-phase relationship is</span>
<span class="sd">        applied via the OPD.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basis</span>            <span class="p">:</span> <span class="n">Array</span>
    <span class="n">coefficients</span>     <span class="p">:</span> <span class="n">Array</span>
    <span class="n">ideal_wavelength</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>             <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
                 <span class="n">basis</span>            <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">ideal_wavelength</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">coefficients</span>     <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span>             <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;ApplyBasisCLIMB&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the ApplyBasisCLIMB class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        basis : Array</span>
<span class="sd">            Arrays holding the continous pre-calculated basis vectors. This must</span>
<span class="sd">            be a 3d array of shape (nterms, npixels, npixels), with the final</span>
<span class="sd">            two dimensions matching that of the wavefront at time of</span>
<span class="sd">            application. This is currently required to be a nx768x768 shaped</span>
<span class="sd">            array. </span>
<span class="sd">        ideal_wavelength : Array</span>
<span class="sd">            The target wavelength at which a perfect anti-phase relationship is</span>
<span class="sd">            applied via the OPD.</span>
<span class="sd">        coefficients : Array = None</span>
<span class="sd">            The Array of coefficients to be applied to each basis vector. This</span>
<span class="sd">            must be a one dimensional array with leading dimension equal to the</span>
<span class="sd">            leading dimension of the basis vectors. Default is None which</span>
<span class="sd">            initialises an array of zeros.</span>
<span class="sd">        name : str = &#39;ApplyBasisCLIMB&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span>            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ideal_wavelength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ideal_wavelength</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> \
                    <span class="k">if</span> <span class="n">coefficients</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">))</span>

        <span class="c1"># Inputs checks</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;basis must be a 3 dimensional array, ie (nterms, npixels, npixels).&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">768</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;Basis must have shape (n, 768, 768).&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
        <span class="p">(</span><span class="s2">&quot;coefficients must be a 1 dimensional array with length equal to the &quot;</span>
        <span class="s2">&quot;First dimension of the basis array.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_wavelength</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;ideal_wavelength must be a &quot;</span>
                                                 <span class="s2">&quot;scalar array.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and applies the binary OPD array to the wavefront in a</span>
<span class="sd">        differentiable manner.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront with the binary OPD applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">latent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_opd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
        <span class="n">binary_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">CLIMB</span><span class="p">(</span><span class="n">latent</span><span class="p">,</span> <span class="n">ppsz</span><span class="o">=</span><span class="n">wavefront</span><span class="o">.</span><span class="n">npixels</span><span class="p">)</span>
        <span class="n">opd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_to_opd</span><span class="p">(</span><span class="n">binary_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_wavelength</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="n">opd</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">opd_to_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opd</span><span class="p">,</span> <span class="n">wavel</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">opd</span><span class="o">/</span><span class="n">wavel</span>


    <span class="k">def</span> <span class="nf">phase_to_opd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">wavel</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">phase</span><span class="o">*</span><span class="n">wavel</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_opd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_total_opd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_opd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_binary_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">latent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_opd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
        <span class="n">binary_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">CLIMB</span><span class="p">(</span><span class="n">latent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">binary_phase</span>


    <span class="k">def</span> <span class="nf">lsq_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                             <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">A</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">A</span>


    <span class="k">def</span> <span class="nf">lsq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="n">matrix</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsq_params</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span><span class="n">img</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>


    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-15</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsq</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">epsilon</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">epsilon</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">epsilon</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># don&#39;t divide by zero</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># don&#39;t divide by zero</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">])),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">]))</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">dummy</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">-</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span>

        <span class="c1"># Set the regions where there is a defined gradient</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dummy</span><span class="o">&gt;=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">dummy</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">dummy</span><span class="p">)</span>

        <span class="c1"># Colour in regions</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span><span class="n">dummy</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">dummy</span><span class="p">)</span>

        <span class="c1"># rescale between 0 and 1?</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">img</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">dummy</span><span class="p">)</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">img</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">dummy</span><span class="p">)</span>

        <span class="c1"># undecided region</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">img</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dummy</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span><span class="n">dummy</span><span class="p">)</span>

        <span class="c1"># rescale between 0 and 1</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">dummy</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dummy</span>

    <span class="k">def</span> <span class="nf">CLIMB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wf</span><span class="p">,</span> <span class="n">ppsz</span> <span class="o">=</span> <span class="mi">256</span><span class="p">):</span>
        <span class="n">psz</span> <span class="o">=</span> <span class="n">ppsz</span> <span class="o">*</span> <span class="mi">3</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">wf</span><span class="p">,</span> <span class="n">ppsz</span><span class="p">))</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dummy</span><span class="p">),</span> <span class="n">ppsz</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">subarray</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">flat</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">vmap_mask</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">area</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

        <span class="n">soft_bin</span> <span class="o">=</span> <span class="n">vmap_mask</span><span class="p">(</span><span class="n">flat</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ppsz</span><span class="p">,</span> <span class="n">ppsz</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">soft_bin</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Applies a binary OPD to the Wavefront using the &quot;</span>
                <span class="s2">&quot;CLIMB algorithm.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.optics.ApplyBasisCLIMB.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.optics.ApplyBasisCLIMB.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Generates and applies the binary OPD array to the wavefront in a
differentiable manner.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to operate on.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront with the binary OPD applied.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates and applies the binary OPD array to the wavefront in a</span>
<span class="sd">    differentiable manner.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront with the binary OPD applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">latent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_opd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span>
    <span class="n">binary_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">CLIMB</span><span class="p">(</span><span class="n">latent</span><span class="p">,</span> <span class="n">ppsz</span><span class="o">=</span><span class="n">wavefront</span><span class="o">.</span><span class="n">npixels</span><span class="p">)</span>
    <span class="n">opd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_to_opd</span><span class="p">(</span><span class="n">binary_phase</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_wavelength</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="n">opd</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.ApplyBasisCLIMB.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">ideal_wavelength</span><span class="p">,</span> <span class="n">coefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ApplyBasisCLIMB&#39;</span><span class="p">)</span></code>

<a href="#dLux.optics.ApplyBasisCLIMB.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the ApplyBasisCLIMB class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>basis</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>Arrays holding the continous pre-calculated basis vectors. This must
be a 3d array of shape (nterms, npixels, npixels), with the final
two dimensions matching that of the wavefront at time of
application. This is currently required to be a nx768x768 shaped
array.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ideal_wavelength</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The target wavelength at which a perfect anti-phase relationship is
applied via the OPD.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>coefficients</code></td>
          <td>
                <code><span title="dLux.optics.Array">Array</span></code>
          </td>
          <td><p>The Array of coefficients to be applied to each basis vector. This
must be a one dimensional array with leading dimension equal to the
leading dimension of the basis vectors. Default is None which
initialises an array of zeros.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;ApplyBasisCLIMB&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>             <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span>
             <span class="n">basis</span>            <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">ideal_wavelength</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">coefficients</span>     <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">name</span>             <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;ApplyBasisCLIMB&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpticalLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the ApplyBasisCLIMB class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    basis : Array</span>
<span class="sd">        Arrays holding the continous pre-calculated basis vectors. This must</span>
<span class="sd">        be a 3d array of shape (nterms, npixels, npixels), with the final</span>
<span class="sd">        two dimensions matching that of the wavefront at time of</span>
<span class="sd">        application. This is currently required to be a nx768x768 shaped</span>
<span class="sd">        array. </span>
<span class="sd">    ideal_wavelength : Array</span>
<span class="sd">        The target wavelength at which a perfect anti-phase relationship is</span>
<span class="sd">        applied via the OPD.</span>
<span class="sd">    coefficients : Array = None</span>
<span class="sd">        The Array of coefficients to be applied to each basis vector. This</span>
<span class="sd">        must be a one dimensional array with leading dimension equal to the</span>
<span class="sd">        leading dimension of the basis vectors. Default is None which</span>
<span class="sd">        initialises an array of zeros.</span>
<span class="sd">    name : str = &#39;ApplyBasisCLIMB&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">basis</span>            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ideal_wavelength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ideal_wavelength</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> \
                <span class="k">if</span> <span class="n">coefficients</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">))</span>

    <span class="c1"># Inputs checks</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;basis must be a 3 dimensional array, ie (nterms, npixels, npixels).&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">768</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;Basis must have shape (n, 768, 768).&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
    <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> \
    <span class="p">(</span><span class="s2">&quot;coefficients must be a 1 dimensional array with length equal to the &quot;</span>
    <span class="s2">&quot;First dimension of the basis array.&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_wavelength</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;ideal_wavelength must be a &quot;</span>
                                             <span class="s2">&quot;scalar array.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.optics.ApplyBasisCLIMB.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.optics.ApplyBasisCLIMB.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/optics.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Applies a binary OPD to the Wavefront using the &quot;</span>
            <span class="s2">&quot;CLIMB algorithm.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.optics.ApplyBasisCLIMB"><a class="headerlink" href="#dLux.optics.ApplyBasisCLIMB" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.ApplyBasisCLIMB.__call__"><a class="headerlink" href="#dLux.optics.ApplyBasisCLIMB.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.ApplyBasisCLIMB.__init__"><a class="headerlink" href="#dLux.optics.ApplyBasisCLIMB.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.optics.ApplyBasisCLIMB.summary"><a class="headerlink" href="#dLux.optics.ApplyBasisCLIMB.summary" title="Permanent link">¤</a></h2>
</div>
</details>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>