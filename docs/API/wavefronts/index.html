
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for dLux.">
      
      
        <meta name="author" content="Louis Desdoigts">
      
      
        <link rel="canonical" href="https://louisdesdoigts.github.io/dlux/docs/API/wavefronts/">
      
      
        <link rel="prev" href="../propagators/">
      
      
        <link rel="next" href="../detectors/">
      
      <link rel="icon" href="../../../material/telescope">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.6">
    
    
      
        <title>Wavefronts - dLux</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#wavefronts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dLux" class="md-header__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dLux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Wavefronts
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dLux" class="md-nav__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    dLux
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../creating_a_layer/" class="md-nav__link">
        Creating a Layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/phase_retrieval_demo/" class="md-nav__link">
        Phase Retrieval in dLux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/designing_a_mask/" class="md-nav__link">
        Phase Mask Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/flatfield_calibration/" class="md-nav__link">
        Pixel Level Calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/fisher_information/" class="md-nav__link">
        Fisher Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/HMC/" class="md-nav__link">
        Numpyro and Hamiltonian Monte Carlo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          dLux API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          dLux API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../apertures/" class="md-nav__link">
        Apertures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aberrations/" class="md-nav__link">
        Aberrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../propagators/" class="md-nav__link">
        Propagators
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Wavefronts
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detectors/" class="md-nav__link">
        Detectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/" class="md-nav__link">
        Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spectrums/" class="md-nav__link">
        Spectrums
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observations/" class="md-nav__link">
        Observations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Utils API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Utils API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics_util/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../math.md" class="md-nav__link">
        Math
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coordinates/" class="md-nav__link">
        Coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bayes/" class="md-nav__link">
        Bayes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/" class="md-nav__link">
        Helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        Change Log
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="wavefronts">Wavefronts<a class="headerlink" href="#wavefronts" title="Permanent link">Â¤</a></h1>
<p>The wavefront classes primarily track all the relevant parameters of a wavefront and provide a number of methods for manipulating them. The wavefront class will rarely be interacted with directly by users unless they are creating their own custom classes. The bulk of the code is in the <code>Wavefront</code> class, which is the base class for all wavefronts. The concrete wavefront classes <code>AngularWavefront</code>, <code>CartesianWavefront</code> and <code>FarFieldFresnelWavefront</code> are very minimal and mostly just provide functions to track the different parameters units through the propagations.</p>
<details class="info">
<summary>Wavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.wavefronts.Wavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="zodiax.Base">Base</span></code>, <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>A class representing some wavefront, designed to track the various
parameters such as wavelength, pixel_scale, amplitude and phase, as well as
a helper parmeter, plane_type.</p>
<p>All wavefronts currently only support square amplitude and phase arrays.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The wavelength of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The electric field phase of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters/pixel or radians/pixel</code>
          </td>
          <td><p>The physical dimensions of the pixels representing the wavefront. This
can be in units of either meters per pixel or radians per pixel
depending on both the plane type and the wavfront type (Cartesian or
Angular).</p></td>
        </tr>
        <tr>
          <td><code>plane_type</code></td>
          <td>
                <code>enum.<span title="enum.IntEnum">IntEnum</span>.<span title="enum.IntEnum.PlaneType">PlaneType</span></code>
          </td>
          <td><p>The current plane type of wavefront, can be Pupil, Focal or
Intermediate.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/wavefronts.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Wavefront</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing some wavefront, designed to track the various</span>
<span class="sd">    parameters such as wavelength, pixel_scale, amplitude and phase, as well as</span>
<span class="sd">    a helper parmeter, plane_type.</span>

<span class="sd">    All wavefronts currently only support square amplitude and phase arrays.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel or radians/pixel</span>
<span class="sd">        The physical dimensions of the pixels representing the wavefront. This</span>
<span class="sd">        can be in units of either meters per pixel or radians per pixel</span>
<span class="sd">        depending on both the plane type and the wavfront type (Cartesian or</span>
<span class="sd">        Angular).</span>
<span class="sd">    plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">        The current plane type of wavefront, can be Pupil, Focal or</span>
<span class="sd">        Intermediate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span>
    <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span>
    <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span>
    <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span>
    <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength : float, meters</span>
<span class="sd">            The wavelength of the `Wavefront`.</span>
<span class="sd">        pixel_scale : float, meters/pixel</span>
<span class="sd">            The physical dimensions of each square pixel.</span>
<span class="sd">        amplitude : Array, power</span>
<span class="sd">            The electric field amplitude of the `Wavefront`.</span>
<span class="sd">        phase : Array, radians</span>
<span class="sd">            The electric field phase of the `Wavefront`.</span>
<span class="sd">        plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">            The current plane of wavefront, can be Pupil, Focal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span>  <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span>   <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span>       <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plane_type</span>  <span class="o">=</span> <span class="n">plane_type</span>

        <span class="c1"># Input checks</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(),</span> \
        <span class="p">(</span><span class="s2">&quot;wavelength must be a scalar Array.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(),</span> \
        <span class="p">(</span><span class="s2">&quot;pixel_scale must be a scalar Array.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;amplitude must a 3d array (nfields, npix, npix).&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;phase must a 3d array (nfields, npix, npix).&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;The amplitude and phase arrays must have the same shape.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plane_type</span><span class="p">,</span> <span class="n">PlaneType</span><span class="p">),</span> \
        <span class="p">(</span><span class="s2">&quot;plane_type must a PlaneType object.&quot;</span><span class="p">)</span>


    <span class="c1">########################</span>
    <span class="c1">### Getter Functions ###</span>
    <span class="c1">########################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">diameter</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current wavefront diameter calulated using the pixel scale</span>
<span class="sd">        and number of pixels.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        diameter : Array, meters or radians</span>
<span class="sd">            The current diameter of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">npixels</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the side length of the arrays currently representing the</span>
<span class="sd">        wavefront. Taken from the amplitude array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pixels : int</span>
<span class="sd">            The number of pixels that represent the `Wavefront`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nfields</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of polarisation fields currently representing the</span>
<span class="sd">        wavefront. Taken from the amplitude array first dimension.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pixels : int</span>
<span class="sd">            The number of polarisation fields that represent the `Wavefront`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">real</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the real component of the `Wavefront`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Array</span>
<span class="sd">            The real component of the `Wavefront` phasor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">imaginary</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the imaginary component of the `Wavefront`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Array</span>
<span class="sd">            The imaginary component of the `Wavefront` phasor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phasor</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The electric field phasor described by this Wavefront in complex form.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : Array</span>
<span class="sd">            The electric field phasor of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">psf</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the Point Spread Function (PSF), ie the squared modulus</span>
<span class="sd">        of the complex wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psf : Array</span>
<span class="sd">            The PSF of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pixel_coordinates</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the physical positions of the wavefront pixels in meters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pixel_positions : Array</span>
<span class="sd">            The coordinates of the centers of each pixel representing the</span>
<span class="sd">            wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># return get_pixel_coordinates(self.npixels, self.pixel_scale)</span>
        <span class="k">return</span> <span class="n">get_pixel_positions</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">),</span> 
                                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">))</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wavenumber</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the wavenumber of the wavefront (2 * pi / wavelength).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavenumber : Array, 1/meters</span>
<span class="sd">            The wavenumber of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>


    <span class="c1">########################</span>
    <span class="c1">### Setter Functions ###</span>
    <span class="c1">########################</span>
    <span class="k">def</span> <span class="nf">set_amplitude</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">amplitude</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mutator for the amplitude attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ---------</span>
<span class="sd">        amplitude : Array, power</span>
<span class="sd">            The electric field amplitude of the `Wavefront`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with the updated amplitude.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;amplitude must be a 3d array.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">set_phase</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">phase</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mutator for the phase attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phase : Array, radians</span>
<span class="sd">            The phases of each pixel on the `Wavefront`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with the updated phase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">phase</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;phase must be a 3d array.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">set_pixel_scale</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mutator for the pixel_scale attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The new pixel_scale associated with the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new Wavefront object with the updated pixel_scale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pixel_scale</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;pixel_scale must be a scalar array.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">set_plane_type</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">plane</span> <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mutator for the PlaneType attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plane : PlaneType</span>
<span class="sd">            A PlaneType object describing the plane that the `Wavefront` is</span>
<span class="sd">            currently in.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with the update plate_type information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plane</span><span class="p">,</span> <span class="n">PlaneType</span><span class="p">),</span> \
        <span class="p">(</span><span class="s2">&quot;plane must be a PlaneType object.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">plane_type</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">plane</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">set_phasor</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                      <span class="n">amplitude</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                      <span class="n">phase</span>     <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the phasor of the wavefront (ie both the amplitude and the</span>
<span class="sd">        phase).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amplitude : Array, power</span>
<span class="sd">            The new electric field amplitude of the wavefront.</span>
<span class="sd">        phase : Array, radians</span>
<span class="sd">            The new electric field phase of the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with updated amplitude and phase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;amplitude must be a 3d array.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">phase</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;phase must be a 3d array.&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">phase</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;amplitude and phase arrays must have the same shape.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="p">(</span><span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span><span class="p">),</span> <span class="bp">self</span><span class="p">,</span>
                               <span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">))</span>


    <span class="c1">#######################</span>
    <span class="c1">### Other Functions ###</span>
    <span class="c1">#######################</span>
    <span class="k">def</span> <span class="nf">tilt_wavefront</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">tilt_angles</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tilts the wavefront by the tilt_angles.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tilt_angles : Array, radians</span>
<span class="sd">            The (x, y) angles by which to tilt the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with the (x, y) tilts applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tilt_angles</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tilt_angles</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> \
        <span class="p">(</span><span class="s2">&quot;tilt_angles must be an array with shape (2,) ie. (x, y).&quot;</span><span class="p">)</span>

        <span class="n">opds</span> <span class="o">=</span> <span class="n">tilt_angles</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_coordinates</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">opds</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">multiply_amplitude</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">array_like</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Multiply the amplitude of the `Wavefront` by either a float or array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        array_like : Array</span>
<span class="sd">            An array or float that has the same dimensions as amplitude that is</span>
<span class="sd">            multipled by the current ampltide.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with the updated amplitude.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">amplitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array_like</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">array_like</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> \
        <span class="p">(</span><span class="s2">&quot;array_like must be either a scalar array or array with 2 or 3 &quot;</span>
         <span class="s2">&quot;dimensions.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">array_like</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">array_like</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> \
            <span class="p">(</span><span class="s2">&quot;array_like shape must be equal to the current ampltude array.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_amplitude</span><span class="p">(</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">array_like</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add_phase</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">array_like</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add to the phase of the `Wavefront` by either a float or array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        array_like : Array</span>
<span class="sd">            An array or float that has the same dimensions as phase that is</span>
<span class="sd">            added to the current phase.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with the updated phase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array_like</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">array_like</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> \
        <span class="p">(</span><span class="s2">&quot;array_like must be either a scalar array or array with 2 or 3 &quot;</span>
         <span class="s2">&quot;dimensions.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">array_like</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">array_like</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="n">phase</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> \
            <span class="p">(</span><span class="s2">&quot;array_like shape must be equal to the current phase array.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phase</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="n">array_like</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add_opd</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">path_difference</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the wavelength-dependent phase based on the supplied optical</span>
<span class="sd">        path difference.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path_difference : Array, meters</span>
<span class="sd">            The physical optical path difference of either the entire wavefront</span>
<span class="sd">            or each pixel individually.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront with the phases updated according to the supplied</span>
<span class="sd">            path_difference</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path_difference</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> \
        <span class="n">path_difference</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;path_difference must be either a &quot;</span>
        <span class="s2">&quot;scalar array or array with 2 or 3 dimensions.&quot;</span><span class="p">)</span>
        <span class="n">phase_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">path_difference</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="n">phase_difference</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalises the total power of the wavefront to 1.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront with the normalised electric field amplitudes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply_amplitude</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">wavefront_to_psf</span><span class="p">(</span><span class="bp">self</span>             <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                         <span class="n">return_polarised</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the Point Spread Function (PSF), ie the squared modulus</span>
<span class="sd">        of the complex wavefront.</span>

<span class="sd">        TODO: Take in the parameters dictionary and use the parameters in that</span>
<span class="sd">        to determine the way to output the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psf : Array</span>
<span class="sd">            The PSF of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">invert_x_and_y</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reflects the wavefront about both axes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with the phase and amplitude arrays reversed</span>
<span class="sd">            along both axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">new_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">invert_x</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reflects the wavefront about the x axis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` with the phase and amplitude arrays reversed</span>
<span class="sd">            along the x axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">new_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">invert_y</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reflects the wavefront about the y axis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront with the phase and amplitude arrays reversed</span>
<span class="sd">            along the y axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">new_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                    <span class="n">npixels_out</span>     <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="n">pixel_scale_out</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">real_imaginary</span>  <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs a paraxial interpolation on the wavefront, determined by the</span>
<span class="sd">        the pixel_scale_out and npixels_out parameters. By default the</span>
<span class="sd">        interpolation is done on the amplitude and phase arrays, however by</span>
<span class="sd">        passing `real_imgainary=True` the interpolation is done on the real and</span>
<span class="sd">        imaginary components. This option allows for consistent interpolation</span>
<span class="sd">        behaviour when the phase array has a large amount of wrapping.</span>
<span class="sd">        Automatically conserves energy though the interpolation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels_out : int</span>
<span class="sd">            The number of pixels representing the wavefront after the</span>
<span class="sd">            interpolation.</span>
<span class="sd">        pixel_scale_out : Array</span>
<span class="sd">            The pixel scale of the array after the interpolation.</span>
<span class="sd">        real_imaginary : bool = False</span>
<span class="sd">            Whether to interpolate the real and imaginary representation of the</span>
<span class="sd">            wavefront as opposed to the the amplitude and phase representation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront interpolated to the size and shape determined by</span>
<span class="sd">            npixels_out and pixel_scale_out, with the updated pixel_scale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sampling_ratio</span> <span class="o">=</span> <span class="n">pixel_scale_out</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span>
        <span class="k">if</span> <span class="n">real_imaginary</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imaginary</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span> <span class="o">=</span> \
            <span class="n">interpolate_field</span><span class="p">(</span><span class="n">field</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">npixels_out</span><span class="p">,</span> <span class="n">sampling_ratio</span><span class="p">,</span>
                              <span class="n">real_imaginary</span><span class="o">=</span><span class="n">real_imaginary</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">interpolator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">interpolate_field</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">npixels_out</span><span class="p">,</span>
                                <span class="n">sampling_ratio</span><span class="p">,</span> <span class="n">real_imaginary</span><span class="o">=</span><span class="n">real_imaginary</span><span class="p">)</span>

        <span class="c1"># Update parameters</span>
        <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span><span class="k">lambda</span> <span class="n">wavefront</span><span class="p">:</span>
                 <span class="p">(</span><span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">),</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">,</span> <span class="n">pixel_scale_out</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span>           <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
               <span class="n">angle</span>          <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
               <span class="n">real_imaginary</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="n">fourier</span>        <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="n">order</span>          <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
               <span class="n">padding</span>        <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs a paraxial rotation on the wavefront, determined by the</span>
<span class="sd">        the angle parameter. By default the rotation is performed using a</span>
<span class="sd">        simple linear interpolation, but an information perserving rotation</span>
<span class="sd">        using fourier methods can be done by setting `fourier = True`. By</span>
<span class="sd">        default rotation is done on the amplitude and phase arrays, however by</span>
<span class="sd">        passing `real_imgainary=True` the rotation is done on the real and</span>
<span class="sd">        imaginary components.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : Array, radians</span>
<span class="sd">            The angle by which to rotate the wavefront in a clockwise direction.</span>
<span class="sd">        real_imaginary : bool = False</span>
<span class="sd">            Whether to rotate the real and imaginary representation of the</span>
<span class="sd">            wavefront as opposed to the the amplitude and phase representation.</span>
<span class="sd">        fourier : bool = False</span>
<span class="sd">            Should the fourier rotation method be used (True), or regular</span>
<span class="sd">            interpolation method be used (False).</span>
<span class="sd">        order : int = 2</span>
<span class="sd">            The interpolation order to use. Must be 0, 1, or 3.</span>
<span class="sd">        padding : int = 2</span>
<span class="sd">            The amount of fourier padding to use. Only applies if fourier is</span>
<span class="sd">            True.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront rotated by angle in the clockwise direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get Field</span>
        <span class="k">if</span> <span class="n">real_imaginary</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imaginary</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">])</span>

        <span class="c1"># Rotate</span>
        <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span> <span class="o">=</span> \
            <span class="n">rotate_field</span><span class="p">(</span><span class="n">field</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">fourier</span><span class="o">=</span><span class="n">fourier</span><span class="p">,</span>
                    <span class="n">real_imaginary</span><span class="o">=</span><span class="n">real_imaginary</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">rotate_field</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span> <span class="o">=</span> <span class="n">rotator</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">fourier</span><span class="o">=</span><span class="n">fourier</span><span class="p">,</span>
                                    <span class="n">real_imaginary</span><span class="o">=</span><span class="n">real_imaginary</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>

        <span class="c1"># Update parameters</span>
        <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span><span class="k">lambda</span> <span class="n">wavefront</span><span class="p">:</span> <span class="p">(</span><span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span><span class="p">),</span>
                                   <span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">pad_to</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">npixels_out</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Paraxially zero-pads the `Wavefront` to the size determined by</span>
<span class="sd">        npixels_out. Note this only supports padding arrays of even dimension</span>
<span class="sd">        to even dimension, and odd dimension to to odd dimension, ie 2 -&gt; 4 or</span>
<span class="sd">        3 -&gt; 5.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels_out : int</span>
<span class="sd">            The size of the array to pad to the wavefront to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` zero-padded to the size npixels_out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npixels_in</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>
        <span class="k">assert</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">npixels_out</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;Only supports even -&gt; even or odd -&gt; odd padding&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">npixels_out</span> <span class="o">&gt;</span> <span class="n">npixels_in</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;npixels_out must be larger than the&quot;</span>
        <span class="s2">&quot; current array size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">))</span>

        <span class="n">new_centre</span> <span class="o">=</span> <span class="n">npixels_out</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">centre</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">//</span> <span class="mi">2</span>
        <span class="n">remainder</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span>
        <span class="n">padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nfields</span><span class="p">,</span> <span class="n">npixels_out</span><span class="p">,</span> <span class="n">npixels_out</span><span class="p">])</span>

        <span class="n">new_amplitude</span> <span class="o">=</span> <span class="n">padded</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span>
                <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">,</span>
                <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span>
            <span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">)</span>
        <span class="n">new_phase</span> <span class="o">=</span> <span class="n">padded</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span>
                <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">,</span>
                <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span>
            <span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">crop_to</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">npixels_out</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Paraxially crops the `Wavefront` to the size determined by npixels_out.</span>
<span class="sd">        Note this only supports padding arrays of even dimension to even</span>
<span class="sd">        dimension, and odd dimension to to odd dimension, ie 4 -&gt; 2 or 5 -&gt; 3.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels_out : int</span>
<span class="sd">            The size of the array to crop to the wavefront to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` cropped to the size npixels_out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npixels_in</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>

        <span class="k">assert</span> <span class="n">npixels_in</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="n">npixels_out</span><span class="o">%</span><span class="mi">2</span><span class="p">,</span> \
        <span class="p">(</span><span class="s2">&quot;Only supports even -&gt; even or odd -&gt; odd cropping&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">npixels_out</span> <span class="o">&lt;</span> <span class="n">npixels_in</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;npixels_out must be smaller than the&quot;</span>
        <span class="s2">&quot; current array size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">))</span>

        <span class="n">new_centre</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">//</span> <span class="mi">2</span>
        <span class="n">centre</span> <span class="o">=</span> <span class="n">npixels_out</span> <span class="o">//</span> <span class="mi">2</span>

        <span class="n">new_amplitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">[:,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">]</span>
        <span class="n">new_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">[:,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.diameter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">diameter</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.diameter" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the current wavefront diameter calulated using the pixel scale
and number of pixels.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>diameter</code></td>          <td>
                <code>Array, meters or radians</code>
          </td>
          <td><p>The current diameter of the wavefront.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.imaginary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">imaginary</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.imaginary" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the imaginary component of the <code>Wavefront</code>.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>The imaginary component of the <code>Wavefront</code> phasor.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.nfields" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nfields</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.nfields" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the number of polarisation fields currently representing the
wavefront. Taken from the amplitude array first dimension.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pixels</code></td>          <td>
                <code>int</code>
          </td>
          <td><p>The number of polarisation fields that represent the <code>Wavefront</code>.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.npixels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.npixels" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the side length of the arrays currently representing the
wavefront. Taken from the amplitude array.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pixels</code></td>          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels that represent the <code>Wavefront</code>.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.phasor" class="doc doc-heading">
<code class="highlight language-python"><span class="n">phasor</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.phasor" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>The electric field phasor described by this Wavefront in complex form.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>field</code></td>          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>The electric field phasor of the wavefront.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.pixel_coordinates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pixel_coordinates</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.pixel_coordinates" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the physical positions of the wavefront pixels in meters.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pixel_positions</code></td>          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>The coordinates of the centers of each pixel representing the
wavefront.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.psf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">psf</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.psf" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the Point Spread Function (PSF), ie the squared modulus
of the complex wavefront.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>psf</code></td>          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>The PSF of the wavefront.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.real" class="doc doc-heading">
<code class="highlight language-python"><span class="n">real</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.real" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the real component of the <code>Wavefront</code>.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>The real component of the <code>Wavefront</code> phasor.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.wavenumber" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wavenumber</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.wavenumber" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the wavenumber of the wavefront (2 * pi / wavelength).</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavenumber</code></td>          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, 1</code>
          </td>
          <td><p>The wavenumber of the wavefront.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.__init__" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The wavelength of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The physical dimensions of each square pixel.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The electric field phase of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>plane_type</code></td>
          <td>
                <code>enum.<span title="enum.IntEnum">IntEnum</span>.<span title="enum.IntEnum.PlaneType">PlaneType</span></code>
          </td>
          <td><p>The current plane of wavefront, can be Pupil, Focal.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel</span>
<span class="sd">        The physical dimensions of each square pixel.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">        The current plane of wavefront, can be Pupil, Focal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span>  <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span>   <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">phase</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span>       <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane_type</span>  <span class="o">=</span> <span class="n">plane_type</span>

    <span class="c1"># Input checks</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(),</span> \
    <span class="p">(</span><span class="s2">&quot;wavelength must be a scalar Array.&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(),</span> \
    <span class="p">(</span><span class="s2">&quot;pixel_scale must be a scalar Array.&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;amplitude must a 3d array (nfields, npix, npix).&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;phase must a 3d array (nfields, npix, npix).&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;The amplitude and phase arrays must have the same shape.&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plane_type</span><span class="p">,</span> <span class="n">PlaneType</span><span class="p">),</span> \
    <span class="p">(</span><span class="s2">&quot;plane_type must a PlaneType object.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.add_opd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_opd</span><span class="p">(</span><span class="n">path_difference</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.add_opd" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the wavelength-dependent phase based on the supplied optical
path difference.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path_difference</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, meters</code>
          </td>
          <td><p>The physical optical path difference of either the entire wavefront
or each pixel individually.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new wavefront with the phases updated according to the supplied
path_difference</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_opd</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">path_difference</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the wavelength-dependent phase based on the supplied optical</span>
<span class="sd">    path difference.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path_difference : Array, meters</span>
<span class="sd">        The physical optical path difference of either the entire wavefront</span>
<span class="sd">        or each pixel individually.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront with the phases updated according to the supplied</span>
<span class="sd">        path_difference</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path_difference</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> \
    <span class="n">path_difference</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;path_difference must be either a &quot;</span>
    <span class="s2">&quot;scalar array or array with 2 or 3 dimensions.&quot;</span><span class="p">)</span>
    <span class="n">phase_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">path_difference</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="n">phase_difference</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.add_phase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_phase</span><span class="p">(</span><span class="n">array_like</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.add_phase" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Add to the phase of the <code>Wavefront</code> by either a float or array.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>array_like</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>An array or float that has the same dimensions as phase that is
added to the current phase.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with the updated phase.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_phase</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">array_like</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add to the phase of the `Wavefront` by either a float or array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    array_like : Array</span>
<span class="sd">        An array or float that has the same dimensions as phase that is</span>
<span class="sd">        added to the current phase.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with the updated phase.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array_like</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">array_like</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> \
    <span class="p">(</span><span class="s2">&quot;array_like must be either a scalar array or array with 2 or 3 &quot;</span>
     <span class="s2">&quot;dimensions.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">array_like</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">array_like</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="n">phase</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> \
        <span class="p">(</span><span class="s2">&quot;array_like shape must be equal to the current phase array.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phase</span><span class="p">(</span><span class="n">phase</span> <span class="o">+</span> <span class="n">array_like</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.crop_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">crop_to</span><span class="p">(</span><span class="n">npixels_out</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.crop_to" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Paraxially crops the <code>Wavefront</code> to the size determined by npixels_out.
Note this only supports padding arrays of even dimension to even
dimension, and odd dimension to to odd dimension, ie 4 -&gt; 2 or 5 -&gt; 3.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The size of the array to crop to the wavefront to.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> cropped to the size npixels_out.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">crop_to</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">npixels_out</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Paraxially crops the `Wavefront` to the size determined by npixels_out.</span>
<span class="sd">    Note this only supports padding arrays of even dimension to even</span>
<span class="sd">    dimension, and odd dimension to to odd dimension, ie 4 -&gt; 2 or 5 -&gt; 3.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The size of the array to crop to the wavefront to.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` cropped to the size npixels_out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npixels_in</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>

    <span class="k">assert</span> <span class="n">npixels_in</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="n">npixels_out</span><span class="o">%</span><span class="mi">2</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;Only supports even -&gt; even or odd -&gt; odd cropping&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">npixels_out</span> <span class="o">&lt;</span> <span class="n">npixels_in</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;npixels_out must be smaller than the&quot;</span>
    <span class="s2">&quot; current array size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">))</span>

    <span class="n">new_centre</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">//</span> <span class="mi">2</span>
    <span class="n">centre</span> <span class="o">=</span> <span class="n">npixels_out</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="n">new_amplitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">[:,</span>
        <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">,</span>
        <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">]</span>
    <span class="n">new_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">[:,</span>
        <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">,</span>
        <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.interpolate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">interpolate</span><span class="p">(</span><span class="n">npixels_out</span><span class="p">,</span> <span class="n">pixel_scale_out</span><span class="p">,</span> <span class="n">real_imaginary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.interpolate" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Performs a paraxial interpolation on the wavefront, determined by the
the pixel_scale_out and npixels_out parameters. By default the
interpolation is done on the amplitude and phase arrays, however by
passing <code>real_imgainary=True</code> the interpolation is done on the real and
imaginary components. This option allows for consistent interpolation
behaviour when the phase array has a large amount of wrapping.
Automatically conserves energy though the interpolation.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels representing the wavefront after the
interpolation.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale_out</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>The pixel scale of the array after the interpolation.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>real_imaginary</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to interpolate the real and imaginary representation of the
wavefront as opposed to the the amplitude and phase representation.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new wavefront interpolated to the size and shape determined by
npixels_out and pixel_scale_out, with the updated pixel_scale.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                <span class="n">npixels_out</span>     <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                <span class="n">pixel_scale_out</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                <span class="n">real_imaginary</span>  <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a paraxial interpolation on the wavefront, determined by the</span>
<span class="sd">    the pixel_scale_out and npixels_out parameters. By default the</span>
<span class="sd">    interpolation is done on the amplitude and phase arrays, however by</span>
<span class="sd">    passing `real_imgainary=True` the interpolation is done on the real and</span>
<span class="sd">    imaginary components. This option allows for consistent interpolation</span>
<span class="sd">    behaviour when the phase array has a large amount of wrapping.</span>
<span class="sd">    Automatically conserves energy though the interpolation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The number of pixels representing the wavefront after the</span>
<span class="sd">        interpolation.</span>
<span class="sd">    pixel_scale_out : Array</span>
<span class="sd">        The pixel scale of the array after the interpolation.</span>
<span class="sd">    real_imaginary : bool = False</span>
<span class="sd">        Whether to interpolate the real and imaginary representation of the</span>
<span class="sd">        wavefront as opposed to the the amplitude and phase representation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront interpolated to the size and shape determined by</span>
<span class="sd">        npixels_out and pixel_scale_out, with the updated pixel_scale.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sampling_ratio</span> <span class="o">=</span> <span class="n">pixel_scale_out</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span>
    <span class="k">if</span> <span class="n">real_imaginary</span><span class="p">:</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imaginary</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span> <span class="o">=</span> \
        <span class="n">interpolate_field</span><span class="p">(</span><span class="n">field</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">npixels_out</span><span class="p">,</span> <span class="n">sampling_ratio</span><span class="p">,</span>
                          <span class="n">real_imaginary</span><span class="o">=</span><span class="n">real_imaginary</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interpolator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">interpolate_field</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">npixels_out</span><span class="p">,</span>
                            <span class="n">sampling_ratio</span><span class="p">,</span> <span class="n">real_imaginary</span><span class="o">=</span><span class="n">real_imaginary</span><span class="p">)</span>

    <span class="c1"># Update parameters</span>
    <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span><span class="k">lambda</span> <span class="n">wavefront</span><span class="p">:</span>
             <span class="p">(</span><span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">),</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">,</span> <span class="n">pixel_scale_out</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.invert_x" class="doc doc-heading">
<code class="highlight language-python"><span class="n">invert_x</span><span class="p">()</span></code>

<a href="#dLux.wavefronts.Wavefront.invert_x" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Reflects the wavefront about the x axis.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with the phase and amplitude arrays reversed
along the x axis.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">invert_x</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reflects the wavefront about the x axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with the phase and amplitude arrays reversed</span>
<span class="sd">        along the x axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">new_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.invert_x_and_y" class="doc doc-heading">
<code class="highlight language-python"><span class="n">invert_x_and_y</span><span class="p">()</span></code>

<a href="#dLux.wavefronts.Wavefront.invert_x_and_y" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Reflects the wavefront about both axes.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with the phase and amplitude arrays reversed
along both axes.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">invert_x_and_y</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reflects the wavefront about both axes.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with the phase and amplitude arrays reversed</span>
<span class="sd">        along both axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">new_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.invert_y" class="doc doc-heading">
<code class="highlight language-python"><span class="n">invert_y</span><span class="p">()</span></code>

<a href="#dLux.wavefronts.Wavefront.invert_y" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Reflects the wavefront about the y axis.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new wavefront with the phase and amplitude arrays reversed
along the y axis.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">invert_y</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reflects the wavefront about the y axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront with the phase and amplitude arrays reversed</span>
<span class="sd">        along the y axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">new_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.multiply_amplitude" class="doc doc-heading">
<code class="highlight language-python"><span class="n">multiply_amplitude</span><span class="p">(</span><span class="n">array_like</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.multiply_amplitude" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Multiply the amplitude of the <code>Wavefront</code> by either a float or array.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>array_like</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>An array or float that has the same dimensions as amplitude that is
multipled by the current ampltide.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with the updated amplitude.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">multiply_amplitude</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">array_like</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Multiply the amplitude of the `Wavefront` by either a float or array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    array_like : Array</span>
<span class="sd">        An array or float that has the same dimensions as amplitude that is</span>
<span class="sd">        multipled by the current ampltide.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with the updated amplitude.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">amplitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array_like</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">array_like</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> \
    <span class="p">(</span><span class="s2">&quot;array_like must be either a scalar array or array with 2 or 3 &quot;</span>
     <span class="s2">&quot;dimensions.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">array_like</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">array_like</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> \
        <span class="p">(</span><span class="s2">&quot;array_like shape must be equal to the current ampltude array.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_amplitude</span><span class="p">(</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">array_like</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.normalise" class="doc doc-heading">
<code class="highlight language-python"><span class="n">normalise</span><span class="p">()</span></code>

<a href="#dLux.wavefronts.Wavefront.normalise" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Normalises the total power of the wavefront to 1.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new wavefront with the normalised electric field amplitudes.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalises the total power of the wavefront to 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront with the normalised electric field amplitudes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply_amplitude</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.pad_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pad_to</span><span class="p">(</span><span class="n">npixels_out</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.pad_to" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Paraxially zero-pads the <code>Wavefront</code> to the size determined by
npixels_out. Note this only supports padding arrays of even dimension
to even dimension, and odd dimension to to odd dimension, ie 2 -&gt; 4 or
3 -&gt; 5.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The size of the array to pad to the wavefront to.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> zero-padded to the size npixels_out.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pad_to</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">npixels_out</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Paraxially zero-pads the `Wavefront` to the size determined by</span>
<span class="sd">    npixels_out. Note this only supports padding arrays of even dimension</span>
<span class="sd">    to even dimension, and odd dimension to to odd dimension, ie 2 -&gt; 4 or</span>
<span class="sd">    3 -&gt; 5.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The size of the array to pad to the wavefront to.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` zero-padded to the size npixels_out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npixels_in</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>
    <span class="k">assert</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">npixels_out</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;Only supports even -&gt; even or odd -&gt; odd padding&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">npixels_out</span> <span class="o">&gt;</span> <span class="n">npixels_in</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;npixels_out must be larger than the&quot;</span>
    <span class="s2">&quot; current array size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">))</span>

    <span class="n">new_centre</span> <span class="o">=</span> <span class="n">npixels_out</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">centre</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">//</span> <span class="mi">2</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nfields</span><span class="p">,</span> <span class="n">npixels_out</span><span class="p">,</span> <span class="n">npixels_out</span><span class="p">])</span>

    <span class="n">new_amplitude</span> <span class="o">=</span> <span class="n">padded</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span>
        <span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">)</span>
    <span class="n">new_phase</span> <span class="o">=</span> <span class="n">padded</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span>
        <span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.rotate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rotate</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">real_imaginary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fourier</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.rotate" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Performs a paraxial rotation on the wavefront, determined by the
the angle parameter. By default the rotation is performed using a
simple linear interpolation, but an information perserving rotation
using fourier methods can be done by setting <code>fourier = True</code>. By
default rotation is done on the amplitude and phase arrays, however by
passing <code>real_imgainary=True</code> the rotation is done on the real and
imaginary components.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angle</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The angle by which to rotate the wavefront in a clockwise direction.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>real_imaginary</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to rotate the real and imaginary representation of the
wavefront as opposed to the the amplitude and phase representation.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>fourier</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the fourier rotation method be used (True), or regular
interpolation method be used (False).</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>order</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The interpolation order to use. Must be 0, 1, or 3.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The amount of fourier padding to use. Only applies if fourier is
True.</p></td>
          <td>
                <code>2</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new wavefront rotated by angle in the clockwise direction.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span>           <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
           <span class="n">angle</span>          <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
           <span class="n">real_imaginary</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
           <span class="n">fourier</span>        <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
           <span class="n">order</span>          <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
           <span class="n">padding</span>        <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a paraxial rotation on the wavefront, determined by the</span>
<span class="sd">    the angle parameter. By default the rotation is performed using a</span>
<span class="sd">    simple linear interpolation, but an information perserving rotation</span>
<span class="sd">    using fourier methods can be done by setting `fourier = True`. By</span>
<span class="sd">    default rotation is done on the amplitude and phase arrays, however by</span>
<span class="sd">    passing `real_imgainary=True` the rotation is done on the real and</span>
<span class="sd">    imaginary components.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angle : Array, radians</span>
<span class="sd">        The angle by which to rotate the wavefront in a clockwise direction.</span>
<span class="sd">    real_imaginary : bool = False</span>
<span class="sd">        Whether to rotate the real and imaginary representation of the</span>
<span class="sd">        wavefront as opposed to the the amplitude and phase representation.</span>
<span class="sd">    fourier : bool = False</span>
<span class="sd">        Should the fourier rotation method be used (True), or regular</span>
<span class="sd">        interpolation method be used (False).</span>
<span class="sd">    order : int = 2</span>
<span class="sd">        The interpolation order to use. Must be 0, 1, or 3.</span>
<span class="sd">    padding : int = 2</span>
<span class="sd">        The amount of fourier padding to use. Only applies if fourier is</span>
<span class="sd">        True.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront rotated by angle in the clockwise direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get Field</span>
    <span class="k">if</span> <span class="n">real_imaginary</span><span class="p">:</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imaginary</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">])</span>

    <span class="c1"># Rotate</span>
    <span class="k">if</span> <span class="n">field</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span> <span class="o">=</span> \
        <span class="n">rotate_field</span><span class="p">(</span><span class="n">field</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="p">,</span> <span class="n">fourier</span><span class="o">=</span><span class="n">fourier</span><span class="p">,</span>
                <span class="n">real_imaginary</span><span class="o">=</span><span class="n">real_imaginary</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rotator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">rotate_field</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span> <span class="o">=</span> <span class="n">rotator</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">fourier</span><span class="o">=</span><span class="n">fourier</span><span class="p">,</span>
                                <span class="n">real_imaginary</span><span class="o">=</span><span class="n">real_imaginary</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>

    <span class="c1"># Update parameters</span>
    <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span><span class="k">lambda</span> <span class="n">wavefront</span><span class="p">:</span> <span class="p">(</span><span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span><span class="p">),</span>
                               <span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">new_amplitude</span><span class="p">,</span> <span class="n">new_phase</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.set_amplitude" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_amplitude</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.set_amplitude" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Mutator for the amplitude attribute.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with the updated amplitude.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_amplitude</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">amplitude</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mutator for the amplitude attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ---------</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with the updated amplitude.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;amplitude must be a 3d array.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.set_phase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_phase</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.set_phase" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Mutator for the phase attribute.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The phases of each pixel on the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with the updated phase.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_phase</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">phase</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mutator for the phase attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The phases of each pixel on the `Wavefront`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with the updated phase.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">phase</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;phase must be a 3d array.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.set_phasor" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_phasor</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.set_phasor" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Updates the phasor of the wavefront (ie both the amplitude and the
phase).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The new electric field amplitude of the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The new electric field phase of the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with updated amplitude and phase.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_phasor</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                  <span class="n">amplitude</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                  <span class="n">phase</span>     <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the phasor of the wavefront (ie both the amplitude and the</span>
<span class="sd">    phase).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The new electric field amplitude of the wavefront.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The new electric field phase of the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with updated amplitude and phase.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;amplitude must be a 3d array.&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">phase</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;phase must be a 3d array.&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">phase</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;amplitude and phase arrays must have the same shape.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="p">(</span><span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span><span class="p">),</span> <span class="bp">self</span><span class="p">,</span>
                           <span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.set_pixel_scale" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_pixel_scale</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.set_pixel_scale" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Mutator for the pixel_scale attribute.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>The new pixel_scale associated with the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new Wavefront object with the updated pixel_scale.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_pixel_scale</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mutator for the pixel_scale attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pixel_scale : Array</span>
<span class="sd">        The new pixel_scale associated with the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new Wavefront object with the updated pixel_scale.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pixel_scale</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> \
    <span class="p">(</span><span class="s2">&quot;pixel_scale must be a scalar array.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.set_plane_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_plane_type</span><span class="p">(</span><span class="n">plane</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.set_plane_type" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Mutator for the PlaneType attribute.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>plane</code></td>
          <td>
                <code><span title="dLux.wavefronts.PlaneType">PlaneType</span></code>
          </td>
          <td><p>A PlaneType object describing the plane that the <code>Wavefront</code> is
currently in.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with the update plate_type information.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_plane_type</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">plane</span> <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mutator for the PlaneType attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plane : PlaneType</span>
<span class="sd">        A PlaneType object describing the plane that the `Wavefront` is</span>
<span class="sd">        currently in.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with the update plate_type information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plane</span><span class="p">,</span> <span class="n">PlaneType</span><span class="p">),</span> \
    <span class="p">(</span><span class="s2">&quot;plane must be a PlaneType object.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree_at</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">plane_type</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">plane</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.tilt_wavefront" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tilt_wavefront</span><span class="p">(</span><span class="n">tilt_angles</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.tilt_wavefront" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Tilts the wavefront by the tilt_angles.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tilt_angles</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The (x, y) angles by which to tilt the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td><p>The new <code>Wavefront</code> with the (x, y) tilts applied.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tilt_wavefront</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">tilt_angles</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tilts the wavefront by the tilt_angles.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tilt_angles : Array, radians</span>
<span class="sd">        The (x, y) angles by which to tilt the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` with the (x, y) tilts applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tilt_angles</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tilt_angles</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> \
    <span class="p">(</span><span class="s2">&quot;tilt_angles must be an array with shape (2,) ie. (x, y).&quot;</span><span class="p">)</span>

    <span class="n">opds</span> <span class="o">=</span> <span class="n">tilt_angles</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_coordinates</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">opds</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.wavefront_to_psf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wavefront_to_psf</span><span class="p">(</span><span class="n">return_polarised</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.wavefront_to_psf" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the Point Spread Function (PSF), ie the squared modulus
of the complex wavefront.</p>
<p>TODO: Take in the parameters dictionary and use the parameters in that
to determine the way to output the wavefront.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>psf</code></td>          <td>
                <code><span title="dLux.wavefronts.Array">Array</span></code>
          </td>
          <td><p>The PSF of the wavefront.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">wavefront_to_psf</span><span class="p">(</span><span class="bp">self</span>             <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                     <span class="n">return_polarised</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Point Spread Function (PSF), ie the squared modulus</span>
<span class="sd">    of the complex wavefront.</span>

<span class="sd">    TODO: Take in the parameters dictionary and use the parameters in that</span>
<span class="sd">    to determine the way to output the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psf : Array</span>
<span class="sd">        The PSF of the wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.wavefronts.Wavefront"><a class="headerlink" href="#dLux.wavefronts.Wavefront" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.diameter"><a class="headerlink" href="#dLux.wavefronts.Wavefront.diameter" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.imaginary"><a class="headerlink" href="#dLux.wavefronts.Wavefront.imaginary" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.nfields"><a class="headerlink" href="#dLux.wavefronts.Wavefront.nfields" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.npixels"><a class="headerlink" href="#dLux.wavefronts.Wavefront.npixels" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.phasor"><a class="headerlink" href="#dLux.wavefronts.Wavefront.phasor" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.pixel_coordinates"><a class="headerlink" href="#dLux.wavefronts.Wavefront.pixel_coordinates" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.psf"><a class="headerlink" href="#dLux.wavefronts.Wavefront.psf" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.real"><a class="headerlink" href="#dLux.wavefronts.Wavefront.real" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.wavenumber"><a class="headerlink" href="#dLux.wavefronts.Wavefront.wavenumber" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.__init__"><a class="headerlink" href="#dLux.wavefronts.Wavefront.__init__" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.add_opd"><a class="headerlink" href="#dLux.wavefronts.Wavefront.add_opd" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.add_phase"><a class="headerlink" href="#dLux.wavefronts.Wavefront.add_phase" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.crop_to"><a class="headerlink" href="#dLux.wavefronts.Wavefront.crop_to" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.interpolate"><a class="headerlink" href="#dLux.wavefronts.Wavefront.interpolate" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.invert_x"><a class="headerlink" href="#dLux.wavefronts.Wavefront.invert_x" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.invert_x_and_y"><a class="headerlink" href="#dLux.wavefronts.Wavefront.invert_x_and_y" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.invert_y"><a class="headerlink" href="#dLux.wavefronts.Wavefront.invert_y" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.multiply_amplitude"><a class="headerlink" href="#dLux.wavefronts.Wavefront.multiply_amplitude" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.normalise"><a class="headerlink" href="#dLux.wavefronts.Wavefront.normalise" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.pad_to"><a class="headerlink" href="#dLux.wavefronts.Wavefront.pad_to" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.rotate"><a class="headerlink" href="#dLux.wavefronts.Wavefront.rotate" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.set_amplitude"><a class="headerlink" href="#dLux.wavefronts.Wavefront.set_amplitude" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.set_phase"><a class="headerlink" href="#dLux.wavefronts.Wavefront.set_phase" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.set_phasor"><a class="headerlink" href="#dLux.wavefronts.Wavefront.set_phasor" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.set_pixel_scale"><a class="headerlink" href="#dLux.wavefronts.Wavefront.set_pixel_scale" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.set_plane_type"><a class="headerlink" href="#dLux.wavefronts.Wavefront.set_plane_type" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.tilt_wavefront"><a class="headerlink" href="#dLux.wavefronts.Wavefront.tilt_wavefront" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.wavefront_to_psf"><a class="headerlink" href="#dLux.wavefronts.Wavefront.wavefront_to_psf" title="Permanent link">Â¤</a></h2>
</div>
</details>
<details class="info">
<summary>Angular Wavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.wavefronts.AngularWavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code></p>

  
      <p>A class representing some wavefront, designed to track the various
parameters such as wavelength, pixel_scale, amplitude and phase, as well as
a helper parmeter, plane_type. AngularWavefronts have pixel scales in
units of meters per pixel in Pupil planes and radians per pixel in Focal
planes.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The wavelength of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The electric field phase of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters/pixel or radians/pixel</code>
          </td>
          <td><p>The physical dimensions of the pixels representing the wavefront. This
is in units of meters per pixel in pupil planes and radians per pixel
in focal planes.</p></td>
        </tr>
        <tr>
          <td><code>plane_type</code></td>
          <td>
                <code>enum.<span title="enum.IntEnum">IntEnum</span>.<span title="enum.IntEnum.PlaneType">PlaneType</span></code>
          </td>
          <td><p>The current plane type of wavefront, can be Pupil, Focal or
Intermediate.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/wavefronts.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AngularWavefront</span><span class="p">(</span><span class="n">Wavefront</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing some wavefront, designed to track the various</span>
<span class="sd">    parameters such as wavelength, pixel_scale, amplitude and phase, as well as</span>
<span class="sd">    a helper parmeter, plane_type. AngularWavefronts have pixel scales in</span>
<span class="sd">    units of meters per pixel in Pupil planes and radians per pixel in Focal</span>
<span class="sd">    planes.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel or radians/pixel</span>
<span class="sd">        The physical dimensions of the pixels representing the wavefront. This</span>
<span class="sd">        is in units of meters per pixel in pupil planes and radians per pixel</span>
<span class="sd">        in focal planes.</span>
<span class="sd">    plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">        The current plane type of wavefront, can be Pupil, Focal or</span>
<span class="sd">        Intermediate.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for Angular wavefronts.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength : float, meters</span>
<span class="sd">            The wavelength of the `Wavefront`.</span>
<span class="sd">        pixel_scale : float, meters/pixel or radians/pixel</span>
<span class="sd">            The physical dimensions of each pixel. Units are in meters</span>
<span class="sd">            per pixel in Pupil planes and radians per pixel in Focal planes.</span>
<span class="sd">        amplitude : Array, power</span>
<span class="sd">            The electric field amplitude of the `Wavefront`.</span>
<span class="sd">        phase : Array, radians</span>
<span class="sd">            The electric field phase of the `Wavefront`.</span>
<span class="sd">        plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">            The current plane of wavefront, can be Pupil, Focal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span>
                         <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.AngularWavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.AngularWavefront.__init__" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for Angular wavefronts.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The wavelength of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The physical dimensions of each pixel. Units are in meters
per pixel in Pupil planes and radians per pixel in Focal planes.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The electric field phase of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>plane_type</code></td>
          <td>
                <code>enum.<span title="enum.IntEnum">IntEnum</span>.<span title="enum.IntEnum.PlaneType">PlaneType</span></code>
          </td>
          <td><p>The current plane of wavefront, can be Pupil, Focal.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for Angular wavefronts.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel or radians/pixel</span>
<span class="sd">        The physical dimensions of each pixel. Units are in meters</span>
<span class="sd">        per pixel in Pupil planes and radians per pixel in Focal planes.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">        The current plane of wavefront, can be Pupil, Focal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span>
                     <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.wavefronts.AngularWavefront"><a class="headerlink" href="#dLux.wavefronts.AngularWavefront" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.AngularWavefront.__init__"><a class="headerlink" href="#dLux.wavefronts.AngularWavefront.__init__" title="Permanent link">Â¤</a></h2>
</div>
</details>
<details class="info">
<summary>Cartesian Wavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.wavefronts.CartesianWavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code></p>

  
      <p>A class representing some wavefront, designed to track the various
parameters such as wavelength, pixel_scale, amplitude and phase, as well as
a helper parmeter, plane_type. CartesianWavefronts have pixel scales in
units of meters per pixel in all planes.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The wavelength of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The electric field phase of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters/pixel</code>
          </td>
          <td><p>The physical dimensions of the pixels representing the wavefront.</p></td>
        </tr>
        <tr>
          <td><code>plane_type</code></td>
          <td>
                <code>enum.<span title="enum.IntEnum">IntEnum</span>.<span title="enum.IntEnum.PlaneType">PlaneType</span></code>
          </td>
          <td><p>The current plane type of wavefront, can be Pupil, Focal or
Intermediate.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/wavefronts.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CartesianWavefront</span><span class="p">(</span><span class="n">Wavefront</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing some wavefront, designed to track the various</span>
<span class="sd">    parameters such as wavelength, pixel_scale, amplitude and phase, as well as</span>
<span class="sd">    a helper parmeter, plane_type. CartesianWavefronts have pixel scales in</span>
<span class="sd">    units of meters per pixel in all planes.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel</span>
<span class="sd">        The physical dimensions of the pixels representing the wavefront.</span>
<span class="sd">    plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">        The current plane type of wavefront, can be Pupil, Focal or</span>
<span class="sd">        Intermediate.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for Cartesian wavefronts.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength : float, meters</span>
<span class="sd">            The wavelength of the `Wavefront`.</span>
<span class="sd">        pixel_scale : float, meters/pixel</span>
<span class="sd">            The physical dimensions of each pixel.</span>
<span class="sd">        amplitude : Array, power</span>
<span class="sd">            The electric field amplitude of the `Wavefront`.</span>
<span class="sd">        phase : Array, radians</span>
<span class="sd">            The electric field phase of the `Wavefront`.</span>
<span class="sd">        plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">            The current plane of wavefront, can be Pupil, Focal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span>
                         <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.CartesianWavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.CartesianWavefront.__init__" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for Cartesian wavefronts.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The wavelength of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The physical dimensions of each pixel.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The electric field phase of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>plane_type</code></td>
          <td>
                <code>enum.<span title="enum.IntEnum">IntEnum</span>.<span title="enum.IntEnum.PlaneType">PlaneType</span></code>
          </td>
          <td><p>The current plane of wavefront, can be Pupil, Focal.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for Cartesian wavefronts.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel</span>
<span class="sd">        The physical dimensions of each pixel.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">        The current plane of wavefront, can be Pupil, Focal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span>
                     <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.wavefronts.CartesianWavefront"><a class="headerlink" href="#dLux.wavefronts.CartesianWavefront" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.CartesianWavefront.__init__"><a class="headerlink" href="#dLux.wavefronts.CartesianWavefront.__init__" title="Permanent link">Â¤</a></h2>
</div>
</details>
<details class="info">
<summary>Far Field Fresnel Wavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.wavefronts.FarFieldFresnelWavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code></p>

  
      <p>A class representing some wavefront, designed to track the various
parameters such as wavelength, pixel_scale, amplitude and phase, as well as
a helper parmeter, plane_type. FarFieldFresnelWavefronts are designed to
work with FarFieldFresnel Propagators, and are better able to represent the
behaviour of wavefronts outside of the focal planes, in the far-field
approximation.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The wavelength of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The electric field phase of the <code>Wavefront</code>.</p></td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters/pixel</code>
          </td>
          <td><p>The physical dimensions of the pixels representing the wavefront.</p></td>
        </tr>
        <tr>
          <td><code>plane_type</code></td>
          <td>
                <code>enum.<span title="enum.IntEnum">IntEnum</span>.<span title="enum.IntEnum.PlaneType">PlaneType</span></code>
          </td>
          <td><p>The current plane type of wavefront, can be Pupil, Focal or
Intermediate.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/wavefronts.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FarFieldFresnelWavefront</span><span class="p">(</span><span class="n">Wavefront</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing some wavefront, designed to track the various</span>
<span class="sd">    parameters such as wavelength, pixel_scale, amplitude and phase, as well as</span>
<span class="sd">    a helper parmeter, plane_type. FarFieldFresnelWavefronts are designed to</span>
<span class="sd">    work with FarFieldFresnel Propagators, and are better able to represent the</span>
<span class="sd">    behaviour of wavefronts outside of the focal planes, in the far-field</span>
<span class="sd">    approximation.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel</span>
<span class="sd">        The physical dimensions of the pixels representing the wavefront.</span>
<span class="sd">    plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">        The current plane type of wavefront, can be Pupil, Focal or</span>
<span class="sd">        Intermediate.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for FarFieldFresnel wavefronts.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength : float, meters</span>
<span class="sd">            The wavelength of the `Wavefront`.</span>
<span class="sd">        pixel_scale : float, meters/pixel or radians.pixl</span>
<span class="sd">            The physical dimensions of each pixel. Units are in meters</span>
<span class="sd">            per pixel in Pupil planes and meters per pixel or radians per pixel</span>
<span class="sd">            in Focal planes depending on if Cartesian or Angular Propagators</span>
<span class="sd">            are used respectively.</span>
<span class="sd">        amplitude : Array, power</span>
<span class="sd">            The electric field amplitude of the `Wavefront`.</span>
<span class="sd">        phase : Array, radians</span>
<span class="sd">            The electric field phase of the `Wavefront`.</span>
<span class="sd">        plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">            The current plane of wavefront, can be Pupil, Focal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span>
                         <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.FarFieldFresnelWavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.FarFieldFresnelWavefront.__init__" class="headerlink" title="Permanent link">Â¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for FarFieldFresnel wavefronts.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The wavelength of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The physical dimensions of each pixel. Units are in meters
per pixel in Pupil planes and meters per pixel or radians per pixel
in Focal planes depending on if Cartesian or Angular Propagators
are used respectively.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, power</code>
          </td>
          <td><p>The electric field amplitude of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="dLux.wavefronts.Array">Array</span>, radians</code>
          </td>
          <td><p>The electric field phase of the <code>Wavefront</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>plane_type</code></td>
          <td>
                <code>enum.<span title="enum.IntEnum">IntEnum</span>.<span title="enum.IntEnum.PlaneType">PlaneType</span></code>
          </td>
          <td><p>The current plane of wavefront, can be Pupil, Focal.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">plane_type</span>  <span class="p">:</span> <span class="n">PlaneType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for FarFieldFresnel wavefronts.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel or radians.pixl</span>
<span class="sd">        The physical dimensions of each pixel. Units are in meters</span>
<span class="sd">        per pixel in Pupil planes and meters per pixel or radians per pixel</span>
<span class="sd">        in Focal planes depending on if Cartesian or Angular Propagators</span>
<span class="sd">        are used respectively.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    plane_type : enum.IntEnum.PlaneType</span>
<span class="sd">        The current plane of wavefront, can be Pupil, Focal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span>
                     <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">plane_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.wavefronts.FarFieldFresnelWavefront"><a class="headerlink" href="#dLux.wavefronts.FarFieldFresnelWavefront" title="Permanent link">Â¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.FarFieldFresnelWavefront.__init__"><a class="headerlink" href="#dLux.wavefronts.FarFieldFresnelWavefront.__init__" title="Permanent link">Â¤</a></h2>
</div>
</details>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>