
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for dLux.">
      
      
        <meta name="author" content="Louis Desdoigts">
      
      
        <link rel="canonical" href="https://louisdesdoigts.github.io/dlux/docs/API/wavefronts/">
      
      
        <link rel="prev" href="../overview/">
      
      
        <link rel="next" href="../optics/">
      
      <link rel="icon" href="../../../material/telescope">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Wavefronts - dLux</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#wavefronts-wavefrontspy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dLux" class="md-header__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dLux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Wavefronts
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dLux" class="md-nav__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    dLux
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/phase_retrieval_demo/" class="md-nav__link">
        Phase Retrieval in dLux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/designing_a_mask/" class="md-nav__link">
        Phase Mask Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/flatfield_calibration/" class="md-nav__link">
        Pixel Level Calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/fisher_information/" class="md-nav__link">
        Fisher Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/HMC/" class="md-nav__link">
        Numpyro and Hamiltonian Monte Carlo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          dLux API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          dLux API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Wavefronts
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optical_layers/" class="md-nav__link">
        Optical Layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../propagators/" class="md-nav__link">
        Propagators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../apertures/" class="md-nav__link">
        Apertures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aberrations/" class="md-nav__link">
        Aberrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spectra/" class="md-nav__link">
        Spectra
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/" class="md-nav__link">
        Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../images/" class="md-nav__link">
        Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detector_layers/" class="md-nav__link">
        Detector Layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detectors/" class="md-nav__link">
        Detectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instruments/" class="md-nav__link">
        Instruments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observations/" class="md-nav__link">
        Observations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Utils API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Utils API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/math/" class="md-nav__link">
        Math
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/coordinates/" class="md-nav__link">
        Coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/helpers/" class="md-nav__link">
        Helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        Change Log
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="wavefronts-wavefrontspy">Wavefronts: wavefronts.py<a class="headerlink" href="#wavefronts-wavefrontspy" title="Permanent link">¤</a></h1>
<p>This module contains the classes that define the behaviour of Wavefronts in dLux.</p>
<p>There are two public classes: <code>Wavefront</code> and <code>FresnelWavefront</code></p>
<p>All <code>Wavefronts</code> have the following attributes:</p>
<ul>
<li><code>wavelength</code></li>
<li><code>amplitude</code></li>
<li><code>phase</code></li>
<li><code>pixel_scale</code></li>
<li><code>plane</code></li>
<li><code>units</code></li>
</ul>
<p>The wavelength attribute is the wavelength of the wavefront. The amplitude and phase attributes are the amplitude and phase of the wavefront. The pixel_scale is the physical size of the pixels representing the wavefront. The plane attribute is the current plane of the wavefront, which can be 'Pupil', 'Focal' or 'Intermediate'. The units attribute is the current units of the wavefront, which can be 'Cartesian' or 'Angular'.</p>
<p>It is important to note here that the <code>plane</code> and <code>units</code> attributes do not actually determine the behaviour of the wavefront, but rather are used to track the current unit type. Ie if you set the units parameter from 'Cartesian' to 'Angular' the wavefront will not be converted to angular units, but rather the units will be <em>treated</em> as angular in propagations, which can lead to incorrect results.</p>
<details class="info">
<summary>Wavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.wavefronts.Wavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="zodiax.Base">Base</span></code></p>

  
      <p>A class representing some wavefront, designed to track the various
parameters such as wavelength, pixel_scale, amplitude and phase, as well as
two helper parmeters, plane and units.</p>
<p>All wavefronts currently only support square amplitude and phase arrays.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavelength of the <code>Wavefront</code>.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, power</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The electric field amplitude of the <code>Wavefront</code>.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The electric field phase of the <code>Wavefront</code>.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters/pixel or radians/pixel</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The physical dimensions of the pixels representing the wavefront. This
can be in units of either meters per pixel or radians per pixel
depending on if 'unit' is 'Cartesian' or 'Angular'.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>plane</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The current plane type of wavefront, can be 'Pupil', 'Focal' or
'Intermediate'.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>units</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The current units of the wavefront, can be 'Cartesian' or 'Angular'.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/wavefronts.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  18</span>
<span class="normal">  19</span>
<span class="normal">  20</span>
<span class="normal">  21</span>
<span class="normal">  22</span>
<span class="normal">  23</span>
<span class="normal">  24</span>
<span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Wavefront</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing some wavefront, designed to track the various</span>
<span class="sd">    parameters such as wavelength, pixel_scale, amplitude and phase, as well as</span>
<span class="sd">    two helper parmeters, plane and units.</span>

<span class="sd">    All wavefronts currently only support square amplitude and phase arrays.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel or radians/pixel</span>
<span class="sd">        The physical dimensions of the pixels representing the wavefront. This</span>
<span class="sd">        can be in units of either meters per pixel or radians per pixel</span>
<span class="sd">        depending on if &#39;unit&#39; is &#39;Cartesian&#39; or &#39;Angular&#39;.</span>
<span class="sd">    plane : str</span>
<span class="sd">        The current plane type of wavefront, can be &#39;Pupil&#39;, &#39;Focal&#39; or</span>
<span class="sd">        &#39;Intermediate&#39;.</span>
<span class="sd">    units : str</span>
<span class="sd">        The current units of the wavefront, can be &#39;Cartesian&#39; or &#39;Angular&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wavelength</span>  <span class="p">:</span> <span class="n">Array</span>
    <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span>
    <span class="n">amplitude</span>   <span class="p">:</span> <span class="n">Array</span>
    <span class="n">phase</span>       <span class="p">:</span> <span class="n">Array</span>
    <span class="n">plane</span>       <span class="p">:</span> <span class="nb">str</span>
    <span class="n">units</span>       <span class="p">:</span> <span class="nb">str</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>       <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">npixels</span>    <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">diameter</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">wavelength</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels that represent the `Wavefront`.</span>
<span class="sd">        diameter : float, meters</span>
<span class="sd">            The physical dimensions of each square pixel.</span>
<span class="sd">        wavelength : float, meters</span>
<span class="sd">            The wavelength of the `Wavefront`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span>  <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">diameter</span><span class="o">/</span><span class="n">npixels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Input checks</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;wavelength must have shape ().&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;diameter must have shape ().&quot;</span><span class="p">)</span>

        <span class="c1"># Always initialised in Pupil plane with Cartesian Coords</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;Pupil&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Cartesian&#39;</span>


    <span class="c1">########################</span>
    <span class="c1">### Getter Functions ###</span>
    <span class="c1">########################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">diameter</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current wavefront diameter calulated using the pixel scale</span>
<span class="sd">        and number of pixels.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        diameter : Array, meters or radians</span>
<span class="sd">            The current diameter of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">npixels</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the side length of the arrays currently representing the</span>
<span class="sd">        wavefront. Taken from the last axis of the amplitude array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pixels : int</span>
<span class="sd">            The number of pixels that represent the `Wavefront`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">real</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the real component of the `Wavefront`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Array</span>
<span class="sd">            The real component of the `Wavefront` phasor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">imaginary</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the imaginary component of the `Wavefront`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Array</span>
<span class="sd">            The imaginary component of the `Wavefront` phasor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">phasor</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The electric field phasor described by this Wavefront in complex form.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : Array</span>
<span class="sd">            The electric field phasor of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">psf</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the Point Spread Function (PSF), ie the squared modulus</span>
<span class="sd">        of the complex wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psf : Array</span>
<span class="sd">            The PSF of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">**</span> <span class="mi">2</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coordinates</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the physical positions of the wavefront pixels in meters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        coordinates : Array</span>
<span class="sd">            The coordinates of the centers of each pixel representing the</span>
<span class="sd">            wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dlu</span><span class="o">.</span><span class="n">pixel_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wavenumber</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the wavenumber of the wavefront (2 * pi / wavelength).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavenumber : Array, 1/meters</span>
<span class="sd">            The wavenumber of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fringe_size</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the size of the fringes in angular units.</span>

<span class="sd">        # TODO Units check</span>
<span class="sd">        # TODO Possibly output in unit based on units attribute</span>
<span class="sd">        # TODO make methods use this</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fringe_size : Array, radians</span>
<span class="sd">            The wavenumber of the wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span>


    <span class="c1">#####################</span>
    <span class="c1">### Magic Methods ###</span>
    <span class="c1">#####################</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Magic method used to to give a simple API for interaction with different</span>
<span class="sd">        layer types and arrays. If the input &#39;other&#39; in an array it is treated</span>
<span class="sd">        as an array of OPD values and is added to the wavefront. If it is an</span>
<span class="sd">        Aberration, the wavefront is passed to the layer and the output</span>
<span class="sd">        wavefront is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : Array or Aberration</span>
<span class="sd">            The input to add to the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The output wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># None Type</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># Some Optical Layer</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">OpticalLayer</span><span class="p">()):</span>
            <span class="k">return</span> <span class="n">other</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Array based inputs - Defaults to OPD</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Array</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="c1"># Other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only add an array or OpticalLayer to &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Wavefront. Got: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Magic method used to to give a simple API for interaction with different</span>
<span class="sd">        layer types and arrays. If the input &#39;other&#39; in an array it is treated</span>
<span class="sd">        as an array of OPD values and is added to the wavefront. If it is an</span>
<span class="sd">        Aberration, the wavefront is passed to the layer and the output</span>
<span class="sd">        wavefront is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : Array or Aberration</span>
<span class="sd">            The input to add to the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The output wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Magic method used to to give a simple API for interaction with different</span>
<span class="sd">        layer types and arrays. If the input &#39;other&#39; in an array it is treated</span>
<span class="sd">        as an array of tranmission values and is multipled by the wavefront</span>
<span class="sd">        amplitude. If it is an Aperture, Aberration, or Propagator, the</span>
<span class="sd">        wavefront is passed to the layer and the output wavefront is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : Array or Aberration or Aperture or Propagator</span>
<span class="sd">            The input to add to the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The output wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># None Type, return None</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># Some Optical Layer, apply it</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">OpticalLayer</span><span class="p">()):</span>
            <span class="k">return</span> <span class="n">other</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Array based inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Array</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>

            <span class="c1"># Complex array - Multiply the phasors</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
                <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phasor</span> <span class="o">*</span> <span class="n">other</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">],</span> 
                    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">)])</span>

            <span class="c1"># Scalar array - Multiply ampltiude</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

        <span class="c1"># Other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only multiply Wavefront by array or &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;OpticalLayer. Got: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__imul__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Magic method used to to give a simple API for interaction with different</span>
<span class="sd">        layer types and arrays. If the input &#39;other&#39; in an array it is treated</span>
<span class="sd">        as an array of tranmission values and is multipled by the wavefront</span>
<span class="sd">        amplitude. If it is an Aperture, Aberration, or Propagator, the</span>
<span class="sd">        wavefront is passed to the layer and the output wavefront is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : Array or Aberration or Aperture or Propagator</span>
<span class="sd">            The input to add to the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The output wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="c1">#######################</span>
    <span class="c1">### Adder Functions ###</span>
    <span class="c1">#######################</span>
    <span class="k">def</span> <span class="nf">add_opd</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">path_difference</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the wavelength-dependent phase based on the supplied optical</span>
<span class="sd">        path difference.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path_difference : Array, meters</span>
<span class="sd">            The physical optical path difference of either the entire wavefront</span>
<span class="sd">            or each pixel individually.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront with the phases updated according to the supplied</span>
<span class="sd">            path_difference</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">phase_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">path_difference</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">phase_difference</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">phase</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies input array to the phase of the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phase : Array, radians</span>
<span class="sd">            The phase to be added to the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront with updated phases.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add this extra non check to allow PhaseOptics to have a None phase</span>
        <span class="c1"># and still be able to be &#39;added&#39; to it, making this the phase </span>
        <span class="c1"># equivilent of `wf += opd` -&gt; `wf = wf.add_phase(phase)`</span>
        <span class="k">if</span> <span class="n">phase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>


    <span class="c1">#######################</span>
    <span class="c1">### Other Functions ###</span>
    <span class="c1">#######################</span>
    <span class="k">def</span> <span class="nf">tilt</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">angles</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tilts the wavefront by the angles in the (x, y) by modifying the </span>
<span class="sd">        phase arrays.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angles : Array, radians</span>
<span class="sd">            The (x, y) angles by which to tilt the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The tilted wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">or</span> <span class="n">angles</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;angles must be an array of shape (2,).&quot;</span><span class="p">)</span>
        <span class="n">opd</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">angles</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="n">opd</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalises the total power of the wavefront to 1.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront with the normalised electric field amplitudes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_to_field</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="nb">complex</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the wavefront in either (ampltide, phase) or (real, imaginary)</span>
<span class="sd">        form.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        complex : bool = False</span>
<span class="sd">            Whether to return the wavefront in (real, imaginary) form.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : Array</span>
<span class="sd">            The wavefront in either (ampltide, phase) or (real, imaginary) form.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">complex</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imaginary</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">_to_ampltide_phase</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">field</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the input field in (real, imaginary) (ampltide, phase) form.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        field : Array</span>
<span class="sd">            The wavefront field in (ampltide, phase) form.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : Array</span>
<span class="sd">            The wavefront field in (real, imaginary) form.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">axis</span> <span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Flips the amplitude and phase of the wavefront along the specified axes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : tuple</span>
<span class="sd">            The axes along which to flip the wavefront.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront with the flipped amplitude and phase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_field</span><span class="p">()</span>
        <span class="n">flipper</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="n">flipper</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">scale_to</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">npixels</span>     <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="nb">complex</span>     <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs a paraxial interpolation on the wavefront, determined by the</span>
<span class="sd">        the pixel_scale_out and npixels parameters. The transformation is done</span>
<span class="sd">        on the amplitude and phase arrays, but can be done on the real and</span>
<span class="sd">        imaginary components by passing `complex=True`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels representing the wavefront after the</span>
<span class="sd">            interpolation.</span>
<span class="sd">        pixel_scale: Array</span>
<span class="sd">            The pixel scale of the array after the interpolation.</span>
<span class="sd">        complex : bool = False</span>
<span class="sd">            Whether to rotate the real and imaginary representation of the</span>
<span class="sd">            wavefront as opposed to the the amplitude and phase representation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront interpolated to the size and shape determined by</span>
<span class="sd">            npixels and pixel_scale_out, with the updated pixel_scale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get field in either (ampltide, phase) or (real, imaginary)</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_field</span><span class="p">(</span><span class="nb">complex</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="c1"># Scale the field</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">dlu</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">)</span>

        <span class="c1"># Cast back to (amplitude, phase) if needed</span>
        <span class="k">if</span> <span class="nb">complex</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_ampltide_phase</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

        <span class="c1"># Return new wavefront</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>


    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span>    <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
               <span class="n">angle</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
               <span class="n">order</span>   <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
               <span class="nb">complex</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs a paraxial rotation on the wavefront, determined by the</span>
<span class="sd">        the angle parameter, using interpolation. The transformation is done</span>
<span class="sd">        on the amplitude and phase arrays, but can be done on the real and</span>
<span class="sd">        imaginary components by passing `complex=True`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : Array, radians</span>
<span class="sd">            The angle by which to rotate the wavefront in a clockwise direction.</span>
<span class="sd">        order : int = 1</span>
<span class="sd">            The interpolation order to use.</span>
<span class="sd">        complex : bool = False</span>
<span class="sd">            Whether to rotate the real and imaginary representation of the</span>
<span class="sd">            wavefront as opposed to the the amplitude and phase representation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new wavefront rotated by angle in the clockwise direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get field in either (ampltide, phase) or (real, imaginary)</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_field</span><span class="p">(</span><span class="nb">complex</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="c1"># Rotate the field</span>
        <span class="n">rotator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">dlu</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">rotator</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>

        <span class="c1"># Cast back to (amplitude, phase) if needed</span>
        <span class="k">if</span> <span class="nb">complex</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_ampltide_phase</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

        <span class="c1"># Return new wavefront</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>



    <span class="c1">############################</span>
    <span class="c1">### Padding and Cropping ###</span>
    <span class="c1">############################</span>
    <span class="k">def</span> <span class="nf">pad_to</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">npixels</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Paraxially zero-pads the `Wavefront` to the size determined by</span>
<span class="sd">        npixels. Note this only supports padding arrays of even dimension</span>
<span class="sd">        to even dimension, and odd dimension to to odd dimension, ie 2 -&gt; 4 or</span>
<span class="sd">        3 -&gt; 5.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The size of the array to pad to the wavefront to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` zero-padded to the size npixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npixels_in</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>
        <span class="k">if</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="n">npixels</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only supports even -&gt; even or odd -&gt; odd input.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">npixels</span> <span class="o">&lt;</span> <span class="n">npixels_in</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;npixels must be larger than the current array &quot;</span>
                <span class="s2">&quot;size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">))</span>

        <span class="n">new_centre</span> <span class="o">=</span> <span class="n">npixels</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">centre</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">//</span> <span class="mi">2</span>
        <span class="n">remainder</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span>
        <span class="n">padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">])</span>

        <span class="n">amplitude</span> <span class="o">=</span> <span class="n">padded</span><span class="o">.</span><span class="n">at</span><span class="p">[</span>
                <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">,</span>
                <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span>
            <span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">padded</span><span class="o">.</span><span class="n">at</span><span class="p">[</span>
                <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">,</span>
                <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span>
            <span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">crop_to</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">npixels</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Paraxially crops the `Wavefront` to the size determined by npixels.</span>
<span class="sd">        Note this only supports padding arrays of even dimension to even</span>
<span class="sd">        dimension, and odd dimension to to odd dimension, ie 4 -&gt; 2 or 5 -&gt; 3.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The size of the array to crop to the wavefront to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The new `Wavefront` cropped to the size npixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npixels_in</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>

        <span class="k">if</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="n">npixels</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only supports even -&gt; even or odd -&gt; odd input.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">npixels</span> <span class="o">&gt;</span> <span class="n">npixels_in</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;npixels must be smaller than the current array &quot;</span>
                <span class="s2">&quot;size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">))</span>

        <span class="n">new_centre</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">//</span> <span class="mi">2</span>
        <span class="n">centre</span> <span class="o">=</span> <span class="n">npixels</span> <span class="o">//</span> <span class="mi">2</span>

        <span class="n">amplitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">[</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">]</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>


    <span class="c1">#############################</span>
    <span class="c1">### Propagation Functions ###</span>
    <span class="c1">#############################</span>
    <span class="k">def</span> <span class="nf">_FFT_output</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                    <span class="n">pad_factor</span>   <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                    <span class="n">inverse</span>      <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the output plane, unit, and pixel scale.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            If True, the propagation is treated as an inverse FFT.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        plane : str</span>
<span class="sd">            The output plane of the propagation.</span>
<span class="sd">        units : str</span>
<span class="sd">            The units of the output plane.</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The pixel scale of the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fringe_size</span> <span class="o">/</span> <span class="n">pad_factor</span>
        <span class="k">if</span> <span class="n">focal_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Angular&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Cartesian&#39;</span>
            <span class="n">pixel_scale</span> <span class="o">*=</span> <span class="n">focal_length</span>

            <span class="c1"># Check for invalid propagation</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;Angular&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;focal_length can not be specific when&quot;</span>
                    <span class="s2">&quot;propagating from a Focal plane with angular units.&quot;</span><span class="p">)</span>

        <span class="c1"># Check planes</span>
        <span class="k">if</span> <span class="n">inverse</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">!=</span> <span class="s1">&#39;Focal&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only do an IFFT from a Focal plane, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;current plane is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;Pupil&#39;</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Cartesian&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">!=</span> <span class="s1">&#39;Pupil&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only do an FFT from a Pupil plane, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;current plane is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;Focal&#39;</span>

        <span class="k">return</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">pixel_scale</span>


    <span class="k">def</span> <span class="nf">_FFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
             <span class="n">phasor</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
             <span class="n">inverse</span>      <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the output plane, unit, pixel scale, and returns the</span>
<span class="sd">        appropriate propagation function</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            If True, the inverse FFT is used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        phasor : Array</span>
<span class="sd">            The propagated phasor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inverse</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">phasor</span><span class="p">))</span> <span class="o">/</span> <span class="n">phasor</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">phasor</span><span class="p">))</span> <span class="o">*</span> <span class="n">phasor</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">FFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
            <span class="n">pad</span>          <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront by perfroming a Fast Fourier Transform.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pad : int = 2</span>
<span class="sd">            The padding factory to apply to the input wavefront before</span>
<span class="sd">            performing the FFT.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The propagated wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate</span>
        <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">pixel_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FFT_output</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">)</span>

        <span class="c1"># Pad must be int</span>
        <span class="n">npixels</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span> <span class="o">*</span> <span class="p">(</span><span class="n">pad</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">ampltide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="n">ampltide</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FFT</span><span class="p">(</span><span class="n">phasor</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">)</span>

        <span class="c1"># Return new wavefront</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">IFFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
             <span class="n">pad</span>          <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
             <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront by perfroming a, Inverse Fast Fourier</span>
<span class="sd">        Transform.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pad : int = 2</span>
<span class="sd">            The padding factory to apply to the input wavefront before</span>
<span class="sd">            performing the FFT.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The propagated wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate</span>
        <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">pixel_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FFT_output</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> 
            <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Pad must be int</span>
        <span class="n">npixels</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span> <span class="o">*</span> <span class="p">(</span><span class="n">pad</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">ampltide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="n">ampltide</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FFT</span><span class="p">(</span><span class="n">phasor</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Return new wavefront</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">_MFT_output</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
                    <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                    <span class="n">inverse</span>      <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the output plane and unit for the MFT</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            If True, the inverse MFT is used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        plane : str</span>
<span class="sd">            The output plane of the propagation.</span>
<span class="sd">        units : str</span>
<span class="sd">            The units of the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get units</span>
        <span class="k">if</span> <span class="n">focal_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Angular&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Cartesian&#39;</span>

            <span class="c1"># Check for invalid propagation</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;Angular&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;focal_length can not be specific when&quot;</span>
                    <span class="s2">&quot;propagating from a Focal plane with angular units.&quot;</span><span class="p">)</span>

        <span class="c1"># Check planes</span>
        <span class="k">if</span> <span class="n">inverse</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">!=</span> <span class="s1">&#39;Focal&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only do an IMFT from a Focal plane, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;current plane is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;Pupil&#39;</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Cartesian&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">!=</span> <span class="s1">&#39;Pupil&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only do an MFT from a Pupil plane, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;current plane is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;Focal&#39;</span>

        <span class="k">return</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span>


    <span class="k">def</span> <span class="nf">_nfringes</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
                  <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                  <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                  <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the number of fringes in the output plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The pixel scale of the output plane.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        nfringes : Array</span>
<span class="sd">            The number of fringes in the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output_size</span> <span class="o">=</span> <span class="n">npixels</span> <span class="o">*</span> <span class="n">pixel_scale</span>

        <span class="c1"># Angular</span>
        <span class="k">if</span> <span class="n">focal_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">output_size</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fringe_size</span>

        <span class="c1"># Cartesian</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">output_size</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fringe_size</span> <span class="o">*</span> <span class="n">focal_length</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_transfer_matrix</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
                         <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                         <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                         <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
                         <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">inverse</span>      <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the transfer matrix for the MFT.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The pixel scale of the output plane.</span>
<span class="sd">        shift : Array = 0.</span>
<span class="sd">            The shift to apply to the output plane.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Is this a forward or inverse MFT.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        transfer_matrix : Array</span>
<span class="sd">            The transfer matrix for the MFT.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scale_in</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>
        <span class="n">scale_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nfringes</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">)</span> <span class="o">/</span> <span class="n">npixels</span>
        <span class="n">in_vec</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">pixel_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span> <span class="n">scale_in</span><span class="p">,</span> <span class="n">shift</span> <span class="o">*</span> <span class="n">scale_in</span><span class="p">)</span>
        <span class="n">out_vec</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">pixel_coordinates</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">scale_out</span><span class="p">,</span> <span class="n">shift</span> <span class="o">*</span> <span class="n">scale_out</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inverse</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">in_vec</span><span class="p">,</span> <span class="n">out_vec</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">in_vec</span><span class="p">,</span> <span class="n">out_vec</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_MFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
             <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
             <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
             <span class="n">inverse</span>      <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs the actual phasor propagation and normalises the output</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output wavefront.</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The pixel scale of the output wavefront.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>
<span class="sd">        shift : Array = np.zeros(2)</span>
<span class="sd">            The shift in the center of the output plane.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Is this a forward or inverse MFT.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        phasor : Array</span>
<span class="sd">            The propagated phasor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Transfer Matrices</span>
        <span class="n">x_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_matrix</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">shift</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
            <span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">)</span>
        <span class="n">y_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_matrix</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">shift</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
            <span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

        <span class="c1"># Propagation</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_matrix</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">phasor</span><span class="p">)</span> <span class="o">@</span> <span class="n">x_matrix</span>
        <span class="n">nfringes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nfringes</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">)</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nfringes</span><span class="p">)</span> <span class="o">-</span> \
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">npixels</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">phasor</span>


    <span class="k">def</span> <span class="nf">MFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
            <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
            <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
            <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront by perfroming a 2-sided Matrix Fourier</span>
<span class="sd">        Transform. TODO: Add link to Soumer et al. 2007(?).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output wavefront.</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The pixel scale of the output wavefront.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The propagated wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate</span>
        <span class="n">plane</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT_output</span><span class="p">(</span><span class="n">focal_length</span><span class="p">)</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">)</span>

        <span class="c1"># Return new wavefront</span>
        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span> <span class="c1"># Allow float input</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">IMFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
             <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
             <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront by perfroming a, inverse 2-sided Matrix Fourier</span>
<span class="sd">        Transform. TODO: Add link to Soumer et al. 2007(?).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output wavefront.</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The pixel scale of the output wavefront.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The propagated wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate</span>
        <span class="n">plane</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT_output</span><span class="p">(</span><span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Return new wavefront</span>
        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span> <span class="c1"># Allow float input</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">shifted_MFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
                    <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                    <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">pixel</span>        <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront by perfroming a 2-sided Matrix Fourier</span>
<span class="sd">        Transform with a shift in the center of the output plane.</span>
<span class="sd">        TODO: Add link to Soumer et al. 2007(?), </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output wavefront.</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The pixel scale of the output wavefront.</span>
<span class="sd">        shift : Array</span>
<span class="sd">            The shift in the center of the output plane.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>
<span class="sd">        pixel : bool = True</span>
<span class="sd">            Whether the shift is in pixels or the units of pixel_scale.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The propagated wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate</span>
        <span class="n">plane</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT_output</span><span class="p">(</span><span class="n">focal_length</span><span class="p">)</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="k">if</span> <span class="n">pixel</span> <span class="k">else</span> <span class="n">shift</span> <span class="o">/</span> <span class="n">pixel_scale</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>

        <span class="c1"># Return new wavefront</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">shifted_IMFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
                    <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                    <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">pixel</span>        <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront by perfroming a, Inverse 2-sided Matrix Fourier</span>
<span class="sd">        Transform with a shift in the center of the output plane.</span>
<span class="sd">        TODO: Add link to Soumer et al. 2007(?), </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output wavefront.</span>
<span class="sd">        pixel_scale : Array</span>
<span class="sd">            The pixel scale of the output wavefront.</span>
<span class="sd">        shift : Array</span>
<span class="sd">            The shift in the center of the output plane.</span>
<span class="sd">        focal_length : Array = None</span>
<span class="sd">            The focal length of the propagation. If None, the propagation is</span>
<span class="sd">            treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">            &#39;cartesian&#39; propagation.</span>
<span class="sd">        pixel : bool = True</span>
<span class="sd">            Whether the shift is in pixels or the units of pixel_scale.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The propagated wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate</span>
        <span class="n">plane</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT_output</span><span class="p">(</span><span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="k">if</span> <span class="n">pixel</span> <span class="k">else</span> <span class="n">shift</span> <span class="o">/</span> <span class="n">pixel_scale</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span>
            <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Return new wavefront</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.coordinates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">coordinates</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.coordinates" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the physical positions of the wavefront pixels in meters.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>coordinates</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The coordinates of the centers of each pixel representing the
wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.diameter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">diameter</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.diameter" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the current wavefront diameter calulated using the pixel scale
and number of pixels.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>diameter</code></td>          <td>
                <code>Array, meters or radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The current diameter of the wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.fringe_size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fringe_size</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.fringe_size" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the size of the fringes in angular units.</p>
<h3 id="dLux.wavefronts.Wavefront.fringe_size--todo-units-check">TODO Units check<a class="headerlink" href="#dLux.wavefronts.Wavefront.fringe_size--todo-units-check" title="Permanent link">¤</a></h3>
<h3 id="dLux.wavefronts.Wavefront.fringe_size--todo-possibly-output-in-unit-based-on-units-attribute">TODO Possibly output in unit based on units attribute<a class="headerlink" href="#dLux.wavefronts.Wavefront.fringe_size--todo-possibly-output-in-unit-based-on-units-attribute" title="Permanent link">¤</a></h3>
<h3 id="dLux.wavefronts.Wavefront.fringe_size--todo-make-methods-use-this">TODO make methods use this<a class="headerlink" href="#dLux.wavefronts.Wavefront.fringe_size--todo-make-methods-use-this" title="Permanent link">¤</a></h3>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fringe_size</code></td>          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavenumber of the wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.imaginary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">imaginary</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.imaginary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the imaginary component of the <code>Wavefront</code>.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The imaginary component of the <code>Wavefront</code> phasor.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.npixels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.npixels" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the side length of the arrays currently representing the
wavefront. Taken from the last axis of the amplitude array.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pixels</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels that represent the <code>Wavefront</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.phasor" class="doc doc-heading">
<code class="highlight language-python"><span class="n">phasor</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.phasor" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>The electric field phasor described by this Wavefront in complex form.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>field</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The electric field phasor of the wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.psf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">psf</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.psf" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the Point Spread Function (PSF), ie the squared modulus
of the complex wavefront.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>psf</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The PSF of the wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.real" class="doc doc-heading">
<code class="highlight language-python"><span class="n">real</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.real" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the real component of the <code>Wavefront</code>.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The real component of the <code>Wavefront</code> phasor.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="dLux.wavefronts.Wavefront.wavenumber" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wavenumber</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.wavefronts.Wavefront.wavenumber" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the wavenumber of the wavefront (2 * pi / wavelength).</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavenumber</code></td>          <td>
                <code><span title="jax.Array">Array</span>, 1</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavenumber of the wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.FFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">FFT</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.FFT" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront by perfroming a Fast Fourier Transform.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pad</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The padding factory to apply to the input wavefront before
performing the FFT.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal length of the propagation. If None, the propagation is
treated as an 'angular' propagation, else it is treated as a
'cartesian' propagation.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The propagated wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">FFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
        <span class="n">pad</span>          <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront by perfroming a Fast Fourier Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pad : int = 2</span>
<span class="sd">        The padding factory to apply to the input wavefront before</span>
<span class="sd">        performing the FFT.</span>
<span class="sd">    focal_length : Array = None</span>
<span class="sd">        The focal length of the propagation. If None, the propagation is</span>
<span class="sd">        treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">        &#39;cartesian&#39; propagation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The propagated wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate</span>
    <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">pixel_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FFT_output</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">)</span>

    <span class="c1"># Pad must be int</span>
    <span class="n">npixels</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span> <span class="o">*</span> <span class="p">(</span><span class="n">pad</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">ampltide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="n">ampltide</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FFT</span><span class="p">(</span><span class="n">phasor</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">)</span>

    <span class="c1"># Return new wavefront</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.IFFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">IFFT</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.IFFT" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront by perfroming a, Inverse Fast Fourier
Transform.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pad</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The padding factory to apply to the input wavefront before
performing the FFT.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal length of the propagation. If None, the propagation is
treated as an 'angular' propagation, else it is treated as a
'cartesian' propagation.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The propagated wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">IFFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
         <span class="n">pad</span>          <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
         <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront by perfroming a, Inverse Fast Fourier</span>
<span class="sd">    Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pad : int = 2</span>
<span class="sd">        The padding factory to apply to the input wavefront before</span>
<span class="sd">        performing the FFT.</span>
<span class="sd">    focal_length : Array = None</span>
<span class="sd">        The focal length of the propagation. If None, the propagation is</span>
<span class="sd">        treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">        &#39;cartesian&#39; propagation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The propagated wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate</span>
    <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">pixel_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FFT_output</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> 
        <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Pad must be int</span>
    <span class="n">npixels</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span> <span class="o">*</span> <span class="p">(</span><span class="n">pad</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">ampltide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="n">ampltide</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FFT</span><span class="p">(</span><span class="n">phasor</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Return new wavefront</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.IMFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">IMFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.IMFT" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront by perfroming a, inverse 2-sided Matrix Fourier
Transform. TODO: Add link to Soumer et al. 2007(?).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale of the output wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal length of the propagation. If None, the propagation is
treated as an 'angular' propagation, else it is treated as a
'cartesian' propagation.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The propagated wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">IMFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
         <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
         <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
         <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront by perfroming a, inverse 2-sided Matrix Fourier</span>
<span class="sd">    Transform. TODO: Add link to Soumer et al. 2007(?).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output wavefront.</span>
<span class="sd">    pixel_scale : Array</span>
<span class="sd">        The pixel scale of the output wavefront.</span>
<span class="sd">    focal_length : Array = None</span>
<span class="sd">        The focal length of the propagation. If None, the propagation is</span>
<span class="sd">        treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">        &#39;cartesian&#39; propagation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The propagated wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate</span>
    <span class="n">plane</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT_output</span><span class="p">(</span><span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Return new wavefront</span>
    <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span> <span class="c1"># Allow float input</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.MFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.MFT" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront by perfroming a 2-sided Matrix Fourier
Transform. TODO: Add link to Soumer et al. 2007(?).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale of the output wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal length of the propagation. If None, the propagation is
treated as an 'angular' propagation, else it is treated as a
'cartesian' propagation.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The propagated wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">MFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
        <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
        <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront by perfroming a 2-sided Matrix Fourier</span>
<span class="sd">    Transform. TODO: Add link to Soumer et al. 2007(?).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output wavefront.</span>
<span class="sd">    pixel_scale : Array</span>
<span class="sd">        The pixel scale of the output wavefront.</span>
<span class="sd">    focal_length : Array = None</span>
<span class="sd">        The focal length of the propagation. If None, the propagation is</span>
<span class="sd">        treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">        &#39;cartesian&#39; propagation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The propagated wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate</span>
    <span class="n">plane</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT_output</span><span class="p">(</span><span class="n">focal_length</span><span class="p">)</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">)</span>

    <span class="c1"># Return new wavefront</span>
    <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span> <span class="c1"># Allow float input</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.__add__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.__add__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Magic method used to to give a simple API for interaction with different
layer types and arrays. If the input 'other' in an array it is treated
as an array of OPD values and is added to the wavefront. If it is an
Aberration, the wavefront is passed to the layer and the output
wavefront is returned.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>other</code></td>
          <td>
                <code>Array or Aberration</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input to add to the wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Magic method used to to give a simple API for interaction with different</span>
<span class="sd">    layer types and arrays. If the input &#39;other&#39; in an array it is treated</span>
<span class="sd">    as an array of OPD values and is added to the wavefront. If it is an</span>
<span class="sd">    Aberration, the wavefront is passed to the layer and the output</span>
<span class="sd">    wavefront is returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other : Array or Aberration</span>
<span class="sd">        The input to add to the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The output wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># None Type</span>
    <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># Some Optical Layer</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">OpticalLayer</span><span class="p">()):</span>
        <span class="k">return</span> <span class="n">other</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Array based inputs - Defaults to OPD</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Array</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="c1"># Other</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only add an array or OpticalLayer to &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Wavefront. Got: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.__iadd__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__iadd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.__iadd__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Magic method used to to give a simple API for interaction with different
layer types and arrays. If the input 'other' in an array it is treated
as an array of OPD values and is added to the wavefront. If it is an
Aberration, the wavefront is passed to the layer and the output
wavefront is returned.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>other</code></td>
          <td>
                <code>Array or Aberration</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input to add to the wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Magic method used to to give a simple API for interaction with different</span>
<span class="sd">    layer types and arrays. If the input &#39;other&#39; in an array it is treated</span>
<span class="sd">    as an array of OPD values and is added to the wavefront. If it is an</span>
<span class="sd">    Aberration, the wavefront is passed to the layer and the output</span>
<span class="sd">    wavefront is returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other : Array or Aberration</span>
<span class="sd">        The input to add to the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The output wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.__imul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__imul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.__imul__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Magic method used to to give a simple API for interaction with different
layer types and arrays. If the input 'other' in an array it is treated
as an array of tranmission values and is multipled by the wavefront
amplitude. If it is an Aperture, Aberration, or Propagator, the
wavefront is passed to the layer and the output wavefront is returned.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>other</code></td>
          <td>
                <code>Array or Aberration or Aperture or Propagator</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input to add to the wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__imul__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Magic method used to to give a simple API for interaction with different</span>
<span class="sd">    layer types and arrays. If the input &#39;other&#39; in an array it is treated</span>
<span class="sd">    as an array of tranmission values and is multipled by the wavefront</span>
<span class="sd">    amplitude. If it is an Aperture, Aberration, or Propagator, the</span>
<span class="sd">    wavefront is passed to the layer and the output wavefront is returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other : Array or Aberration or Aperture or Propagator</span>
<span class="sd">        The input to add to the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The output wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels that represent the <code>Wavefront</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>diameter</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The physical dimensions of each square pixel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavelength of the <code>Wavefront</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>       <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">npixels</span>    <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">diameter</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">wavelength</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels that represent the `Wavefront`.</span>
<span class="sd">    diameter : float, meters</span>
<span class="sd">        The physical dimensions of each square pixel.</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span>  <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">diameter</span><span class="o">/</span><span class="n">npixels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">phase</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Input checks</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;wavelength must have shape ().&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diameter</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;diameter must have shape ().&quot;</span><span class="p">)</span>

    <span class="c1"># Always initialised in Pupil plane with Cartesian Coords</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="s1">&#39;Pupil&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Cartesian&#39;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.__mul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.__mul__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Magic method used to to give a simple API for interaction with different
layer types and arrays. If the input 'other' in an array it is treated
as an array of tranmission values and is multipled by the wavefront
amplitude. If it is an Aperture, Aberration, or Propagator, the
wavefront is passed to the layer and the output wavefront is returned.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>other</code></td>
          <td>
                <code>Array or Aberration or Aperture or Propagator</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input to add to the wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Magic method used to to give a simple API for interaction with different</span>
<span class="sd">    layer types and arrays. If the input &#39;other&#39; in an array it is treated</span>
<span class="sd">    as an array of tranmission values and is multipled by the wavefront</span>
<span class="sd">    amplitude. If it is an Aperture, Aberration, or Propagator, the</span>
<span class="sd">    wavefront is passed to the layer and the output wavefront is returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other : Array or Aberration or Aperture or Propagator</span>
<span class="sd">        The input to add to the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The output wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># None Type, return None</span>
    <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># Some Optical Layer, apply it</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">OpticalLayer</span><span class="p">()):</span>
        <span class="k">return</span> <span class="n">other</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Array based inputs</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Array</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>

        <span class="c1"># Complex array - Multiply the phasors</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
            <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phasor</span> <span class="o">*</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s2">&quot;amplitude&quot;</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">],</span> 
                <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">)])</span>

        <span class="c1"># Scalar array - Multiply ampltiude</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="c1"># Other</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only multiply Wavefront by array or &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;OpticalLayer. Got: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.add_opd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_opd</span><span class="p">(</span><span class="n">path_difference</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.add_opd" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the wavelength-dependent phase based on the supplied optical
path difference.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path_difference</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The physical optical path difference of either the entire wavefront
or each pixel individually.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new wavefront with the phases updated according to the supplied
path_difference</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_opd</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">path_difference</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the wavelength-dependent phase based on the supplied optical</span>
<span class="sd">    path difference.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path_difference : Array, meters</span>
<span class="sd">        The physical optical path difference of either the entire wavefront</span>
<span class="sd">        or each pixel individually.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront with the phases updated according to the supplied</span>
<span class="sd">        path_difference</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">phase_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">path_difference</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">phase_difference</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.add_phase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_phase</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.add_phase" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies input array to the phase of the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The phase to be added to the wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new wavefront with updated phases.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">phase</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies input array to the phase of the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The phase to be added to the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront with updated phases.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Add this extra non check to allow PhaseOptics to have a None phase</span>
    <span class="c1"># and still be able to be &#39;added&#39; to it, making this the phase </span>
    <span class="c1"># equivilent of `wf += opd` -&gt; `wf = wf.add_phase(phase)`</span>
    <span class="k">if</span> <span class="n">phase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.crop_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">crop_to</span><span class="p">(</span><span class="n">npixels</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.crop_to" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Paraxially crops the <code>Wavefront</code> to the size determined by npixels.
Note this only supports padding arrays of even dimension to even
dimension, and odd dimension to to odd dimension, ie 4 -&gt; 2 or 5 -&gt; 3.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the array to crop to the wavefront to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new <code>Wavefront</code> cropped to the size npixels.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">crop_to</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">npixels</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Paraxially crops the `Wavefront` to the size determined by npixels.</span>
<span class="sd">    Note this only supports padding arrays of even dimension to even</span>
<span class="sd">    dimension, and odd dimension to to odd dimension, ie 4 -&gt; 2 or 5 -&gt; 3.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The size of the array to crop to the wavefront to.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` cropped to the size npixels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npixels_in</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>

    <span class="k">if</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="n">npixels</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only supports even -&gt; even or odd -&gt; odd input.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">npixels</span> <span class="o">&gt;</span> <span class="n">npixels_in</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;npixels must be smaller than the current array &quot;</span>
            <span class="s2">&quot;size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">))</span>

    <span class="n">new_centre</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">//</span> <span class="mi">2</span>
    <span class="n">centre</span> <span class="o">=</span> <span class="n">npixels</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="n">amplitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">[</span>
        <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">,</span>
        <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">]</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span>
        <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">,</span>
        <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">centre</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.flip" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flip</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.flip" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Flips the amplitude and phase of the wavefront along the specified axes.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>axis</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The axes along which to flip the wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new wavefront with the flipped amplitude and phase.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">axis</span> <span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Flips the amplitude and phase of the wavefront along the specified axes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : tuple</span>
<span class="sd">        The axes along which to flip the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront with the flipped amplitude and phase.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_field</span><span class="p">()</span>
    <span class="n">flipper</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="n">flipper</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.normalise" class="doc doc-heading">
<code class="highlight language-python"><span class="n">normalise</span><span class="p">()</span></code>

<a href="#dLux.wavefronts.Wavefront.normalise" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Normalises the total power of the wavefront to 1.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new wavefront with the normalised electric field amplitudes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalises the total power of the wavefront to 1.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront with the normalised electric field amplitudes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.pad_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pad_to</span><span class="p">(</span><span class="n">npixels</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.pad_to" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Paraxially zero-pads the <code>Wavefront</code> to the size determined by
npixels. Note this only supports padding arrays of even dimension
to even dimension, and odd dimension to to odd dimension, ie 2 -&gt; 4 or
3 -&gt; 5.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the array to pad to the wavefront to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new <code>Wavefront</code> zero-padded to the size npixels.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pad_to</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">npixels</span> <span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Paraxially zero-pads the `Wavefront` to the size determined by</span>
<span class="sd">    npixels. Note this only supports padding arrays of even dimension</span>
<span class="sd">    to even dimension, and odd dimension to to odd dimension, ie 2 -&gt; 4 or</span>
<span class="sd">    3 -&gt; 5.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The size of the array to pad to the wavefront to.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new `Wavefront` zero-padded to the size npixels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npixels_in</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>
    <span class="k">if</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="n">npixels</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only supports even -&gt; even or odd -&gt; odd input.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">npixels</span> <span class="o">&lt;</span> <span class="n">npixels_in</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;npixels must be larger than the current array &quot;</span>
            <span class="s2">&quot;size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">))</span>

    <span class="n">new_centre</span> <span class="o">=</span> <span class="n">npixels</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">centre</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">//</span> <span class="mi">2</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="n">npixels_in</span>  <span class="o">%</span> <span class="mi">2</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">])</span>

    <span class="n">amplitude</span> <span class="o">=</span> <span class="n">padded</span><span class="o">.</span><span class="n">at</span><span class="p">[</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span>
        <span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplitude</span><span class="p">)</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">padded</span><span class="o">.</span><span class="n">at</span><span class="p">[</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">,</span>
            <span class="n">new_centre</span> <span class="o">-</span> <span class="n">centre</span> <span class="p">:</span> <span class="n">centre</span> <span class="o">+</span> <span class="n">new_centre</span> <span class="o">+</span> <span class="n">remainder</span>
        <span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.rotate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rotate</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">complex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.rotate" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Performs a paraxial rotation on the wavefront, determined by the
the angle parameter, using interpolation. The transformation is done
on the amplitude and phase arrays, but can be done on the real and
imaginary components by passing <code>complex=True</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angle</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The angle by which to rotate the wavefront in a clockwise direction.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>order</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The interpolation order to use.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>complex</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to rotate the real and imaginary representation of the
wavefront as opposed to the the amplitude and phase representation.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new wavefront rotated by angle in the clockwise direction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span>    <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
           <span class="n">angle</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
           <span class="n">order</span>   <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
           <span class="nb">complex</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a paraxial rotation on the wavefront, determined by the</span>
<span class="sd">    the angle parameter, using interpolation. The transformation is done</span>
<span class="sd">    on the amplitude and phase arrays, but can be done on the real and</span>
<span class="sd">    imaginary components by passing `complex=True`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angle : Array, radians</span>
<span class="sd">        The angle by which to rotate the wavefront in a clockwise direction.</span>
<span class="sd">    order : int = 1</span>
<span class="sd">        The interpolation order to use.</span>
<span class="sd">    complex : bool = False</span>
<span class="sd">        Whether to rotate the real and imaginary representation of the</span>
<span class="sd">        wavefront as opposed to the the amplitude and phase representation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront rotated by angle in the clockwise direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get field in either (ampltide, phase) or (real, imaginary)</span>
    <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_field</span><span class="p">(</span><span class="nb">complex</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="c1"># Rotate the field</span>
    <span class="n">rotator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">dlu</span><span class="o">.</span><span class="n">rotate</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">rotator</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>

    <span class="c1"># Cast back to (amplitude, phase) if needed</span>
    <span class="k">if</span> <span class="nb">complex</span><span class="p">:</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_ampltide_phase</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

    <span class="c1"># Return new wavefront</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.scale_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scale_to</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="nb">complex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.scale_to" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Performs a paraxial interpolation on the wavefront, determined by the
the pixel_scale_out and npixels parameters. The transformation is done
on the amplitude and phase arrays, but can be done on the real and
imaginary components by passing <code>complex=True</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels representing the wavefront after the
interpolation.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale of the array after the interpolation.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>complex</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to rotate the real and imaginary representation of the
wavefront as opposed to the the amplitude and phase representation.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new wavefront interpolated to the size and shape determined by
npixels and pixel_scale_out, with the updated pixel_scale.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">scale_to</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">npixels</span>     <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">pixel_scale</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="nb">complex</span>     <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a paraxial interpolation on the wavefront, determined by the</span>
<span class="sd">    the pixel_scale_out and npixels parameters. The transformation is done</span>
<span class="sd">    on the amplitude and phase arrays, but can be done on the real and</span>
<span class="sd">    imaginary components by passing `complex=True`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels representing the wavefront after the</span>
<span class="sd">        interpolation.</span>
<span class="sd">    pixel_scale: Array</span>
<span class="sd">        The pixel scale of the array after the interpolation.</span>
<span class="sd">    complex : bool = False</span>
<span class="sd">        Whether to rotate the real and imaginary representation of the</span>
<span class="sd">        wavefront as opposed to the the amplitude and phase representation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The new wavefront interpolated to the size and shape determined by</span>
<span class="sd">        npixels and pixel_scale_out, with the updated pixel_scale.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get field in either (ampltide, phase) or (real, imaginary)</span>
    <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_field</span><span class="p">(</span><span class="nb">complex</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

    <span class="c1"># Scale the field</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">dlu</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span><span class="p">)</span>

    <span class="c1"># Cast back to (amplitude, phase) if needed</span>
    <span class="k">if</span> <span class="nb">complex</span><span class="p">:</span>
        <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_ampltide_phase</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

    <span class="c1"># Return new wavefront</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">field</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.shifted_IMFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shifted_IMFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pixel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.shifted_IMFT" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront by perfroming a, Inverse 2-sided Matrix Fourier
Transform with a shift in the center of the output plane.
TODO: Add link to Soumer et al. 2007(?), </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale of the output wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The shift in the center of the output plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal length of the propagation. If None, the propagation is
treated as an 'angular' propagation, else it is treated as a
'cartesian' propagation.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>pixel</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the shift is in pixels or the units of pixel_scale.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The propagated wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">shifted_IMFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
                <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">pixel</span>        <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront by perfroming a, Inverse 2-sided Matrix Fourier</span>
<span class="sd">    Transform with a shift in the center of the output plane.</span>
<span class="sd">    TODO: Add link to Soumer et al. 2007(?), </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output wavefront.</span>
<span class="sd">    pixel_scale : Array</span>
<span class="sd">        The pixel scale of the output wavefront.</span>
<span class="sd">    shift : Array</span>
<span class="sd">        The shift in the center of the output plane.</span>
<span class="sd">    focal_length : Array = None</span>
<span class="sd">        The focal length of the propagation. If None, the propagation is</span>
<span class="sd">        treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">        &#39;cartesian&#39; propagation.</span>
<span class="sd">    pixel : bool = True</span>
<span class="sd">        Whether the shift is in pixels or the units of pixel_scale.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The propagated wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate</span>
    <span class="n">plane</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT_output</span><span class="p">(</span><span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="k">if</span> <span class="n">pixel</span> <span class="k">else</span> <span class="n">shift</span> <span class="o">/</span> <span class="n">pixel_scale</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span>
        <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Return new wavefront</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.shifted_MFT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shifted_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pixel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.shifted_MFT" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront by perfroming a 2-sided Matrix Fourier
Transform with a shift in the center of the output plane.
TODO: Add link to Soumer et al. 2007(?), </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale of the output wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The shift in the center of the output plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal length of the propagation. If None, the propagation is
treated as an 'angular' propagation, else it is treated as a
'cartesian' propagation.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>pixel</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the shift is in pixels or the units of pixel_scale.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The propagated wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">shifted_MFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
                <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">pixel</span>        <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront by perfroming a 2-sided Matrix Fourier</span>
<span class="sd">    Transform with a shift in the center of the output plane.</span>
<span class="sd">    TODO: Add link to Soumer et al. 2007(?), </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output wavefront.</span>
<span class="sd">    pixel_scale : Array</span>
<span class="sd">        The pixel scale of the output wavefront.</span>
<span class="sd">    shift : Array</span>
<span class="sd">        The shift in the center of the output plane.</span>
<span class="sd">    focal_length : Array = None</span>
<span class="sd">        The focal length of the propagation. If None, the propagation is</span>
<span class="sd">        treated as an &#39;angular&#39; propagation, else it is treated as a</span>
<span class="sd">        &#39;cartesian&#39; propagation.</span>
<span class="sd">    pixel : bool = True</span>
<span class="sd">        Whether the shift is in pixels or the units of pixel_scale.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The propagated wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate</span>
    <span class="n">plane</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT_output</span><span class="p">(</span><span class="n">focal_length</span><span class="p">)</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="k">if</span> <span class="n">pixel</span> <span class="k">else</span> <span class="n">shift</span> <span class="o">/</span> <span class="n">pixel_scale</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>

    <span class="c1"># Return new wavefront</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="n">units</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.Wavefront.tilt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tilt</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.Wavefront.tilt" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Tilts the wavefront by the angles in the (x, y) by modifying the 
phase arrays.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angles</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) angles by which to tilt the wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The tilted wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tilt</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> <span class="n">angles</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tilts the wavefront by the angles in the (x, y) by modifying the </span>
<span class="sd">    phase arrays.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angles : Array, radians</span>
<span class="sd">        The (x, y) angles by which to tilt the wavefront.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The tilted wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="ow">or</span> <span class="n">angles</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;angles must be an array of shape (2,).&quot;</span><span class="p">)</span>
    <span class="n">opd</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">angles</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_opd</span><span class="p">(</span><span class="n">opd</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.wavefronts.Wavefront"><a class="headerlink" href="#dLux.wavefronts.Wavefront" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.coordinates"><a class="headerlink" href="#dLux.wavefronts.Wavefront.coordinates" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.diameter"><a class="headerlink" href="#dLux.wavefronts.Wavefront.diameter" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.fringe_size"><a class="headerlink" href="#dLux.wavefronts.Wavefront.fringe_size" title="Permanent link">¤</a></h2>
<h3 id="dLux.wavefronts.Wavefront.fringe_size--todo-units-check">TODO Units check<a class="headerlink" href="#dLux.wavefronts.Wavefront.fringe_size--todo-units-check" title="Permanent link">¤</a></h3>
<h3 id="dLux.wavefronts.Wavefront.fringe_size--todo-possibly-output-in-unit-based-on-units-attribute">TODO Possibly output in unit based on units attribute<a class="headerlink" href="#dLux.wavefronts.Wavefront.fringe_size--todo-possibly-output-in-unit-based-on-units-attribute" title="Permanent link">¤</a></h3>
<h3 id="dLux.wavefronts.Wavefront.fringe_size--todo-make-methods-use-this">TODO make methods use this<a class="headerlink" href="#dLux.wavefronts.Wavefront.fringe_size--todo-make-methods-use-this" title="Permanent link">¤</a></h3>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.imaginary"><a class="headerlink" href="#dLux.wavefronts.Wavefront.imaginary" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.npixels"><a class="headerlink" href="#dLux.wavefronts.Wavefront.npixels" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.phasor"><a class="headerlink" href="#dLux.wavefronts.Wavefront.phasor" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.psf"><a class="headerlink" href="#dLux.wavefronts.Wavefront.psf" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.real"><a class="headerlink" href="#dLux.wavefronts.Wavefront.real" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.wavefronts.Wavefront.wavenumber"><a class="headerlink" href="#dLux.wavefronts.Wavefront.wavenumber" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.FFT"><a class="headerlink" href="#dLux.wavefronts.Wavefront.FFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.IFFT"><a class="headerlink" href="#dLux.wavefronts.Wavefront.IFFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.IMFT"><a class="headerlink" href="#dLux.wavefronts.Wavefront.IMFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.MFT"><a class="headerlink" href="#dLux.wavefronts.Wavefront.MFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.__add__"><a class="headerlink" href="#dLux.wavefronts.Wavefront.__add__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.__iadd__"><a class="headerlink" href="#dLux.wavefronts.Wavefront.__iadd__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.__imul__"><a class="headerlink" href="#dLux.wavefronts.Wavefront.__imul__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.__init__"><a class="headerlink" href="#dLux.wavefronts.Wavefront.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.__mul__"><a class="headerlink" href="#dLux.wavefronts.Wavefront.__mul__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.add_opd"><a class="headerlink" href="#dLux.wavefronts.Wavefront.add_opd" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.add_phase"><a class="headerlink" href="#dLux.wavefronts.Wavefront.add_phase" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.crop_to"><a class="headerlink" href="#dLux.wavefronts.Wavefront.crop_to" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.flip"><a class="headerlink" href="#dLux.wavefronts.Wavefront.flip" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.normalise"><a class="headerlink" href="#dLux.wavefronts.Wavefront.normalise" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.pad_to"><a class="headerlink" href="#dLux.wavefronts.Wavefront.pad_to" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.rotate"><a class="headerlink" href="#dLux.wavefronts.Wavefront.rotate" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.scale_to"><a class="headerlink" href="#dLux.wavefronts.Wavefront.scale_to" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.shifted_IMFT"><a class="headerlink" href="#dLux.wavefronts.Wavefront.shifted_IMFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.shifted_MFT"><a class="headerlink" href="#dLux.wavefronts.Wavefront.shifted_MFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.Wavefront.tilt"><a class="headerlink" href="#dLux.wavefronts.Wavefront.tilt" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h1 id="operators">Operators<a class="headerlink" href="#operators" title="Permanent link">¤</a></h1>
<p>The wavefront classes contain a series of methods that allow for the manipulation and propagation of the wavefron. It also has a series of operators that allow for the manipulation of the wavefront via standard arithmetic operators, ie:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">dLux</span> <span class="k">as</span> <span class="nn">dl</span>

<span class="n">npixels</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">diameter</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># meters</span>
<span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="c1"># meters</span>

<span class="n">wf</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">Wavefront</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span>

<span class="c1"># Multiply to to modify the amplitude</span>
<span class="n">wf</span> <span class="o">*=</span> <span class="mf">0.5</span> <span class="c1"># Halves the amplitude</span>

<span class="c1"># Multiply by complex array to transform both ampltiude and phase</span>
<span class="n">wf</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)))</span>

<span class="c1"># Multiply or Add by OpticalLayer to apply it</span>
<span class="n">aperture</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">ApertureFactory</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="n">wf</span> <span class="o">*=</span> <span class="n">aperture</span>
<span class="n">wf</span> <span class="o">+=</span> <span class="n">aperture</span>

<span class="c1"># Add to modify the phase through OPD units</span>
<span class="n">wf</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># Adds 1m of OPD across full wavefront</span>
</code></pre></div>
<hr />
<h1 id="property-methods">Property Methods<a class="headerlink" href="#property-methods" title="Permanent link">¤</a></h1>
<p>It also has a series of property methods to help working with them:</p>
<p><code>diameter</code> Returns the current wavefront diameter calulated using the pixel scale
and number of pixels.</p>
<p><code>npixels</code> Returns the side length of the arrays currently representing the
wavefront. Taken from the last axis of the amplitude array.</p>
<p><code>real</code> Returns the real component of the <code>Wavefront</code>.</p>
<p><code>imaginary</code> Returns the imaginary component of the <code>Wavefront</code>.</p>
<p><code>phasor</code> The electric field phasor described by this Wavefront in complex form.</p>
<p><code>psf</code>Calculates the Point Spread Function (PSF), ie the squared modulus
of the complex wavefront.</p>
<p><code>coordinates</code> Returns the physical positions of the wavefront pixels in meters.</p>
<p><code>wavenumber</code> Returns the wavenumber of the wavefront (2 * pi / wavelength).</p>
<p><code>fringe_size</code> Returns the size of the fringes in angular units, ie lambda/D.</p>
<hr />
<h1 id="general-methods">General Methods<a class="headerlink" href="#general-methods" title="Permanent link">¤</a></h1>
<p>On top of these, it implements a number of methods that allow for the
manipulation of the image, these are:</p>
<p><code>add_opd(opd)</code> Applies the input array as an OPD to the Wavefront.</p>
<p><code>add_phase(phase)</code> Applies input array to the phase of the wavefront.</p>
<p><code>tilt(angles)</code> Tilts the wavefront by the angles in the (x, y) by modifying the phase arrays.</p>
<p><code>normalise()</code> Normalises the total power of the wavefront to 1.</p>
<p><code>flip(axis)</code> Flips the amplitude and phase of the wavefront along the specified axes.</p>
<p><code>scale_to(npixels, pixel_scale)</code> Performs a paraxial interpolation on the wavefront, determined by the the pixel_scale_out and npixels parameters.</p>
<p><code>rotate(angle)</code> Performs a paraxial rotation on the wavefront, determined by the the angle parameter, using interpolation.</p>
<p><code>pad_to(npixels)</code> Paraxially zero-pads the <code>Wavefront</code> to the size determined by npixels. Note this only supports padding arrays of even dimension to even dimension, and odd dimension to to odd dimension, ie 2 -&gt; 4 or 3 -&gt; 5.</p>
<p><code>crop_to(npixels)</code> Paraxially crops the <code>Wavefront</code> to the size determined by npixels. Note this only supports cropping arrays of even dimension to even dimension, and odd dimension to to odd dimension, ie 4 -&gt; 2 or 5 -&gt; 3.</p>
<hr />
<h1 id="propagator-methods">Propagator Methods<a class="headerlink" href="#propagator-methods" title="Permanent link">¤</a></h1>
<p>Wavefronts also have methods used to propagate them between planes. These
methods are:</p>
<p><code>FFT(pad, focal_length=None)</code> Performs a Fast Fourier Transform (FFT) on the wavefront, propagating from Pupil to Focal planes. If the focal_length is None, the output units will angular, otherwise cartesian.</p>
<p><code>IFFT(pad, focal_length=None)</code> Performs an Inverse Fast Fourier Transform (IFFT) on the wavefront, propagating from Focal to Pupil planes.</p>
<p><code>MFT(npixels, pixel_scale, focal_length=None)</code> Performs a Matrix Fourier Transform (MFT) on the wavefront, propagating from Pupil to Focal planes. If the focal_length is None, the pixel_scale is assumed to be in angular units (radians), otherwise it is assumed to be in cartesian units (meters).</p>
<p><code>IMFT(npixels, pixel_scale, focal_length=None)</code> Performs an Inverse Matrix Fourier Transform (IMFT) on the wavefront, propagating from Focal to Pupil planes.</p>
<p><code>shifted_MFT(npixels, pixel_scale, shift, focal_length=None, pixel=True)</code> Performs a Matrix Fourier Transform (MFT) on the wavefront, propagating from Pupil to Focal planes. If the focal_length is None, the pixel_scale is assumed to be in angular units (radians), otherwise it is assumed to be in cartesian units (meters). The shift parameter is used to shift the center of the output plane by 'shift', which is treated in units of pixels by default, otherwise it is treated in the units of the pixel_scale.</p>
<p><code>shifted_IMFT(npixels, pixel_scale, shift, focal_length=None, pixel=True)</code> Performs an Inverse Matrix Fourier Transform (IMFT) on the wavefront, propagating from Focal to Pupil planes. The shift parameter is used to shift the center of the output plane by 'shift', which is treated in units of pixels by default, otherwise it is treated in the units of the pixel_scale.</p>
<hr />
<h1 id="fresnel-wavefront">Fresnel Wavefront<a class="headerlink" href="#fresnel-wavefront" title="Permanent link">¤</a></h1>
<p>The FresnelWavefront class is a subclass of the Wavefront, implementing the methods required to perform a FarFieldFresnel propagation (ie, close to the focal plane). It implements two more methods that are essential extensions of the MFT methods. This class <em>only</em> implements cartesian propagation and only propagates from 'Pupil' to 'Focal' planes.</p>
<details class="info">
<summary>Fresnel Wavefront API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.wavefronts.FresnelWavefront"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code></p>

  
      <p>A class to represent a wavefront that can be propagated to a Far Field
Fresnel plane.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavelength of the <code>Wavefront</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The physical dimensions of each square pixel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>amplitude</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, power</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The electric field amplitude of the <code>Wavefront</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>phase</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The electric field phase of the <code>Wavefront</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>plane</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The current plane of wavefront, can be Pupil, Focal, or Intermediate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>units</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The units of the wavefront, can be 'Cartesian' or 'Angular'.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/wavefronts.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FresnelWavefront</span><span class="p">(</span><span class="n">Wavefront</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to represent a wavefront that can be propagated to a Far Field</span>
<span class="sd">    Fresnel plane.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel</span>
<span class="sd">        The physical dimensions of each square pixel.</span>
<span class="sd">    amplitude : Array, power</span>
<span class="sd">        The electric field amplitude of the `Wavefront`.</span>
<span class="sd">    phase : Array, radians</span>
<span class="sd">        The electric field phase of the `Wavefront`.</span>
<span class="sd">    plane : str</span>
<span class="sd">        The current plane of wavefront, can be Pupil, Focal, or Intermediate.</span>
<span class="sd">    units : str</span>
<span class="sd">        The units of the wavefront, can be &#39;Cartesian&#39; or &#39;Angular&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>       <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">npixels</span>    <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">diameter</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">wavelength</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels that represent the `Wavefront`.</span>
<span class="sd">        pixel_scale : float, meters/pixel</span>
<span class="sd">            The physical dimensions of each square pixel.</span>
<span class="sd">        wavelength : float, meters</span>
<span class="sd">            The wavelength of the `Wavefront`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">npixels</span>    <span class="o">=</span> <span class="n">npixels</span><span class="p">,</span>
            <span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span><span class="p">,</span>
            <span class="n">diameter</span>   <span class="o">=</span> <span class="n">diameter</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">_nfringes</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                  <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                  <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
                  <span class="n">focal_shift</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                  <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the number of fringes in the output plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels that represent the `Wavefront`.</span>
<span class="sd">        pixel_scale : Array, meters/pixel</span>
<span class="sd">            The physical dimensions of each square pixel.</span>
<span class="sd">        focal_shift : Array, meters</span>
<span class="sd">            The distance the focal plane is shifted from the focal length.</span>
<span class="sd">        focal_length : Array, meters</span>
<span class="sd">            The focal length of the lens.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        nfringes : Array</span>
<span class="sd">            The number of fringes in the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">propagation_distance</span> <span class="o">=</span> <span class="n">focal_length</span> <span class="o">+</span> <span class="n">focal_shift</span>
        <span class="n">output_size</span> <span class="o">=</span> <span class="n">npixels</span> <span class="o">*</span> <span class="n">pixel_scale</span>

        <span class="c1"># # Angular - Not Implemented</span>
        <span class="c1"># if focal_length is None:</span>
        <span class="c1">#     return output_size / self.fringe_size</span>

        <span class="c1"># Cartesian</span>
        <span class="k">return</span> <span class="n">output_size</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fringe_size</span> <span class="o">*</span> <span class="n">propagation_distance</span><span class="p">)</span>


    <span class="c1"># Move to utils as thinlens?</span>
    <span class="k">def</span> <span class="nf">quadratic_phase</span><span class="p">(</span><span class="bp">self</span>          <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                        <span class="n">x_coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                        <span class="n">y_coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                        <span class="n">distance</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A convinience function for calculating quadratic phase factors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x_coordinates : Array, meters</span>
<span class="sd">            The x coordinates of the pixels. This will be different</span>
<span class="sd">            in the plane of propagation and the initial plane.</span>
<span class="sd">        y_coordinates : Array, meters</span>
<span class="sd">            The y coordinates of the pixels. This will be different</span>
<span class="sd">            in the plane of propagation and the initial plane.</span>
<span class="sd">        distance : Array, meters</span>
<span class="sd">            The distance that is to be propagated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        quadratic_phase : Array</span>
<span class="sd">            A set of phase factors that are useful in optical calculations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r_coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span> <span class="n">y_coordinates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">r_coordinates</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">distance</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">transfer_function</span><span class="p">(</span><span class="bp">self</span>     <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                          <span class="n">distance</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Optical Transfer Function defining the phase evolution of the</span>
<span class="sd">        wavefront when propagating to a non-conjugate plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        distance : Array, meters</span>
<span class="sd">            The distance that is being propagated in meters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : Array</span>
<span class="sd">            The field that represents the optical transfer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">distance</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_transfer_matrix</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span> 
                         <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                         <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                         <span class="n">focal_shift</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                         <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                         <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the transfer matrix for the MFT.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels that represent the `Wavefront`.</span>
<span class="sd">        pixel_scale : Array, meters/pixel</span>
<span class="sd">            The physical dimensions of each square pixel.</span>
<span class="sd">        focal_shift : Array, meters</span>
<span class="sd">            The distance the focal plane is shifted from the focal length.</span>
<span class="sd">        focal_length : Array, meters</span>
<span class="sd">            The focal length of the lens.</span>
<span class="sd">        shift : Array = 0., meters</span>
<span class="sd">            The shift to apply to the output plane.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        transfer_matrix : Array</span>
<span class="sd">            The transfer matrix for the MFT.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scale_in</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span>
        <span class="n">scale_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nfringes</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">,</span> 
            <span class="n">focal_length</span><span class="p">)</span> <span class="o">/</span> <span class="n">npixels</span>
        <span class="n">in_vec</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">pixel_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span> <span class="n">scale_in</span><span class="p">,</span> <span class="n">shift</span> <span class="o">*</span> <span class="n">scale_in</span><span class="p">)</span>
        <span class="n">out_vec</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">pixel_coordinates</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">scale_out</span><span class="p">,</span> <span class="n">shift</span> <span class="o">*</span> <span class="n">scale_out</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">==</span> <span class="s1">&#39;Pupil&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">in_vec</span><span class="p">,</span> <span class="n">out_vec</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;plane must be &#39;Pupil&#39; Got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># elif self.plane == &#39;Focal&#39;:</span>
        <span class="c1">#     return np.exp(-2j * np.pi * np.outer(in_vec, out_vec))</span>


    <span class="k">def</span> <span class="nf">_MFT</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">phasor</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
             <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">focal_shift</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs the MFT.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        phasor : Array</span>
<span class="sd">            The phasor to be propagated.</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels that represent the `Wavefront`.</span>
<span class="sd">        pixel_scale : Array, meters/pixel</span>
<span class="sd">            The physical dimensions of each square pixel.</span>
<span class="sd">        focal_length : Array, meters</span>
<span class="sd">            The focal length of the lens.</span>
<span class="sd">        focal_shift : Array, meters</span>
<span class="sd">            The distance the focal plane is shifted from the focal length.</span>
<span class="sd">        shift : Array = np.zeros(2), meters</span>
<span class="sd">            The shift to apply to the output plane.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        phasor : Array</span>
<span class="sd">            The propagated phasor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set up</span>
        <span class="n">nfringes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nfringes</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">,</span> 
            <span class="n">focal_length</span><span class="p">)</span>
        <span class="n">x_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_matrix</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">,</span> 
            <span class="n">focal_length</span><span class="p">,</span> <span class="n">shift</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_matrix</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">,</span> 
            <span class="n">focal_length</span><span class="p">,</span> <span class="n">shift</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

        <span class="c1"># Perform and normalise</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_matrix</span> <span class="o">@</span> <span class="n">phasor</span><span class="p">)</span> <span class="o">@</span> <span class="n">x_matrix</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">nfringes</span><span class="p">)</span> <span class="o">-</span> \
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">npixels</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">phasor</span>


    <span class="k">def</span> <span class="nf">_phase_factors</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                       <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                       <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                       <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                       <span class="n">focal_shift</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the phase factors for the Fresnel propagation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale : Array, meters/pixel</span>
<span class="sd">            The physical dimensions of each square pixel.</span>
<span class="sd">        focal_length : Array, meters</span>
<span class="sd">            The focal length of the lens.</span>
<span class="sd">        focal_shift : Array, meters</span>
<span class="sd">            The distance the focal plane is shifted from the focal length.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        first_factor : Array</span>
<span class="sd">            The first factor in the Fresnel propagation.</span>
<span class="sd">        second_factor : Array</span>
<span class="sd">            The second factor in the Fresnel propagation.</span>
<span class="sd">        third_factor : Array</span>
<span class="sd">            The third factor in the Fresnel propagation.</span>
<span class="sd">        fourth_factor : Array</span>
<span class="sd">            The fourth factor in the Fresnel propagation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Coordinates</span>
        <span class="n">prop_dist</span> <span class="o">=</span> <span class="n">focal_length</span> <span class="o">+</span> <span class="n">focal_shift</span>
        <span class="n">input_positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span>
        <span class="n">output_positions</span> <span class="o">=</span> <span class="n">dlu</span><span class="o">.</span><span class="n">pixel_coords</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">)</span>

        <span class="c1"># Calculate phase values</span>
        <span class="n">first_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">input_positions</span><span class="p">,</span> <span class="o">-</span><span class="n">focal_length</span><span class="p">)</span>
        <span class="n">second_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">input_positions</span><span class="p">,</span> <span class="n">prop_dist</span><span class="p">)</span>
        <span class="n">third_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transfer_function</span><span class="p">(</span><span class="n">prop_dist</span><span class="p">)</span>
        <span class="n">fourth_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">output_positions</span><span class="p">,</span> <span class="n">prop_dist</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">first_factor</span><span class="p">,</span> <span class="n">second_factor</span><span class="p">,</span> <span class="n">third_factor</span><span class="p">,</span> <span class="n">fourth_factor</span>


    <span class="k">def</span> <span class="nf">fresnel_prop</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                     <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                     <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                     <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                     <span class="n">focal_shift</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront from the input plane to the output plane using</span>
<span class="sd">        a Fresnel Transform using a Matrix Fourier Transform.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale : Array, meters/pixel</span>
<span class="sd">            The physical dimensions of each square pixel.</span>
<span class="sd">        focal_length : Array, meters</span>
<span class="sd">            The focal length of the lens.</span>
<span class="sd">        focal_shift : Array, meters</span>
<span class="sd">            The distance the focal plane is shifted from the focal length.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The propagated wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate phase values</span>
        <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">third</span><span class="p">,</span> <span class="n">fourth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_factors</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> 
            <span class="n">focal_length</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">)</span>

        <span class="c1"># Apply phases</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phasor</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">first</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">second</span>

        <span class="c1"># Propagate</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">phasor</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> 
            <span class="n">focal_shift</span><span class="p">)</span>

        <span class="c1"># Apply phases</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">third</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">fourth</span>

        <span class="c1"># Update</span>
        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span> 
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="s1">&#39;Intermediate&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;Cartesian&#39;</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">shifted_fresnel_prop</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                             <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                             <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                             <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                             <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                             <span class="n">focal_shift</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                             <span class="n">pixel</span>        <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront from the input plane to the output plane using</span>
<span class="sd">        a Fresnel Transform using a Matrix Fourier Transform with a shift in</span>
<span class="sd">        the center of the output plane.</span>
<span class="sd">        TODO: Add link to Soumer et al. 2007(?), </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get shift</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="k">if</span> <span class="n">pixel</span> <span class="k">else</span> <span class="n">shift</span> <span class="o">/</span> <span class="n">pixel_scale</span>

        <span class="c1"># Calculate phase values</span>
        <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">third</span><span class="p">,</span> <span class="n">fourth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_factors</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> 
            <span class="n">focal_length</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">)</span>

        <span class="c1"># Apply phases</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phasor</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">first</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">second</span>

        <span class="c1"># Propagate</span>
        <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">phasor</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> 
            <span class="n">focal_shift</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>

        <span class="c1"># Apply phases</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">third</span>
        <span class="n">phasor</span> <span class="o">*=</span> <span class="n">fourth</span>

        <span class="c1"># Update</span>
        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span> 
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="s1">&#39;Intermediate&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;Cartesian&#39;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.FresnelWavefront.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.FresnelWavefront.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels that represent the <code>Wavefront</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The physical dimensions of each square pixel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavelength of the <code>Wavefront</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>       <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
             <span class="n">npixels</span>    <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">diameter</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">wavelength</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels that represent the `Wavefront`.</span>
<span class="sd">    pixel_scale : float, meters/pixel</span>
<span class="sd">        The physical dimensions of each square pixel.</span>
<span class="sd">    wavelength : float, meters</span>
<span class="sd">        The wavelength of the `Wavefront`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">npixels</span>    <span class="o">=</span> <span class="n">npixels</span><span class="p">,</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">wavelength</span><span class="p">,</span>
        <span class="n">diameter</span>   <span class="o">=</span> <span class="n">diameter</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.FresnelWavefront.fresnel_prop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fresnel_prop</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.FresnelWavefront.fresnel_prop" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront from the input plane to the output plane using
a Fresnel Transform using a Matrix Fourier Transform.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The physical dimensions of each square pixel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal length of the lens.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_shift</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The distance the focal plane is shifted from the focal length.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.wavefronts.Wavefront" href="#dLux.wavefronts.Wavefront">Wavefront</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The propagated wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fresnel_prop</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                 <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                 <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">focal_shift</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront from the input plane to the output plane using</span>
<span class="sd">    a Fresnel Transform using a Matrix Fourier Transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale : Array, meters/pixel</span>
<span class="sd">        The physical dimensions of each square pixel.</span>
<span class="sd">    focal_length : Array, meters</span>
<span class="sd">        The focal length of the lens.</span>
<span class="sd">    focal_shift : Array, meters</span>
<span class="sd">        The distance the focal plane is shifted from the focal length.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The propagated wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate phase values</span>
    <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">third</span><span class="p">,</span> <span class="n">fourth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_factors</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> 
        <span class="n">focal_length</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">)</span>

    <span class="c1"># Apply phases</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phasor</span>
    <span class="n">phasor</span> <span class="o">*=</span> <span class="n">first</span>
    <span class="n">phasor</span> <span class="o">*=</span> <span class="n">second</span>

    <span class="c1"># Propagate</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">phasor</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> 
        <span class="n">focal_shift</span><span class="p">)</span>

    <span class="c1"># Apply phases</span>
    <span class="n">phasor</span> <span class="o">*=</span> <span class="n">third</span>
    <span class="n">phasor</span> <span class="o">*=</span> <span class="n">fourth</span>

    <span class="c1"># Update</span>
    <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="s1">&#39;Intermediate&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Cartesian&#39;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.FresnelWavefront.quadratic_phase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">quadratic_phase</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span> <span class="n">y_coordinates</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.FresnelWavefront.quadratic_phase" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>A convinience function for calculating quadratic phase factors.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_coordinates</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The x coordinates of the pixels. This will be different
in the plane of propagation and the initial plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_coordinates</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The y coordinates of the pixels. This will be different
in the plane of propagation and the initial plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>distance</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The distance that is to be propagated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>quadratic_phase</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A set of phase factors that are useful in optical calculations.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">quadratic_phase</span><span class="p">(</span><span class="bp">self</span>          <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                    <span class="n">x_coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">y_coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">distance</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A convinience function for calculating quadratic phase factors.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_coordinates : Array, meters</span>
<span class="sd">        The x coordinates of the pixels. This will be different</span>
<span class="sd">        in the plane of propagation and the initial plane.</span>
<span class="sd">    y_coordinates : Array, meters</span>
<span class="sd">        The y coordinates of the pixels. This will be different</span>
<span class="sd">        in the plane of propagation and the initial plane.</span>
<span class="sd">    distance : Array, meters</span>
<span class="sd">        The distance that is to be propagated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    quadratic_phase : Array</span>
<span class="sd">        A set of phase factors that are useful in optical calculations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r_coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span> <span class="n">y_coordinates</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">r_coordinates</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">distance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.FresnelWavefront.shifted_fresnel_prop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shifted_fresnel_prop</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">,</span> <span class="n">pixel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.FresnelWavefront.shifted_fresnel_prop" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront from the input plane to the output plane using
a Fresnel Transform using a Matrix Fourier Transform with a shift in
the center of the output plane.
TODO: Add link to Soumer et al. 2007(?),</p>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">shifted_fresnel_prop</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                         <span class="n">npixels</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                         <span class="n">pixel_scale</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                         <span class="n">shift</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                         <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                         <span class="n">focal_shift</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                         <span class="n">pixel</span>        <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront from the input plane to the output plane using</span>
<span class="sd">    a Fresnel Transform using a Matrix Fourier Transform with a shift in</span>
<span class="sd">    the center of the output plane.</span>
<span class="sd">    TODO: Add link to Soumer et al. 2007(?), </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get shift</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="k">if</span> <span class="n">pixel</span> <span class="k">else</span> <span class="n">shift</span> <span class="o">/</span> <span class="n">pixel_scale</span>

    <span class="c1"># Calculate phase values</span>
    <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">third</span><span class="p">,</span> <span class="n">fourth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_factors</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> 
        <span class="n">focal_length</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">)</span>

    <span class="c1"># Apply phases</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phasor</span>
    <span class="n">phasor</span> <span class="o">*=</span> <span class="n">first</span>
    <span class="n">phasor</span> <span class="o">*=</span> <span class="n">second</span>

    <span class="c1"># Propagate</span>
    <span class="n">phasor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MFT</span><span class="p">(</span><span class="n">phasor</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> 
        <span class="n">focal_shift</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>

    <span class="c1"># Apply phases</span>
    <span class="n">phasor</span> <span class="o">*=</span> <span class="n">third</span>
    <span class="n">phasor</span> <span class="o">*=</span> <span class="n">fourth</span>

    <span class="c1"># Update</span>
    <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;pixel_scale&#39;</span><span class="p">,</span> <span class="s1">&#39;plane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">],</span> 
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">phasor</span><span class="p">),</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="s1">&#39;Intermediate&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Cartesian&#39;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.wavefronts.FresnelWavefront.transfer_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">transfer_function</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span></code>

<a href="#dLux.wavefronts.FresnelWavefront.transfer_function" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>The Optical Transfer Function defining the phase evolution of the
wavefront when propagating to a non-conjugate plane.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>distance</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, meters</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The distance that is being propagated in meters.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>field</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The field that represents the optical transfer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/wavefronts.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transfer_function</span><span class="p">(</span><span class="bp">self</span>     <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                      <span class="n">distance</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Optical Transfer Function defining the phase evolution of the</span>
<span class="sd">    wavefront when propagating to a non-conjugate plane.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    distance : Array, meters</span>
<span class="sd">        The distance that is being propagated in meters.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    field : Array</span>
<span class="sd">        The field that represents the optical transfer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">distance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.wavefronts.FresnelWavefront"><a class="headerlink" href="#dLux.wavefronts.FresnelWavefront" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.FresnelWavefront.__init__"><a class="headerlink" href="#dLux.wavefronts.FresnelWavefront.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.FresnelWavefront.fresnel_prop"><a class="headerlink" href="#dLux.wavefronts.FresnelWavefront.fresnel_prop" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.FresnelWavefront.quadratic_phase"><a class="headerlink" href="#dLux.wavefronts.FresnelWavefront.quadratic_phase" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.FresnelWavefront.shifted_fresnel_prop"><a class="headerlink" href="#dLux.wavefronts.FresnelWavefront.shifted_fresnel_prop" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.wavefronts.FresnelWavefront.transfer_function"><a class="headerlink" href="#dLux.wavefronts.FresnelWavefront.transfer_function" title="Permanent link">¤</a></h2>
</div>
</details>
<p><code>fresnel_prop(npixels, pixel_scale, focal_length, focal_shift)</code> Performs a Fresnel propagation on the wavefront, propagating from Pupil to Focal planes. The focal_shift parameter represents the distance from the focal plane at which the PSF is modelled.</p>
<p><code>shifted_fresnel_prop(npixels pixel_scale, shift, focal_length, focal_shift, pixel=True)</code> Performs a Fresnel propagation on the wavefront, propagating from Pupil to Focal planes. The focal_shift parameter represents the distance from the focal plane at which the PSF is modelled. The shift parameter is used to shift the center of the output plane by 'shift', which is treated in units of pixels by default, otherwise it is treated in the units of the pixel_scale.</p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>