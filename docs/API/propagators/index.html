
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for dLux.">
      
      
        <meta name="author" content="Louis Desdoigts">
      
      
        <link rel="canonical" href="https://louisdesdoigts.github.io/dlux/docs/API/propagators/">
      
      
        <link rel="prev" href="../optical_layers/">
      
      
        <link rel="next" href="../apertures/">
      
      <link rel="icon" href="../../../material/telescope">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.19">
    
    
      
        <title>Propagators - dLux</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#propagators-propagatorspy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dLux" class="md-header__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dLux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Propagators
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dLux" class="md-nav__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    dLux
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/phase_retrieval_demo/" class="md-nav__link">
        Phase Retrieval in ∂Lux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/designing_a_mask/" class="md-nav__link">
        Phase Mask Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/flatfield_calibration/" class="md-nav__link">
        Pixel Level Calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/fisher_information/" class="md-nav__link">
        Fisher Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/HMC/" class="md-nav__link">
        NumPyro and Hamiltonian Monte Carlo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          dLux API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          dLux API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wavefronts/" class="md-nav__link">
        Wavefronts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optical_layers/" class="md-nav__link">
        Optical Layers
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Propagators
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../apertures/" class="md-nav__link">
        Apertures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aberrations/" class="md-nav__link">
        Aberrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spectra/" class="md-nav__link">
        Spectra
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/" class="md-nav__link">
        Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../images/" class="md-nav__link">
        Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detector_layers/" class="md-nav__link">
        Detector Layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detectors/" class="md-nav__link">
        Detectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instruments/" class="md-nav__link">
        Instruments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observations/" class="md-nav__link">
        Observations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Utils API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Utils API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/math/" class="md-nav__link">
        Math
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/coordinates/" class="md-nav__link">
        Coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/helpers/" class="md-nav__link">
        Helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="propagators-propagatorspy">Propagators: <code>propagators.py</code><a class="headerlink" href="#propagators-propagatorspy" title="Permanent link">¤</a></h1>
<p>This module contains the classes that define the behaviour of propagator layers in ∂Lux.</p>
<p>These classes do not implement the propagation functionality themselves, but instead store the parameters of the propagation and call inbuilt methods of the <code>Wavefront</code> class; thus, its API is essentially a mirror of those methods.</p>
<p>There are four public classes:</p>
<ul>
<li><code>MFT</code></li>
<li><code>FFT</code></li>
<li><code>ShiftedMFT</code></li>
<li><code>FarFieldFresnel</code></li>
</ul>
<h3 id="mftnpixels-pixel_scale-focal_lengthnone-inversefalse"><code>MFT(npixels, pixel_scale, focal_length=None, inverse=False)</code><a class="headerlink" href="#mftnpixels-pixel_scale-focal_lengthnone-inversefalse" title="Permanent link">¤</a></h3>
<p>Performs a Matrix Fourier Transform (MFT) on the wavefront, propagating from Pupil to Focal plane. If <code>focal_length</code> is <code>None</code>, <code>pixel_scale</code> is assumed to be in angular units (radians), otherwise it is assumed to be in Cartesian units (metres).</p>
<details class="info">
<summary>MFT API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.MFT"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="dLux.propagators.Propagator">Propagator</span></code></p>

  
      <p>A Propagator class designed to propagate a wavefront to a plane that is
defined in Cartesian units (ie metres/pixel).</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output plane.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>(float, metres / pixel or radians / pixel)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale in the output plane, measured in metres per pixel.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>oversample</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of oversampling in the output plane.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code>(float, metres)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The effective focal length of the lens/mirror this propagator
represents. If None, the pixel_scale is taken to be in radians/pixel,
else it is taken to be in metres/pixel.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the propagation be performed in the inverse direction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>dLux/propagators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MFT</span><span class="p">(</span><span class="n">Propagator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Propagator class designed to propagate a wavefront to a plane that is</span>
<span class="sd">    defined in Cartesian units (ie metres/pixel).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale : float, metres/pixel or radians/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in metres per pixel.</span>
<span class="sd">    oversample : float</span>
<span class="sd">        The amount of oversampling in the output plane.</span>
<span class="sd">    focal_length : float, metres</span>
<span class="sd">        The effective focal length of the lens/mirror this propagator</span>
<span class="sd">        represents. If None, the pixel_scale is taken to be in radians/pixel,</span>
<span class="sd">        else it is taken to be in metres/pixel.</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Should the propagation be performed in the inverse direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">oversample</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">pixel_scale</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
        <span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">pixel_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">oversample</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">focal_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for VariableSampling propagators.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale : float, metres/pixel or radians/pixel</span>
<span class="sd">            The pixel scale in the output plane, measured in radians per pixel</span>
<span class="sd">            if focal_length is None, else metres per pixel.</span>
<span class="sd">        oversample : float = 1.</span>
<span class="sd">            The amount of oversampling in the output plane.</span>
<span class="sd">        focal_length : float = None, metres</span>
<span class="sd">            The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">            If None, the pixel_scale is taken to be in radians/pixel, else it</span>
<span class="sd">            is taken to be in metres/pixel.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Should the propagation be performed in the inverse direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">focal_length</span><span class="o">=</span><span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">oversample</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">npixels</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the layer to the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The transformed wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">IMFT</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
                <span class="n">focal_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">MFT</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
                <span class="n">focal_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.MFT.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.MFT.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the layer to the wavefront.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code><span title="dLux.propagators.Wavefront">Wavefront</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavefront to operate on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="dLux.propagators.Wavefront">Wavefront</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The transformed wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>dLux/propagators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the layer to the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The transformed wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">IMFT</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
            <span class="n">focal_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">MFT</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
            <span class="n">focal_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.MFT.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">oversample</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dLux.propagators.MFT.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for VariableSampling propagators.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>(float, metres / pixel or radians / pixel)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale in the output plane, measured in radians per pixel
if focal_length is None, else metres per pixel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>oversample</code></td>
          <td>
                <code>float = 1.</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of oversampling in the output plane.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code>float = None, metres</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal_length of the lens/mirror this propagator represents.
If None, the pixel_scale is taken to be in radians/pixel, else it
is taken to be in metres/pixel.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool = False</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the propagation be performed in the inverse direction.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>dLux/propagators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
    <span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">pixel_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">oversample</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">focal_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for VariableSampling propagators.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale : float, metres/pixel or radians/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in radians per pixel</span>
<span class="sd">        if focal_length is None, else metres per pixel.</span>
<span class="sd">    oversample : float = 1.</span>
<span class="sd">        The amount of oversampling in the output plane.</span>
<span class="sd">    focal_length : float = None, metres</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">        If None, the pixel_scale is taken to be in radians/pixel, else it</span>
<span class="sd">        is taken to be in metres/pixel.</span>
<span class="sd">    inverse : bool = False</span>
<span class="sd">        Should the propagation be performed in the inverse direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">focal_length</span><span class="o">=</span><span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">oversample</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pixel_scale</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">npixels</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.MFT"><a class="headerlink" href="#dLux.propagators.MFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.MFT.__call__"><a class="headerlink" href="#dLux.propagators.MFT.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.MFT.__init__"><a class="headerlink" href="#dLux.propagators.MFT.__init__" title="Permanent link">¤</a></h2>
</div>
</details>
<h3 id="fftpad-focal_lengthnone-inversefalse"><code>FFT(pad, focal_length=None, inverse=False)</code><a class="headerlink" href="#fftpad-focal_lengthnone-inversefalse" title="Permanent link">¤</a></h3>
<p>Performs a Fast Fourier Transform (FFT) on the wavefront, propagating from Pupil to Focal plane. If <code>focal_length</code> is <code>None</code>, the output units will angular (radians), otherwise cartesian (metres).</p>
<details class="info">
<summary>FFT API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.FFT"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="dLux.propagators.Propagator">Propagator</span></code></p>

  
      <p>A Propagator class designed to propagate a wavefront to a plane using a
Fast Fourier Transform.</p>
<h2 id="dLux.propagators.FFT--todo-update-padding-to-take-in-units-of-npixels-rather-than-factor">TODO: Update padding to take in units of npixels, rather than factor.<a class="headerlink" href="#dLux.propagators.FFT--todo-update-padding-to-take-in-units-of-npixels-rather-than-factor" title="Permanent link">¤</a></h2>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code>(float, metres)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal_length of the lens/mirror this propagator represents.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>pad</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of padding to apply to the wavefront before propagating.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the propagation be performed in the inverse direction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>dLux/propagators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FFT</span><span class="p">(</span><span class="n">Propagator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Propagator class designed to propagate a wavefront to a plane using a</span>
<span class="sd">    Fast Fourier Transform.</span>

<span class="sd">    # TODO: Update padding to take in units of npixels, rather than factor.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    focal_length : float, metres</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    pad : int</span>
<span class="sd">        The amount of padding to apply to the wavefront before propagating.</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Should the propagation be performed in the inverse direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pad</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
        <span class="n">focal_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">focal_length</span><span class="o">=</span><span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pad</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the layer to the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The transformed wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">IFFT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">FFT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.FFT.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.FFT.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the layer to the wavefront.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code><span title="dLux.propagators.Wavefront">Wavefront</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavefront to operate on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="dLux.propagators.Wavefront">Wavefront</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The transformed wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>dLux/propagators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the layer to the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The transformed wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">IFFT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">FFT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.FFT"><a class="headerlink" href="#dLux.propagators.FFT" title="Permanent link">¤</a></h2>
<h2 id="dLux.propagators.FFT--todo-update-padding-to-take-in-units-of-npixels-rather-than-factor">TODO: Update padding to take in units of npixels, rather than factor.<a class="headerlink" href="#dLux.propagators.FFT--todo-update-padding-to-take-in-units-of-npixels-rather-than-factor" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.FFT.__call__"><a class="headerlink" href="#dLux.propagators.FFT.__call__" title="Permanent link">¤</a></h2>
</div>
</details>
<h3 id="shiftedmftnpixels-pixel_scale-shift-focal_lengthnone-pixeltrue-inversefalse"><code>shiftedMFT(npixels, pixel_scale, shift, focal_length=None, pixel=True, inverse=False)</code><a class="headerlink" href="#shiftedmftnpixels-pixel_scale-shift-focal_lengthnone-pixeltrue-inversefalse" title="Permanent link">¤</a></h3>
<p>Performs a Matrix Fourier Transform (MFT) on the wavefront, propagating from Pupil to Focal plane. If <code>focal_length</code> is <code>None</code>, <code>pixel_scale</code> is assumed to be in angular units (radians), otherwise it is assumed to be in Cartesian units (metres). The <code>shift</code> parameter is used to shift the center of the output plane, which is treated in units of pixels by default, otherwise it is treated in the units of <code>pixel_scale</code>.</p>
<details class="info">
<summary>Shifted MFT API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.ShiftedMFT"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="dLux.propagators.MFT" href="#dLux.propagators.MFT">MFT</a></code></p>

  
      <p>A Propagator class designed to propagate a wavefront to a plane that is
defined in Cartesian units (ie metres/pixel), with a variable output
sampling in that plane.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output plane.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>(float, metres / <span title="dLux.propagators.ShiftedMFT.pixel">pixel</span> or radians / <span title="dLux.propagators.ShiftedMFT.pixel">pixel</span>)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale in the output plane, measured in metres per pixel.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>oversample</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of oversampling in the output plane.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code>(float, metres)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The effective focal length of the lens/mirror this propagator
represents. If None, the pixel_scale is taken to be in radians/pixel,
else it is taken to be in metres/pixel.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) shift to apply to the wavefront in the output plane.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>pixel</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True the shift value is assumed to be in units of pixels, else the
physical units of the output plane (ie radians if focal_length is None,
else metres).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the propagation be performed in the inverse direction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>dLux/propagators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ShiftedMFT</span><span class="p">(</span><span class="n">MFT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Propagator class designed to propagate a wavefront to a plane that is</span>
<span class="sd">    defined in Cartesian units (ie metres/pixel), with a variable output</span>
<span class="sd">    sampling in that plane.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale : float, metres/pixel or radians/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in metres per pixel.</span>
<span class="sd">    oversample : float</span>
<span class="sd">        The amount of oversampling in the output plane.</span>
<span class="sd">    focal_length : float, metres</span>
<span class="sd">        The effective focal length of the lens/mirror this propagator</span>
<span class="sd">        represents. If None, the pixel_scale is taken to be in radians/pixel,</span>
<span class="sd">        else it is taken to be in metres/pixel.</span>
<span class="sd">    shift : Array</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel : bool</span>
<span class="sd">        If True the shift value is assumed to be in units of pixels, else the</span>
<span class="sd">        physical units of the output plane (ie radians if focal_length is None,</span>
<span class="sd">        else metres).</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Should the propagation be performed in the inverse direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">shift</span><span class="p">:</span> <span class="n">Array</span>
    <span class="n">pixel</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
        <span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">pixel_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">shift</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">oversample</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">focal_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pixel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for VariableSampling propagators.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale : float, metres/pixel or radians/pixel</span>
<span class="sd">            The pixel scale in the output plane, measured in metres or radians</span>
<span class="sd">            per pixel for Cartesian or Angular Wavefront respectively.</span>
<span class="sd">        shift : Array</span>
<span class="sd">            The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">        oversample : float = 1.</span>
<span class="sd">            The amount of oversampling in the output plane.</span>
<span class="sd">        focal_length : float = None, metres</span>
<span class="sd">            The effective focal_length of the lens/mirror this propagator</span>
<span class="sd">            represents. If None, the pixel_scale is taken to be in</span>
<span class="sd">            radians/pixel, else it is taken to be in metres/pixel.</span>
<span class="sd">        pixel : bool = False</span>
<span class="sd">            If True the shift value is assumed to be in units of pixels, else</span>
<span class="sd">            the physical units of the output plane (ie radians if focal_length</span>
<span class="sd">            is None, else metres).</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Should the propagation be performed in the inverse direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">pixel_scale</span><span class="o">=</span><span class="n">pixel_scale</span><span class="p">,</span>
            <span class="n">npixels</span><span class="o">=</span><span class="n">npixels</span><span class="p">,</span>
            <span class="n">oversample</span><span class="o">=</span><span class="n">oversample</span><span class="p">,</span>
            <span class="n">focal_length</span><span class="o">=</span><span class="n">focal_length</span><span class="p">,</span>
            <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">shift</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pixel</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shift</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shift must be a 2D array, got </span><span class="si">{</span><span class="n">shift</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the layer to the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The transformed wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">shifted_IMFT</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pixel</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">shifted_MFT</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pixel</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.ShiftedMFT.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.ShiftedMFT.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the layer to the wavefront.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code><span title="dLux.propagators.Wavefront">Wavefront</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavefront to operate on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="dLux.propagators.Wavefront">Wavefront</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The transformed wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>dLux/propagators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the layer to the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The transformed wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">shifted_IMFT</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pixel</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">shifted_MFT</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pixel</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.ShiftedMFT.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span> <span class="n">oversample</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">focal_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pixel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dLux.propagators.ShiftedMFT.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for VariableSampling propagators.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>(float, metres / <span title="dLux.propagators.ShiftedMFT.pixel">pixel</span> or radians / <span title="dLux.propagators.ShiftedMFT.pixel">pixel</span>)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale in the output plane, measured in metres or radians
per pixel for Cartesian or Angular Wavefront respectively.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) shift to apply to the wavefront in the output plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>oversample</code></td>
          <td>
                <code>float = 1.</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of oversampling in the output plane.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code>float = None, metres</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The effective focal_length of the lens/mirror this propagator
represents. If None, the pixel_scale is taken to be in
radians/pixel, else it is taken to be in metres/pixel.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>pixel</code></td>
          <td>
                <code>bool = False</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True the shift value is assumed to be in units of pixels, else
the physical units of the output plane (ie radians if focal_length
is None, else metres).</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool = False</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the propagation be performed in the inverse direction.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>dLux/propagators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
    <span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">pixel_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">shift</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">oversample</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">focal_length</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pixel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for VariableSampling propagators.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale : float, metres/pixel or radians/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in metres or radians</span>
<span class="sd">        per pixel for Cartesian or Angular Wavefront respectively.</span>
<span class="sd">    shift : Array</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    oversample : float = 1.</span>
<span class="sd">        The amount of oversampling in the output plane.</span>
<span class="sd">    focal_length : float = None, metres</span>
<span class="sd">        The effective focal_length of the lens/mirror this propagator</span>
<span class="sd">        represents. If None, the pixel_scale is taken to be in</span>
<span class="sd">        radians/pixel, else it is taken to be in metres/pixel.</span>
<span class="sd">    pixel : bool = False</span>
<span class="sd">        If True the shift value is assumed to be in units of pixels, else</span>
<span class="sd">        the physical units of the output plane (ie radians if focal_length</span>
<span class="sd">        is None, else metres).</span>
<span class="sd">    inverse : bool = False</span>
<span class="sd">        Should the propagation be performed in the inverse direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">pixel_scale</span><span class="o">=</span><span class="n">pixel_scale</span><span class="p">,</span>
        <span class="n">npixels</span><span class="o">=</span><span class="n">npixels</span><span class="p">,</span>
        <span class="n">oversample</span><span class="o">=</span><span class="n">oversample</span><span class="p">,</span>
        <span class="n">focal_length</span><span class="o">=</span><span class="n">focal_length</span><span class="p">,</span>
        <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">shift</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pixel</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pixel</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">shift</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shift must be a 2D array, got </span><span class="si">{</span><span class="n">shift</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.ShiftedMFT"><a class="headerlink" href="#dLux.propagators.ShiftedMFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.ShiftedMFT.__call__"><a class="headerlink" href="#dLux.propagators.ShiftedMFT.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.ShiftedMFT.__init__"><a class="headerlink" href="#dLux.propagators.ShiftedMFT.__init__" title="Permanent link">¤</a></h2>
</div>
</details>
<h3 id="farfieldfresnelnpixels-pixel_scale-focal_length-focal_shift-shift-pixeltrue"><code>FarFieldFresnel(npixels, pixel_scale, focal_length, focal_shift, shift, pixel=True)</code><a class="headerlink" href="#farfieldfresnelnpixels-pixel_scale-focal_length-focal_shift-shift-pixeltrue" title="Permanent link">¤</a></h3>
<p>Performs a Fresnel propagation on the wavefront, propagating from Pupil to Focal plane. The <code>focal_shift</code> parameter represents the distance from the focal plane at which the PSF is modelled. The <code>shift</code> parameter is used to shift the center of the output plane, which is treated in units of pixels by default, otherwise it is treated in the units of <code>pixel_scale</code>.</p>
<details class="info">
<summary>Far Field Fresnel API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.FarFieldFresnel"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="dLux.propagators.ShiftedMFT" href="#dLux.propagators.ShiftedMFT">ShiftedMFT</a></code></p>

  
      <p>A propagator class to for Far-Field fresnel propagations. This classes
implements algorithms that use quadratic phase factors to better represent
out-of-plane behaviour of wavefronts, close to the focal plane. This class
is designed to work on Cartesian wavefronts, i.e. pixel units are in
metres/pixel in the output plane.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output plane.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>(float, metres / pixel)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale in the output plane, measured in metres per pixel.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code>(float, metres)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal_length of the lens/mirror this propagator represents.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>focal_shift</code></td>
          <td>
                <code>(float, metres)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The shift in the propagation distance of the wavefront.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>oversample</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of oversampling in the output plane.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) shift to apply to the wavefront in the output plane.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>pixel</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the shift value be considered in units of pixels, or in the
physical units of the output plane (ie pixels or metres, radians). True
interprets the shift value in pixel units.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the propagation be performed in the inverse direction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>dLux/propagators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FarFieldFresnel</span><span class="p">(</span><span class="n">ShiftedMFT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A propagator class to for Far-Field fresnel propagations. This classes</span>
<span class="sd">    implements algorithms that use quadratic phase factors to better represent</span>
<span class="sd">    out-of-plane behaviour of wavefronts, close to the focal plane. This class</span>
<span class="sd">    is designed to work on Cartesian wavefronts, i.e. pixel units are in</span>
<span class="sd">    metres/pixel in the output plane.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale : float, metres/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in metres per pixel.</span>
<span class="sd">    focal_length : float, metres</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    focal_shift : float, metres</span>
<span class="sd">        The shift in the propagation distance of the wavefront.</span>
<span class="sd">    oversample : float</span>
<span class="sd">        The amount of oversampling in the output plane.</span>
<span class="sd">    shift : Array</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel : bool</span>
<span class="sd">        Should the shift value be considered in units of pixels, or in the</span>
<span class="sd">        physical units of the output plane (ie pixels or metres, radians). True</span>
<span class="sd">        interprets the shift value in pixel units.</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Should the propagation be performed in the inverse direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">focal_shift</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
        <span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">pixel_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">focal_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">focal_shift</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">oversample</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">shift</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">pixel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the CartesianFresnel propagator</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale : float, metres/pixel</span>
<span class="sd">            The pixel scale in the output plane, measured in metres per pixel.</span>
<span class="sd">        focal_length : float, metres</span>
<span class="sd">            The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">        focal_shift : float, metres</span>
<span class="sd">            The shift in the propagation distance of the wavefront.</span>
<span class="sd">        oversample : float = 1.</span>
<span class="sd">            The amount of oversampling in the output plane.</span>
<span class="sd">        shift : Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">        pixel : bool = False</span>
<span class="sd">            Should the shift value be considered in units of pixel, or in the</span>
<span class="sd">            physical units of the output plane (ie pixels or metres, radians).</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Should the propagation be performed in the inverse direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inverse</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;Inverse propagation not implemented &quot;</span> <span class="s2">&quot;for CartesianFresnel.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">focal_shift</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">focal_shift</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
            <span class="n">pixel</span><span class="o">=</span><span class="n">pixel</span><span class="p">,</span>
            <span class="n">focal_length</span><span class="o">=</span><span class="n">focal_length</span><span class="p">,</span>
            <span class="n">pixel_scale</span><span class="o">=</span><span class="n">pixel_scale</span><span class="p">,</span>
            <span class="n">oversample</span><span class="o">=</span><span class="n">oversample</span><span class="p">,</span>
            <span class="n">npixels</span><span class="o">=</span><span class="n">npixels</span><span class="p">,</span>
            <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the layer to the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to operate on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The transformed wavefront.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">shifted_fresnel_prop</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">focal_shift</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pixel</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.FarFieldFresnel.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.FarFieldFresnel.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the layer to the wavefront.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code><span title="dLux.propagators.Wavefront">Wavefront</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The wavefront to operate on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="dLux.propagators.Wavefront">Wavefront</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The transformed wavefront.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>dLux/propagators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span><span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the layer to the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to operate on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The transformed wavefront.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">shifted_fresnel_prop</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npixels</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">oversample</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">focal_shift</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.FarFieldFresnel.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">pixel_scale</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">focal_shift</span><span class="p">,</span> <span class="n">oversample</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">pixel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dLux.propagators.FarFieldFresnel.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the CartesianFresnel propagator</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of pixels in the output plane.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale</code></td>
          <td>
                <code>(float, metres / pixel)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pixel scale in the output plane, measured in metres per pixel.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code>(float, metres)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The focal_length of the lens/mirror this propagator represents.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_shift</code></td>
          <td>
                <code>(float, metres)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The shift in the propagation distance of the wavefront.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>oversample</code></td>
          <td>
                <code>float = 1.</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of oversampling in the output plane.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code>Array = np.array([0., 0.])</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) shift to apply to the wavefront in the output plane.</p>
            </div>
          </td>
          <td>
                <code><span title="jax">np</span>.<span title="jax.zeros">zeros</span>(2)</code>
          </td>
        </tr>
        <tr>
          <td><code>pixel</code></td>
          <td>
                <code>bool = False</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the shift value be considered in units of pixel, or in the
physical units of the output plane (ie pixels or metres, radians).</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool = False</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Should the propagation be performed in the inverse direction.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>dLux/propagators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
    <span class="n">npixels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">pixel_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">focal_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">focal_shift</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">oversample</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">shift</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">pixel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the CartesianFresnel propagator</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale : float, metres/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in metres per pixel.</span>
<span class="sd">    focal_length : float, metres</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    focal_shift : float, metres</span>
<span class="sd">        The shift in the propagation distance of the wavefront.</span>
<span class="sd">    oversample : float = 1.</span>
<span class="sd">        The amount of oversampling in the output plane.</span>
<span class="sd">    shift : Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel : bool = False</span>
<span class="sd">        Should the shift value be considered in units of pixel, or in the</span>
<span class="sd">        physical units of the output plane (ie pixels or metres, radians).</span>
<span class="sd">    inverse : bool = False</span>
<span class="sd">        Should the propagation be performed in the inverse direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">inverse</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Inverse propagation not implemented &quot;</span> <span class="s2">&quot;for CartesianFresnel.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">focal_shift</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">focal_shift</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
        <span class="n">pixel</span><span class="o">=</span><span class="n">pixel</span><span class="p">,</span>
        <span class="n">focal_length</span><span class="o">=</span><span class="n">focal_length</span><span class="p">,</span>
        <span class="n">pixel_scale</span><span class="o">=</span><span class="n">pixel_scale</span><span class="p">,</span>
        <span class="n">oversample</span><span class="o">=</span><span class="n">oversample</span><span class="p">,</span>
        <span class="n">npixels</span><span class="o">=</span><span class="n">npixels</span><span class="p">,</span>
        <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.FarFieldFresnel"><a class="headerlink" href="#dLux.propagators.FarFieldFresnel" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.FarFieldFresnel.__call__"><a class="headerlink" href="#dLux.propagators.FarFieldFresnel.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.FarFieldFresnel.__init__"><a class="headerlink" href="#dLux.propagators.FarFieldFresnel.__init__" title="Permanent link">¤</a></h2>
</div>
</details>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>