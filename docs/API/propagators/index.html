
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for dLux.">
      
      
        <meta name="author" content="Louis Desdoigts">
      
      
        <link rel="canonical" href="https://louisdesdoigts.github.io/dlux/docs/API/propagators/">
      
      
        <link rel="prev" href="../aberrations/">
      
      
        <link rel="next" href="../wavefronts/">
      
      <link rel="icon" href="../../../material/telescope">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.6">
    
    
      
        <title>Propagators - dLux</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#propagators" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dLux" class="md-header__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dLux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Propagators
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dLux" class="md-nav__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    dLux
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../creating_a_layer/" class="md-nav__link">
        Creating a Layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/phase_retrieval_demo/" class="md-nav__link">
        Phase Retrieval in dLux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/designing_a_mask/" class="md-nav__link">
        Phase Mask Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/flatfield_calibration/" class="md-nav__link">
        Pixel Level Calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/fisher_information/" class="md-nav__link">
        Fisher Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/HMC/" class="md-nav__link">
        Numpyro and Hamiltonian Monte Carlo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          dLux API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          dLux API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../apertures/" class="md-nav__link">
        Apertures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aberrations/" class="md-nav__link">
        Aberrations
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Propagators
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wavefronts/" class="md-nav__link">
        Wavefronts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detectors/" class="md-nav__link">
        Detectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/" class="md-nav__link">
        Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spectrums/" class="md-nav__link">
        Spectrums
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observations/" class="md-nav__link">
        Observations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Utils API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Utils API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics_util/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../math.md" class="md-nav__link">
        Math
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coordinates/" class="md-nav__link">
        Coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bayes/" class="md-nav__link">
        Bayes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/" class="md-nav__link">
        Helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        Change Log
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="propagators">Propagators<a class="headerlink" href="#propagators" title="Permanent link">¤</a></h1>
<p>The propagators module contains all the optical layers that transform wavefront between pupil and focal planes. There are several different types of propagators that are combined. Angular and Cartesian propagators define their output units in either angular or cartesian coordinates. MFT and FFT based propagators have either a dynamic or fixed sampling in the output plane respectively. There is also a FarFieldFresnel propagator that is used to propagate near-to the focal plane.</p>
<p>This gives a total of 5 classes: <code>AngularMFT</code>, <code>AngularFFT</code>, <code>CartesianMFT</code>, <code>CartesianFFT</code> and <code>CartesianFresnel</code>. <code>AngularMFT</code> is the most commonly used propagator as it can easily model chromatic effects without interpolation and most optical systems are designed in angular coordinates.</p>
<p>All of the propagators have an <code>inverse</code> parameter that used to designate the type of propagation. If <code>inverse=False</code> then the propagation will from the pupil plane to the focal plane, and vice versa if <code>inverse=True</code>.</p>
<p>The MFT propagators all have an <code>npixels_out</code> and <code>pixel_scale_out</code> parameters that define the size and sampling of the output plane. They also have a <code>shift</code> and <code>pixel_shift</code> parameter which can be used to shift the output plane by a given amount. By default the shift values is in angular units, but if <code>shift_units='pixels'</code> then the shift will be in pixels. FFT propagators by their nature have a fixed sampling and output size, nor can they be shifted so these parameters are not used.</p>
<p>Cartesian propagators also have a <code>focal_length</code> parameter that is required to calculate the correct sampling in the output plane.</p>
<details class="info">
<summary>Angular MFT API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.AngularMFT"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.propagators.AngularPropagator">AngularPropagator</span></code>, <code><span title="dLux.propagators.VariableSamplingPropagator">VariableSamplingPropagator</span></code></p>

  
      <p>A Propagator class designed to propagate wavefronts, with pixel scale units
defined in meters per pixel in pupil planes and radians/pixel in focal
planes, with a variable output sampling in the output plane.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels in the output plane.</p></td>
        </tr>
        <tr>
          <td><code>pixel_scale_out</code></td>
          <td>
                <code>Array, meters/pixel or radians/pixel</code>
          </td>
          <td><p>The pixel scale in the output plane, measured in meters per pixel in
pupil plane and radians per pixel in focal planes.</p></td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations represents
propagation from a pupil to a focal plane, and inverse represents
propagation from a focal to a pupil plane.</p></td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The (x, y) shift to apply to the wavefront in the output plane.</p></td>
        </tr>
        <tr>
          <td><code>pixel_shift</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the shift value be considered in units of pixels, or in the
physical units of the output plane (ie pixels or meters, radians). True
interprets the shift value in pixel units.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name for this propagator.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/propagators.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AngularMFT</span><span class="p">(</span><span class="n">AngularPropagator</span><span class="p">,</span> <span class="n">VariableSamplingPropagator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Propagator class designed to propagate wavefronts, with pixel scale units</span>
<span class="sd">    defined in meters per pixel in pupil planes and radians/pixel in focal</span>
<span class="sd">    planes, with a variable output sampling in the output plane.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale_out : Array, meters/pixel or radians/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in meters per pixel in</span>
<span class="sd">        pupil plane and radians per pixel in focal planes.</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations represents</span>
<span class="sd">        propagation from a pupil to a focal plane, and inverse represents</span>
<span class="sd">        propagation from a focal to a pupil plane.</span>
<span class="sd">    shift : Array</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel_shift : bool</span>
<span class="sd">        Should the shift value be considered in units of pixels, or in the</span>
<span class="sd">        physical units of the output plane (ie pixels or meters, radians). True</span>
<span class="sd">        interprets the shift value in pixel units.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name for this propagator.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                 <span class="n">npixels_out</span>     <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">pixel_scale_out</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">inverse</span>         <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">shift</span>           <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">pixel_shift</span>     <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">name</span>            <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;AngularMFT&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels_out : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale_out : Array, radians/pixel, meters/pixel</span>
<span class="sd">            The pixel scale in the output plane, measured in meters per pixel in</span>
<span class="sd">            pupil planes and radians per pixel in focal planes.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">            represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">            represents propagation from a focal to a pupil plane.</span>
<span class="sd">        shift : Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">        pixel_shift : bool = False</span>
<span class="sd">            Should the shift value be considered in units of pixel, or in the</span>
<span class="sd">            physical units of the output plane (ie pixels or meters, radians).</span>
<span class="sd">        name : str = &#39;AngularMFT&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span>            <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                         <span class="n">inverse</span>         <span class="o">=</span> <span class="n">inverse</span><span class="p">,</span>
                         <span class="n">shift</span>           <span class="o">=</span> <span class="n">shift</span><span class="p">,</span>
                         <span class="n">pixel_shift</span>     <span class="o">=</span> <span class="n">pixel_shift</span><span class="p">,</span>
                         <span class="n">pixel_scale_out</span> <span class="o">=</span> <span class="n">pixel_scale_out</span><span class="p">,</span>
                         <span class="n">npixels_out</span>     <span class="o">=</span> <span class="n">npixels_out</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_nfringes</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                     <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The number of diffraction fringes in the output plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront being propagated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fringes : Array</span>
<span class="sd">            The number of diffraction fringes in the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fringe_size</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>
        <span class="n">detector_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span>
        <span class="k">return</span> <span class="n">detector_size</span> <span class="o">/</span> <span class="n">fringe_size</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>

        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                                        <span class="n">angular_units</span><span class="p">)</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span> \
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift</span>

        <span class="n">prop_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront to a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2"> pixels of &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;size </span><span class="si">{</span><span class="n">pixel_scale</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span>  <span class="s2">&quot;using a 2-sided MFT.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span><span class="p">:</span>
                <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> pixels in the (x, y) &quot;</span>
                                <span class="s2">&quot;dimension &quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2"> in the &quot;</span>
                                <span class="s2">&quot;(x, y) dimension &quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span> <span class="n">shift_string</span> <span class="o">+</span> <span class="s2">&quot;using a 2-sided MFT.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.AngularMFT.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels_out</span><span class="p">,</span> <span class="n">pixel_scale_out</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">pixel_shift</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;AngularMFT&#39;</span><span class="p">)</span></code>

<a href="#dLux.propagators.AngularMFT.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels in the output plane.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale_out</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, radians</code>
          </td>
          <td><p>The pixel scale in the output plane, measured in meters per pixel in
pupil planes and radians per pixel in focal planes.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations
represents propagation from a pupil to a focal plane, and inverse
represents propagation from a focal to a pupil plane.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The (x, y) shift to apply to the wavefront in the output plane.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>pixel_shift</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the shift value be considered in units of pixel, or in the
physical units of the output plane (ie pixels or meters, radians).</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;AngularMFT&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
             <span class="n">npixels_out</span>     <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">pixel_scale_out</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">inverse</span>         <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">shift</span>           <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">pixel_shift</span>     <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">name</span>            <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;AngularMFT&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale_out : Array, radians/pixel, meters/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in meters per pixel in</span>
<span class="sd">        pupil planes and radians per pixel in focal planes.</span>
<span class="sd">    inverse : bool = False</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">        represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">        represents propagation from a focal to a pupil plane.</span>
<span class="sd">    shift : Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel_shift : bool = False</span>
<span class="sd">        Should the shift value be considered in units of pixel, or in the</span>
<span class="sd">        physical units of the output plane (ie pixels or meters, radians).</span>
<span class="sd">    name : str = &#39;AngularMFT&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span>            <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                     <span class="n">inverse</span>         <span class="o">=</span> <span class="n">inverse</span><span class="p">,</span>
                     <span class="n">shift</span>           <span class="o">=</span> <span class="n">shift</span><span class="p">,</span>
                     <span class="n">pixel_shift</span>     <span class="o">=</span> <span class="n">pixel_shift</span><span class="p">,</span>
                     <span class="n">pixel_scale_out</span> <span class="o">=</span> <span class="n">pixel_scale_out</span><span class="p">,</span>
                     <span class="n">npixels_out</span>     <span class="o">=</span> <span class="n">npixels_out</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.AngularMFT.get_nfringes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_nfringes</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.AngularMFT.get_nfringes" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>The number of diffraction fringes in the output plane.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront being propagated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fringes</code></td>          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The number of diffraction fringes in the output plane.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_nfringes</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                 <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The number of diffraction fringes in the output plane.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront being propagated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fringes : Array</span>
<span class="sd">        The number of diffraction fringes in the output plane.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fringe_size</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>
    <span class="n">detector_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span>
    <span class="k">return</span> <span class="n">detector_size</span> <span class="o">/</span> <span class="n">fringe_size</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.AngularMFT.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.propagators.AngularMFT.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>

    <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                                    <span class="n">angular_units</span><span class="p">)</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span> \
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift</span>

    <span class="n">prop_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront to a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2"> pixels of &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;size </span><span class="si">{</span><span class="n">pixel_scale</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span>  <span class="s2">&quot;using a 2-sided MFT.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span><span class="p">:</span>
            <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> pixels in the (x, y) &quot;</span>
                            <span class="s2">&quot;dimension &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2"> in the &quot;</span>
                            <span class="s2">&quot;(x, y) dimension &quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span> <span class="n">shift_string</span> <span class="o">+</span> <span class="s2">&quot;using a 2-sided MFT.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.AngularMFT"><a class="headerlink" href="#dLux.propagators.AngularMFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.AngularMFT.__init__"><a class="headerlink" href="#dLux.propagators.AngularMFT.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.AngularMFT.get_nfringes"><a class="headerlink" href="#dLux.propagators.AngularMFT.get_nfringes" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.AngularMFT.summary"><a class="headerlink" href="#dLux.propagators.AngularMFT.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Angular FFT API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.AngularFFT"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.propagators.AngularPropagator">AngularPropagator</span></code>, <code><span title="dLux.propagators.FixedSamplingPropagator">FixedSamplingPropagator</span></code></p>

  
      <p>A Propagator class designed to propagate a wavefront to a plane using a
Fast Fourier Transfrom, with the pixel scale units defined in meters/pixel
in pupil planes and radians/pixel in focal planes.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations represents
propagation from a pupil to a focal plane, and inverse represents
propagation from a focal to a pupil plane.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name for this propagator.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/propagators.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AngularFFT</span><span class="p">(</span><span class="n">AngularPropagator</span><span class="p">,</span> <span class="n">FixedSamplingPropagator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Propagator class designed to propagate a wavefront to a plane using a</span>
<span class="sd">    Fast Fourier Transfrom, with the pixel scale units defined in meters/pixel</span>
<span class="sd">    in pupil planes and radians/pixel in focal planes.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations represents</span>
<span class="sd">        propagation from a pupil to a focal plane, and inverse represents</span>
<span class="sd">        propagation from a focal to a pupil plane.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name for this propagator.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>    <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                 <span class="n">inverse</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">name</span>    <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;AngularFFT&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the AngularFFT propagator.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">            represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">            represents propagation from a focal to a pupil plane.</span>
<span class="sd">        name : str = &#39;AngularFFT&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">inverse</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_pixel_scale_out</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the pixel scale in the output plane in units of radians per</span>
<span class="sd">        pixel.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront that is being propagated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pixel_scale_out : Array, radians/pixel</span>
<span class="sd">            The pixel scale in the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront to a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane using a FFT.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.AngularFFT.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;AngularFFT&#39;</span><span class="p">)</span></code>

<a href="#dLux.propagators.AngularFFT.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the AngularFFT propagator.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations
represents propagation from a pupil to a focal plane, and inverse
represents propagation from a focal to a pupil plane.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;AngularFFT&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>    <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
             <span class="n">inverse</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">name</span>    <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;AngularFFT&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the AngularFFT propagator.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inverse : bool = False</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">        represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">        represents propagation from a focal to a pupil plane.</span>
<span class="sd">    name : str = &#39;AngularFFT&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">inverse</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.AngularFFT.get_pixel_scale_out" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_pixel_scale_out</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.AngularFFT.get_pixel_scale_out" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculate the pixel scale in the output plane in units of radians per
pixel.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront that is being propagated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pixel_scale_out</code></td>          <td>
                <code><span title="dLux.propagators.Array">Array</span>, radians</code>
          </td>
          <td><p>The pixel scale in the output plane.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_pixel_scale_out</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the pixel scale in the output plane in units of radians per</span>
<span class="sd">    pixel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront that is being propagated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pixel_scale_out : Array, radians/pixel</span>
<span class="sd">        The pixel scale in the output plane.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.AngularFFT.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.propagators.AngularFFT.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront to a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane using a FFT.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.AngularFFT"><a class="headerlink" href="#dLux.propagators.AngularFFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.AngularFFT.__init__"><a class="headerlink" href="#dLux.propagators.AngularFFT.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.AngularFFT.get_pixel_scale_out"><a class="headerlink" href="#dLux.propagators.AngularFFT.get_pixel_scale_out" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.AngularFFT.summary"><a class="headerlink" href="#dLux.propagators.AngularFFT.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Cartesian MFT API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.CartesianMFT"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.propagators.CartesianPropagator">CartesianPropagator</span></code>, <code><span title="dLux.propagators.VariableSamplingPropagator">VariableSamplingPropagator</span></code></p>

  
      <p>A Propagator class designed to propagate a wavefront to a plane that is
defined in cartesian units (ie meters/pixel), with a variable output
sampling in that plane.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels in the output plane.</p></td>
        </tr>
        <tr>
          <td><code>pixel_scale_out</code></td>
          <td>
                <code>Array, meters/pixel</code>
          </td>
          <td><p>The pixel scale in the output plane, measured in meters per pixel.</p></td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The focal_length of the lens/mirror this propagator represents.</p></td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations represents
propagation from a pupil to a focal plane, and inverse represents
propagation from a focal to a pupil plane.</p></td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The (x, y) shift to apply to the wavefront in the output plane.</p></td>
        </tr>
        <tr>
          <td><code>pixel_shift</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the shift value be considered in units of pixels, or in the
physical units of the output plane (ie pixels or meters, radians). True
interprets the shift value in pixel units.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name for this propagator.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/propagators.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CartesianMFT</span><span class="p">(</span><span class="n">CartesianPropagator</span><span class="p">,</span> <span class="n">VariableSamplingPropagator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Propagator class designed to propagate a wavefront to a plane that is</span>
<span class="sd">    defined in cartesian units (ie meters/pixel), with a variable output</span>
<span class="sd">    sampling in that plane.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale_out : Array, meters/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in meters per pixel.</span>
<span class="sd">    focal_length : Array, meters</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations represents</span>
<span class="sd">        propagation from a pupil to a focal plane, and inverse represents</span>
<span class="sd">        propagation from a focal to a pupil plane.</span>
<span class="sd">    shift : Array</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel_shift : bool</span>
<span class="sd">        Should the shift value be considered in units of pixels, or in the</span>
<span class="sd">        physical units of the output plane (ie pixels or meters, radians). True</span>
<span class="sd">        interprets the shift value in pixel units.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name for this propagator.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                 <span class="n">npixels_out</span>     <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">pixel_scale_out</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">focal_length</span>    <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">inverse</span>         <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">shift</span>           <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">pixel_shift</span>     <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">name</span>            <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;CartesianMFT&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels_out : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        pixel_scale_out : Array, meters/pixel</span>
<span class="sd">            The pixel scale in the output plane, measured in meters per pixel.</span>
<span class="sd">        focal_length : Array, meters</span>
<span class="sd">            The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">            represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">            represents propagation from a focal to a pupil plane.</span>
<span class="sd">        shift : Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">        pixel_shift : bool = False</span>
<span class="sd">            Should the shift value be considered in units of pixel, or in the</span>
<span class="sd">            physical units of the output plane (ie pixels or meters, radians).</span>
<span class="sd">        name : str = &#39;CartesianMFT&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span>            <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                         <span class="n">inverse</span>         <span class="o">=</span> <span class="n">inverse</span><span class="p">,</span>
                         <span class="n">shift</span>           <span class="o">=</span> <span class="n">shift</span><span class="p">,</span>
                         <span class="n">pixel_shift</span>     <span class="o">=</span> <span class="n">pixel_shift</span><span class="p">,</span>
                         <span class="n">focal_length</span>    <span class="o">=</span> <span class="n">focal_length</span><span class="p">,</span>
                         <span class="n">pixel_scale_out</span> <span class="o">=</span> <span class="n">pixel_scale_out</span><span class="p">,</span>
                         <span class="n">npixels_out</span>     <span class="o">=</span> <span class="n">npixels_out</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_nfringes</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                     <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The number of diffraction fringes in the output plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront being propagated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fringes : Array</span>
<span class="sd">            The number of diffraction fringes in the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size_in</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>
        <span class="n">size_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span>
        <span class="k">return</span> <span class="n">size_in</span> <span class="o">*</span> <span class="n">size_out</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>

        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                        <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">focal_length</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                        <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span> \
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift</span>

        <span class="n">prop_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront </span><span class="si">{</span><span class="n">focal_length</span><span class="si">}</span><span class="s2"> &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> to a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2"> pixels of &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;size </span><span class="si">{</span><span class="n">pixel_scale</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span>  <span class="s2">&quot;using a 2-sided MFT.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span><span class="p">:</span>
                <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> pixels in the (x, y) &quot;</span>
                                <span class="s2">&quot;dimension &quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> in the &quot;</span>
                                <span class="s2">&quot;(x, y) dimension &quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span> <span class="n">shift_string</span> <span class="o">+</span> <span class="s2">&quot;using a 2-sided MFT.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianMFT.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels_out</span><span class="p">,</span> <span class="n">pixel_scale_out</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">pixel_shift</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CartesianMFT&#39;</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianMFT.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels in the output plane.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pixel_scale_out</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The pixel scale in the output plane, measured in meters per pixel.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The focal_length of the lens/mirror this propagator represents.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations
represents propagation from a pupil to a focal plane, and inverse
represents propagation from a focal to a pupil plane.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The (x, y) shift to apply to the wavefront in the output plane.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>pixel_shift</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the shift value be considered in units of pixel, or in the
physical units of the output plane (ie pixels or meters, radians).</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;CartesianMFT&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
             <span class="n">npixels_out</span>     <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">pixel_scale_out</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">focal_length</span>    <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">inverse</span>         <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">shift</span>           <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">pixel_shift</span>     <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">name</span>            <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;CartesianMFT&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale_out : Array, meters/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in meters per pixel.</span>
<span class="sd">    focal_length : Array, meters</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    inverse : bool = False</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">        represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">        represents propagation from a focal to a pupil plane.</span>
<span class="sd">    shift : Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel_shift : bool = False</span>
<span class="sd">        Should the shift value be considered in units of pixel, or in the</span>
<span class="sd">        physical units of the output plane (ie pixels or meters, radians).</span>
<span class="sd">    name : str = &#39;CartesianMFT&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span>            <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                     <span class="n">inverse</span>         <span class="o">=</span> <span class="n">inverse</span><span class="p">,</span>
                     <span class="n">shift</span>           <span class="o">=</span> <span class="n">shift</span><span class="p">,</span>
                     <span class="n">pixel_shift</span>     <span class="o">=</span> <span class="n">pixel_shift</span><span class="p">,</span>
                     <span class="n">focal_length</span>    <span class="o">=</span> <span class="n">focal_length</span><span class="p">,</span>
                     <span class="n">pixel_scale_out</span> <span class="o">=</span> <span class="n">pixel_scale_out</span><span class="p">,</span>
                     <span class="n">npixels_out</span>     <span class="o">=</span> <span class="n">npixels_out</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianMFT.get_nfringes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_nfringes</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianMFT.get_nfringes" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>The number of diffraction fringes in the output plane.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront being propagated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fringes</code></td>          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The number of diffraction fringes in the output plane.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_nfringes</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                 <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The number of diffraction fringes in the output plane.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront being propagated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fringes : Array</span>
<span class="sd">        The number of diffraction fringes in the output plane.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">size_in</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>
    <span class="n">size_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span>
    <span class="k">return</span> <span class="n">size_in</span> <span class="o">*</span> <span class="n">size_out</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianMFT.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianMFT.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>

    <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                    <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">focal_length</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                    <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span> \
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift</span>

    <span class="n">prop_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront </span><span class="si">{</span><span class="n">focal_length</span><span class="si">}</span><span class="s2"> &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> to a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2"> pixels of &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;size </span><span class="si">{</span><span class="n">pixel_scale</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span>  <span class="s2">&quot;using a 2-sided MFT.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span><span class="p">:</span>
            <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> pixels in the (x, y) &quot;</span>
                            <span class="s2">&quot;dimension &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> in the &quot;</span>
                            <span class="s2">&quot;(x, y) dimension &quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span> <span class="n">shift_string</span> <span class="o">+</span> <span class="s2">&quot;using a 2-sided MFT.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.CartesianMFT"><a class="headerlink" href="#dLux.propagators.CartesianMFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianMFT.__init__"><a class="headerlink" href="#dLux.propagators.CartesianMFT.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianMFT.get_nfringes"><a class="headerlink" href="#dLux.propagators.CartesianMFT.get_nfringes" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianMFT.summary"><a class="headerlink" href="#dLux.propagators.CartesianMFT.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Cartesian FFT API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.CartesianFFT"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.propagators.CartesianPropagator">CartesianPropagator</span></code>, <code><span title="dLux.propagators.FixedSamplingPropagator">FixedSamplingPropagator</span></code></p>

  
      <p>A Propagator class designed to propagate a wavefront to a plane using a
Fast Fourier Transfrom, with the pixel scale units defined in meters/pixel.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The focal_length of the lens/mirror this propagator represents.</p></td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations represents
propagation from a pupil to a focal plane, and inverse represents
propagation from a focal to a pupil plane.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name for this propagator.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/propagators.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CartesianFFT</span><span class="p">(</span><span class="n">CartesianPropagator</span><span class="p">,</span> <span class="n">FixedSamplingPropagator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Propagator class designed to propagate a wavefront to a plane using a</span>
<span class="sd">    Fast Fourier Transfrom, with the pixel scale units defined in meters/pixel.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    focal_length : Array, meters</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations represents</span>
<span class="sd">        propagation from a pupil to a focal plane, and inverse represents</span>
<span class="sd">        propagation from a focal to a pupil plane.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name for this propagator.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                 <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">inverse</span>      <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span>  <span class="o">=</span> <span class="s1">&#39;CartesianFFT&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        focal_length : Array, meters</span>
<span class="sd">            The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">            represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">            represents propagation from a focal to a pupil plane.</span>
<span class="sd">        name : str = &#39;CartesianFFT&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span>         <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                         <span class="n">inverse</span>      <span class="o">=</span> <span class="n">inverse</span><span class="p">,</span>
                         <span class="n">focal_length</span> <span class="o">=</span> <span class="n">focal_length</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_pixel_scale_out</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The pixel scale in the output plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The `Wavefront` that is being propagted.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pixel_scale_out : Array, meters/pixel</span>
<span class="sd">            The pixel scale in the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span> <span class="o">*</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>
        <span class="n">focal_length</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                        <span class="n">cartesian_units</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront </span><span class="si">{</span><span class="n">focal_length</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> to &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane using a FFT.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFFT.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">focal_length</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CartesianFFT&#39;</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFFT.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The focal_length of the lens/mirror this propagator represents.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations
represents propagation from a pupil to a focal plane, and inverse
represents propagation from a focal to a pupil plane.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;CartesianFFT&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
             <span class="n">focal_length</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">inverse</span>      <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span>  <span class="o">=</span> <span class="s1">&#39;CartesianFFT&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    focal_length : Array, meters</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    inverse : bool = False</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">        represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">        represents propagation from a focal to a pupil plane.</span>
<span class="sd">    name : str = &#39;CartesianFFT&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span>         <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                     <span class="n">inverse</span>      <span class="o">=</span> <span class="n">inverse</span><span class="p">,</span>
                     <span class="n">focal_length</span> <span class="o">=</span> <span class="n">focal_length</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFFT.get_pixel_scale_out" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_pixel_scale_out</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFFT.get_pixel_scale_out" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>The pixel scale in the output plane.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The <code>Wavefront</code> that is being propagted.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pixel_scale_out</code></td>          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The pixel scale in the output plane.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_pixel_scale_out</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The pixel scale in the output plane.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The `Wavefront` that is being propagted.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pixel_scale_out : Array, meters/pixel</span>
<span class="sd">        The pixel scale in the output plane.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span> <span class="o">*</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFFT.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFFT.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>
    <span class="n">focal_length</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                    <span class="n">cartesian_units</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront </span><span class="si">{</span><span class="n">focal_length</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> to &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane using a FFT.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.CartesianFFT"><a class="headerlink" href="#dLux.propagators.CartesianFFT" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFFT.__init__"><a class="headerlink" href="#dLux.propagators.CartesianFFT.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFFT.get_pixel_scale_out"><a class="headerlink" href="#dLux.propagators.CartesianFFT.get_pixel_scale_out" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFFT.summary"><a class="headerlink" href="#dLux.propagators.CartesianFFT.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Cartesian Fresnel API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.propagators.CartesianFresnel"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.propagators.FarFieldFresnel">FarFieldFresnel</span></code>, <code><a class="autorefs autorefs-internal" title="dLux.propagators.CartesianMFT" href="#dLux.propagators.CartesianMFT">CartesianMFT</a></code></p>

  
      <p>A propagator class to for Far-Field fresnel propagations. This classes
implements algorithms that use quadratic phase factors to better represent
out-of-plane behaviour of wavefronts, close to the focal plane. This class
is designed to work on Cartesian wavefronts, ie pixel units are in
meters/pixel in the output plane.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels in the output plane.</p></td>
        </tr>
        <tr>
          <td><code>pixel_scale_out</code></td>
          <td>
                <code>Array, meters/pixel</code>
          </td>
          <td><p>The pixel scale in the output plane, measured in meters per pixel.</p></td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The focal_length of the lens/mirror this propagator represents.</p></td>
        </tr>
        <tr>
          <td><code>propagation_shift</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The shift in the propagation distance of the wavefront.</p></td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations represents
propagation from a pupil to a focal plane, and inverse represents
propagation from a focal to a pupil plane.</p></td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The (x, y) shift to apply to the wavefront in the output plane.</p></td>
        </tr>
        <tr>
          <td><code>pixel_shift</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the shift value be considered in units of pixels, or in the
physical units of the output plane (ie pixels or meters, radians). True
interprets the shift value in pixel units.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name for this propagator.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/propagators.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CartesianFresnel</span><span class="p">(</span><span class="n">FarFieldFresnel</span><span class="p">,</span> <span class="n">CartesianMFT</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A propagator class to for Far-Field fresnel propagations. This classes</span>
<span class="sd">    implements algorithms that use quadratic phase factors to better represent</span>
<span class="sd">    out-of-plane behaviour of wavefronts, close to the focal plane. This class</span>
<span class="sd">    is designed to work on Cartesian wavefronts, ie pixel units are in</span>
<span class="sd">    meters/pixel in the output plane.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    pixel_scale_out : Array, meters/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in meters per pixel.</span>
<span class="sd">    focal_length : Array, meters</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    propagation_shift : Array, meters</span>
<span class="sd">        The shift in the propagation distance of the wavefront.</span>
<span class="sd">    inverse : bool</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations represents</span>
<span class="sd">        propagation from a pupil to a focal plane, and inverse represents</span>
<span class="sd">        propagation from a focal to a pupil plane.</span>
<span class="sd">    shift : Array</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel_shift : bool</span>
<span class="sd">        Should the shift value be considered in units of pixels, or in the</span>
<span class="sd">        physical units of the output plane (ie pixels or meters, radians). True</span>
<span class="sd">        interprets the shift value in pixel units.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name for this propagator.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>              <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                 <span class="n">npixels_out</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">pixel_scale_out</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">focal_length</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">propagation_shift</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">inverse</span>           <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">shift</span>             <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">pixel_shift</span>       <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">name</span>              <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;CartesianFresnel&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the CartesianFresnel propagator</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pixel_scale_out : Array, meters/pixel</span>
<span class="sd">            The pixel scale in the output plane, measured in meters per pixel.</span>
<span class="sd">        npixels_out : int</span>
<span class="sd">            The number of pixels in the output plane.</span>
<span class="sd">        focal_length : Array, meters</span>
<span class="sd">            The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">        propagation_shift : Array, meters</span>
<span class="sd">            The shift in the propagation distance of the wavefront.</span>
<span class="sd">        inverse : bool = False</span>
<span class="sd">            Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">            represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">            represents propagation from a focal to a pupil plane.</span>
<span class="sd">        shift : Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">        pixel_shift : bool = False</span>
<span class="sd">            Should the shift value be considered in units of pixel, or in the</span>
<span class="sd">            physical units of the output plane (ie pixels or meters, radians).</span>
<span class="sd">        name : str = &#39;CartesianFresnel&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span>               <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                         <span class="n">inverse</span>            <span class="o">=</span> <span class="n">inverse</span><span class="p">,</span>
                         <span class="n">shift</span>              <span class="o">=</span> <span class="n">shift</span><span class="p">,</span>
                         <span class="n">pixel_shift</span>        <span class="o">=</span> <span class="n">pixel_shift</span><span class="p">,</span>
                         <span class="n">focal_length</span>       <span class="o">=</span> <span class="n">focal_length</span><span class="p">,</span>
                         <span class="n">pixel_scale_out</span>    <span class="o">=</span> <span class="n">pixel_scale_out</span><span class="p">,</span>
                         <span class="n">npixels_out</span>        <span class="o">=</span> <span class="n">npixels_out</span><span class="p">,</span>
                         <span class="n">propagation_shift</span>  <span class="o">=</span> <span class="n">propagation_shift</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_nfringes</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                     <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The number of diffraction fringes in the output plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront being propagated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fringes : Array</span>
<span class="sd">            The number of diffraction fringes in the output plane.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">propagation_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">propagation_shift</span>
        <span class="n">size_in</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>
        <span class="n">size_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span>
        <span class="k">return</span> <span class="n">size_in</span> <span class="o">*</span> <span class="n">size_out</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="n">propagation_distance</span>


    <span class="k">def</span> <span class="nf">quadratic_phase</span><span class="p">(</span><span class="bp">self</span>          <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                        <span class="n">x_coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                        <span class="n">y_coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                        <span class="n">wavelength</span>    <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                        <span class="n">distance</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A convinience function for calculating quadratic phase factors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x_coordinates : Array</span>
<span class="sd">            The x coordinates of the pixels in meters. This will be different</span>
<span class="sd">            in the plane of propagation and the initial plane.</span>
<span class="sd">        y_coordinates : Array</span>
<span class="sd">            The y coordinates of the pixels in meters. This will be different</span>
<span class="sd">            in the plane of propagation and the initial plane.</span>
<span class="sd">        wavelength : Array, meters</span>
<span class="sd">            The wavelength of the wavefront.</span>
<span class="sd">        distance : Array, meters</span>
<span class="sd">            The distance that is to be propagated in meters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        quadratic_phase : Array</span>
<span class="sd">            A set of phase factors that are useful in optical calculations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavenumber</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">wavelength</span>
        <span class="n">radial_coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span> <span class="n">y_coordinates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="n">j</span> <span class="o">*</span> <span class="n">wavenumber</span> <span class="o">*</span> <span class="n">radial_coordinates</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">distance</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">transfer_function</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                          <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                          <span class="n">distance</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Optical Transfer Function defining the phase evolution of the</span>
<span class="sd">        wavefront when propagating to a non-conjugate plane.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to propagate.</span>
<span class="sd">        distance : Array, meters</span>
<span class="sd">            The distance that is being propagated in meters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : Array</span>
<span class="sd">            The field that represents the optical transfer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">distance</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">propagate</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Propagates the wavefront from the input plane to the output plane using</span>
<span class="sd">        a Matrix Fourier Transform.</span>

<span class="sd">        TODO: Set plane type to intermediate</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront : Wavefront</span>
<span class="sd">            The wavefront to propagate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        field : Array</span>
<span class="sd">            The normalised electric field phasor after the propagation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># See gihub issue #52</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_shift</span><span class="p">()</span>

        <span class="n">input_positions</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">pixel_coordinates</span>
        <span class="n">output_positions</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span>
                            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="p">),</span> 
                            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">))</span>

        <span class="n">propagation_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">propagation_shift</span>

        <span class="n">field</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phasor</span>
        <span class="n">field</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">input_positions</span><span class="p">,</span>
            <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">)</span>
        <span class="n">field</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">input_positions</span><span class="p">,</span>
            <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">propagation_distance</span><span class="p">)</span>
        <span class="n">wavefront</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">field</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>

        <span class="n">field</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span>
        <span class="n">field</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transfer_function</span><span class="p">(</span><span class="n">wavefront</span><span class="p">,</span> <span class="n">propagation_distance</span><span class="p">)</span>
        <span class="n">field</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">output_positions</span><span class="p">,</span>
            <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">propagation_distance</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">field</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>

        <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                        <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">prop_distance</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                        <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">defocus</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">propagation_shift</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                        <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span> \
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift</span>


        <span class="n">prop_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront </span><span class="si">{</span><span class="n">prop_distance</span><span class="si">}</span><span class="s2"> &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> to a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2"> pixels of &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;size </span><span class="si">{</span><span class="n">pixel_scale</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>

        <span class="n">defocus_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;with a defocus of </span><span class="si">{</span><span class="n">defocus</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> &quot;</span>
                           <span class="s2">&quot;using a 2-sided MFT.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span>  <span class="n">defocus_string</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span><span class="p">:</span>
                <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> pixels in the (x, y) &quot;</span>
                                <span class="s2">&quot;dimension &quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> in the &quot;</span>
                                <span class="s2">&quot;(x, y) dimension &quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span> <span class="n">shift_string</span> <span class="o">+</span> <span class="n">defocus_string</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFresnel.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels_out</span><span class="p">,</span> <span class="n">pixel_scale_out</span><span class="p">,</span> <span class="n">focal_length</span><span class="p">,</span> <span class="n">propagation_shift</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">pixel_shift</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CartesianFresnel&#39;</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFresnel.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the CartesianFresnel propagator</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pixel_scale_out</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The pixel scale in the output plane, measured in meters per pixel.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>npixels_out</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels in the output plane.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>focal_length</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The focal_length of the lens/mirror this propagator represents.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>propagation_shift</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The shift in the propagation distance of the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is this an 'inverse' propagation. Non-inverse propagations
represents propagation from a pupil to a focal plane, and inverse
represents propagation from a focal to a pupil plane.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>shift</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The (x, y) shift to apply to the wavefront in the output plane.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>pixel_shift</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Should the shift value be considered in units of pixel, or in the
physical units of the output plane (ie pixels or meters, radians).</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;CartesianFresnel&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>              <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
             <span class="n">npixels_out</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">pixel_scale_out</span>   <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">focal_length</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">propagation_shift</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">inverse</span>           <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">shift</span>             <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">pixel_shift</span>       <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">name</span>              <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;CartesianFresnel&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Propagator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the CartesianFresnel propagator</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pixel_scale_out : Array, meters/pixel</span>
<span class="sd">        The pixel scale in the output plane, measured in meters per pixel.</span>
<span class="sd">    npixels_out : int</span>
<span class="sd">        The number of pixels in the output plane.</span>
<span class="sd">    focal_length : Array, meters</span>
<span class="sd">        The focal_length of the lens/mirror this propagator represents.</span>
<span class="sd">    propagation_shift : Array, meters</span>
<span class="sd">        The shift in the propagation distance of the wavefront.</span>
<span class="sd">    inverse : bool = False</span>
<span class="sd">        Is this an &#39;inverse&#39; propagation. Non-inverse propagations</span>
<span class="sd">        represents propagation from a pupil to a focal plane, and inverse</span>
<span class="sd">        represents propagation from a focal to a pupil plane.</span>
<span class="sd">    shift : Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) shift to apply to the wavefront in the output plane.</span>
<span class="sd">    pixel_shift : bool = False</span>
<span class="sd">        Should the shift value be considered in units of pixel, or in the</span>
<span class="sd">        physical units of the output plane (ie pixels or meters, radians).</span>
<span class="sd">    name : str = &#39;CartesianFresnel&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span>               <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
                     <span class="n">inverse</span>            <span class="o">=</span> <span class="n">inverse</span><span class="p">,</span>
                     <span class="n">shift</span>              <span class="o">=</span> <span class="n">shift</span><span class="p">,</span>
                     <span class="n">pixel_shift</span>        <span class="o">=</span> <span class="n">pixel_shift</span><span class="p">,</span>
                     <span class="n">focal_length</span>       <span class="o">=</span> <span class="n">focal_length</span><span class="p">,</span>
                     <span class="n">pixel_scale_out</span>    <span class="o">=</span> <span class="n">pixel_scale_out</span><span class="p">,</span>
                     <span class="n">npixels_out</span>        <span class="o">=</span> <span class="n">npixels_out</span><span class="p">,</span>
                     <span class="n">propagation_shift</span>  <span class="o">=</span> <span class="n">propagation_shift</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFresnel.get_nfringes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_nfringes</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFresnel.get_nfringes" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>The number of diffraction fringes in the output plane.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront being propagated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>fringes</code></td>          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The number of diffraction fringes in the output plane.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_nfringes</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                 <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The number of diffraction fringes in the output plane.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront being propagated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fringes : Array</span>
<span class="sd">        The number of diffraction fringes in the output plane.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">propagation_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">propagation_shift</span>
    <span class="n">size_in</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">diameter</span>
    <span class="n">size_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span>
    <span class="k">return</span> <span class="n">size_in</span> <span class="o">*</span> <span class="n">size_out</span> <span class="o">/</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span> <span class="o">/</span> <span class="n">propagation_distance</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFresnel.propagate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">propagate</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFresnel.propagate" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Propagates the wavefront from the input plane to the output plane using
a Matrix Fourier Transform.</p>
<p>TODO: Set plane type to intermediate</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to propagate.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>field</code></td>          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The normalised electric field phasor after the propagation.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">propagate</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propagates the wavefront from the input plane to the output plane using</span>
<span class="sd">    a Matrix Fourier Transform.</span>

<span class="sd">    TODO: Set plane type to intermediate</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to propagate.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    field : Array</span>
<span class="sd">        The normalised electric field phasor after the propagation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># See gihub issue #52</span>
    <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_shift</span><span class="p">()</span>

    <span class="n">input_positions</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">pixel_coordinates</span>
    <span class="n">output_positions</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="p">),</span> 
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">))</span>

    <span class="n">propagation_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">propagation_shift</span>

    <span class="n">field</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phasor</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">input_positions</span><span class="p">,</span>
        <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">input_positions</span><span class="p">,</span>
        <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">propagation_distance</span><span class="p">)</span>
    <span class="n">wavefront</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">field</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>

    <span class="n">field</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transfer_function</span><span class="p">(</span><span class="n">wavefront</span><span class="p">,</span> <span class="n">propagation_distance</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quadratic_phase</span><span class="p">(</span><span class="o">*</span><span class="n">output_positions</span><span class="p">,</span>
        <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">propagation_distance</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">field</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFresnel.quadratic_phase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">quadratic_phase</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span> <span class="n">y_coordinates</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFresnel.quadratic_phase" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>A convinience function for calculating quadratic phase factors.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_coordinates</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The x coordinates of the pixels in meters. This will be different
in the plane of propagation and the initial plane.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_coordinates</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The y coordinates of the pixels in meters. This will be different
in the plane of propagation and the initial plane.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>wavelength</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The wavelength of the wavefront.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>distance</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The distance that is to be propagated in meters.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>quadratic_phase</code></td>          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>A set of phase factors that are useful in optical calculations.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">quadratic_phase</span><span class="p">(</span><span class="bp">self</span>          <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                    <span class="n">x_coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">y_coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">wavelength</span>    <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                    <span class="n">distance</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A convinience function for calculating quadratic phase factors.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_coordinates : Array</span>
<span class="sd">        The x coordinates of the pixels in meters. This will be different</span>
<span class="sd">        in the plane of propagation and the initial plane.</span>
<span class="sd">    y_coordinates : Array</span>
<span class="sd">        The y coordinates of the pixels in meters. This will be different</span>
<span class="sd">        in the plane of propagation and the initial plane.</span>
<span class="sd">    wavelength : Array, meters</span>
<span class="sd">        The wavelength of the wavefront.</span>
<span class="sd">    distance : Array, meters</span>
<span class="sd">        The distance that is to be propagated in meters.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    quadratic_phase : Array</span>
<span class="sd">        A set of phase factors that are useful in optical calculations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wavenumber</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">wavelength</span>
    <span class="n">radial_coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span> <span class="n">y_coordinates</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="n">j</span> <span class="o">*</span> <span class="n">wavenumber</span> <span class="o">*</span> <span class="n">radial_coordinates</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">distance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFresnel.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFresnel.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plane_out</span> <span class="o">=</span> <span class="s1">&#39;pupil&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="k">else</span> <span class="s1">&#39;focal&#39;</span>

    <span class="n">pixel_scale</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_scale_out</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                    <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">prop_distance</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">focal_length</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                    <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">defocus</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">propagation_shift</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                                    <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span> \
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift</span>


    <span class="n">prop_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Propagates the Wavefront </span><span class="si">{</span><span class="n">prop_distance</span><span class="si">}</span><span class="s2"> &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> to a </span><span class="si">{</span><span class="n">plane_out</span><span class="si">}</span><span class="s2"> plane &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">npixels_out</span><span class="si">}</span><span class="s2"> pixels of &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;size </span><span class="si">{</span><span class="n">pixel_scale</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>

    <span class="n">defocus_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;with a defocus of </span><span class="si">{</span><span class="n">defocus</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> &quot;</span>
                       <span class="s2">&quot;using a 2-sided MFT.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shift</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span>  <span class="n">defocus_string</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pixel_shift</span><span class="p">:</span>
            <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> pixels in the (x, y) &quot;</span>
                            <span class="s2">&quot;dimension &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shift_string</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shifted by </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> in the &quot;</span>
                            <span class="s2">&quot;(x, y) dimension &quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prop_string</span> <span class="o">+</span> <span class="n">shift_string</span> <span class="o">+</span> <span class="n">defocus_string</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.propagators.CartesianFresnel.transfer_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">transfer_function</span><span class="p">(</span><span class="n">wavefront</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span></code>

<a href="#dLux.propagators.CartesianFresnel.transfer_function" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>The Optical Transfer Function defining the phase evolution of the
wavefront when propagating to a non-conjugate plane.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code>Wavefront</code>
          </td>
          <td><p>The wavefront to propagate.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>distance</code></td>
          <td>
                <code><span title="dLux.propagators.Array">Array</span>, meters</code>
          </td>
          <td><p>The distance that is being propagated in meters.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>field</code></td>          <td>
                <code><span title="dLux.propagators.Array">Array</span></code>
          </td>
          <td><p>The field that represents the optical transfer.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/propagators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transfer_function</span><span class="p">(</span><span class="bp">self</span>      <span class="p">:</span> <span class="n">Propagator</span><span class="p">,</span>
                      <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">,</span>
                      <span class="n">distance</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Optical Transfer Function defining the phase evolution of the</span>
<span class="sd">    wavefront when propagating to a non-conjugate plane.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront : Wavefront</span>
<span class="sd">        The wavefront to propagate.</span>
<span class="sd">    distance : Array, meters</span>
<span class="sd">        The distance that is being propagated in meters.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    field : Array</span>
<span class="sd">        The field that represents the optical transfer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavenumber</span> <span class="o">*</span> <span class="n">distance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.propagators.CartesianFresnel"><a class="headerlink" href="#dLux.propagators.CartesianFresnel" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFresnel.__init__"><a class="headerlink" href="#dLux.propagators.CartesianFresnel.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFresnel.get_nfringes"><a class="headerlink" href="#dLux.propagators.CartesianFresnel.get_nfringes" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFresnel.propagate"><a class="headerlink" href="#dLux.propagators.CartesianFresnel.propagate" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFresnel.quadratic_phase"><a class="headerlink" href="#dLux.propagators.CartesianFresnel.quadratic_phase" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFresnel.summary"><a class="headerlink" href="#dLux.propagators.CartesianFresnel.summary" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.propagators.CartesianFresnel.transfer_function"><a class="headerlink" href="#dLux.propagators.CartesianFresnel.transfer_function" title="Permanent link">¤</a></h2>
</div>
</details>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>