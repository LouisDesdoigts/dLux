
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for dLux.">
      
      
        <meta name="author" content="Louis Desdoigts">
      
      
        <link rel="canonical" href="https://louisdesdoigts.github.io/dlux/docs/API/sources/">
      
      
        <link rel="prev" href="../spectra/">
      
      
        <link rel="next" href="../images/">
      
      <link rel="icon" href="../../../material/telescope">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.16">
    
    
      
        <title>Sources - dLux</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#source-sourcepy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dLux" class="md-header__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dLux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sources
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dLux" class="md-nav__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    dLux
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/phase_retrieval_demo/" class="md-nav__link">
        Phase Retrieval in ∂Lux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/designing_a_mask/" class="md-nav__link">
        Phase Mask Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/flatfield_calibration/" class="md-nav__link">
        Pixel Level Calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/fisher_information/" class="md-nav__link">
        Fisher Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/HMC/" class="md-nav__link">
        NumPyro and Hamiltonian Monte Carlo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          dLux API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          dLux API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wavefronts/" class="md-nav__link">
        Wavefronts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optical_layers/" class="md-nav__link">
        Optical Layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../propagators/" class="md-nav__link">
        Propagators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../apertures/" class="md-nav__link">
        Apertures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aberrations/" class="md-nav__link">
        Aberrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spectra/" class="md-nav__link">
        Spectra
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Sources
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../images/" class="md-nav__link">
        Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detector_layers/" class="md-nav__link">
        Detector Layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detectors/" class="md-nav__link">
        Detectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instruments/" class="md-nav__link">
        Instruments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observations/" class="md-nav__link">
        Observations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Utils API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Utils API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/math/" class="md-nav__link">
        Math
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/coordinates/" class="md-nav__link">
        Coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/helpers/" class="md-nav__link">
        Helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="source-sourcepy">Source: <code>source.py</code><a class="headerlink" href="#source-sourcepy" title="Permanent link">¤</a></h1>
<p>This module contains the classes that define the behaviour of sources in ∂Lux.</p>
<p>There are five public classes:</p>
<ul>
<li><code>PointSource</code></li>
<li><code>PointSources</code></li>
<li><code>BinarySource</code></li>
<li><code>ResolvedSource</code></li>
<li><code>PointResolvedSource</code></li>
</ul>
<p>Source classes store <code>Spectrum</code> objects that define the spectral properties of the source. They also store the position of the source on the sky, and the flux of the source.</p>
<p>All public classes have two main methods:</p>
<ol>
<li><code>normalise()</code> Returns a new source object with the relevant attributes normalised.</li>
<li><code>model(optics)</code> Models the source through the optics.</li>
</ol>
<details class="info">
<summary>PointSource</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.sources.PointSource"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.sources.Source">Source</span></code></p>

  
      <p>Concrete Class for unresolved point source objects.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) on-sky position of this object.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, photons</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The flux of the object.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.spectra.Spectrum" href="../spectra/#dLux.spectra.Spectrum">Spectrum</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a Spectrum object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/sources.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PointSource</span><span class="p">(</span><span class="n">Source</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concrete Class for unresolved point source objects.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : Array, photons</span>
<span class="sd">        The flux of the object.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div><h2 data-role="class" id="dLux.sources.PointSource"><a class="headerlink" href="#dLux.sources.PointSource" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>PointSources</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.sources.PointSources"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.sources.Source">Source</span></code></p>

  
      <p>Concrete Class for multiple unresolved point source objects.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) on-sky positions of these sources.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, photons</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The fluxes of the sources.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.spectra.Spectrum" href="../spectra/#dLux.spectra.Spectrum">Spectrum</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a Spectrum object.
Every source in this class will have an identical spectrum.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/sources.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PointSources</span><span class="p">(</span><span class="n">Source</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concrete Class for multiple unresolved point source objects.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The (x, y) on-sky positions of these sources.</span>
<span class="sd">    flux : Array, photons</span>
<span class="sd">        The fluxes of the sources.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        Every source in this class will have an identical spectrum.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
                 <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                 <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the PointSources class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : Array, radians</span>
<span class="sd">            The ((x0, y0), (x1, y1), ...) on-sky positions of these sources.</span>
<span class="sd">        flux : Array, photons = None</span>
<span class="sd">            The fluxes of the sources.</span>
<span class="sd">        spectrum : Spectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">            Every source in this class will have an identical spectrum.</span>
<span class="sd">        wavelengths : Array, metres = None</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span>
                         <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

        <span class="c1"># More complex parameter checks here because of extra dims</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;position must be a 2d array.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">flux</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;flux must be a 1d array.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of flux must be equal to length of &quot;</span>
                                 <span class="s2">&quot;position.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to model the psf of the point source through the optics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source objects.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psf : Array</span>
<span class="sd">            The PSF of the source modelled through the optics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">propagator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">propagator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.sources.PointSources.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">flux</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.sources.PointSources.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the PointSources class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The ((x0, y0), (x1, y1), ...) on-sky positions of these sources.</p>
            </div>
          </td>
          <td>
                <code>np.zeros(2)</code>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code>Array, photons = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The fluxes of the sources.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code>Spectrum = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a Spectrum object.
Every source in this class will have an identical spectrum.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>wavelengths</code></td>
          <td>
                <code>Array, metres = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array of wavelengths at which the spectrum is defined.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
             <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
             <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the PointSources class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The ((x0, y0), (x1, y1), ...) on-sky positions of these sources.</span>
<span class="sd">    flux : Array, photons = None</span>
<span class="sd">        The fluxes of the sources.</span>
<span class="sd">    spectrum : Spectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        Every source in this class will have an identical spectrum.</span>
<span class="sd">    wavelengths : Array, metres = None</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span>
                     <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

    <span class="c1"># More complex parameter checks here because of extra dims</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;position must be a 2d array.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">flux</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;flux must be a 1d array.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of flux must be equal to length of &quot;</span>
                             <span class="s2">&quot;position.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.sources.PointSources.model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">)</span></code>

<a href="#dLux.sources.PointSources.model" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Method to model the psf of the point source through the optics.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>optics</code></td>
          <td>
                <code>Optics</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The optics through which to model the source objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>psf</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The PSF of the source modelled through the optics.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to model the psf of the point source through the optics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source objects.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psf : Array</span>
<span class="sd">        The PSF of the source modelled through the optics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">propagator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">propagator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.sources.PointSources"><a class="headerlink" href="#dLux.sources.PointSources" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.PointSources.__init__"><a class="headerlink" href="#dLux.sources.PointSources.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.PointSources.model"><a class="headerlink" href="#dLux.sources.PointSources.model" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>BinarySource</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.sources.BinarySource"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.sources.RelativePositionSource">RelativePositionSource</span></code>, <code><span title="dLux.sources.RelativeFluxSource">RelativeFluxSource</span></code></p>

  
      <p>A parameterised binary source.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) on-sky position of this object.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, photons</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The mean flux of the sources.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>separation</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The separation of the two sources in radians.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>position_angle</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The position angle between the two sources measured clockwise from
the vertical axis.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>contrast</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The contrast ratio between the two sources.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.spectra.Spectrum" href="../spectra/#dLux.spectra.Spectrum">Spectrum</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a CombinedSpectrum object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/sources.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BinarySource</span><span class="p">(</span><span class="n">RelativePositionSource</span><span class="p">,</span> <span class="n">RelativeFluxSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A parameterised binary source.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : Array, photons</span>
<span class="sd">        The mean flux of the sources.</span>
<span class="sd">    separation : Array, radians</span>
<span class="sd">        The separation of the two sources in radians.</span>
<span class="sd">    position_angle : Array, radians</span>
<span class="sd">        The position angle between the two sources measured clockwise from</span>
<span class="sd">        the vertical axis.</span>
<span class="sd">    contrast : Array</span>
<span class="sd">        The contrast ratio between the two sources.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a CombinedSpectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
                 <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">separation</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">position_angle</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                 <span class="n">contrast</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : Array, radians = np.array([0., 0.])</span>
<span class="sd">            The (x, y) on-sky position of this object.</span>
<span class="sd">        flux : Array, photons = np.array(1.)</span>
<span class="sd">            The mean flux of the sources.</span>
<span class="sd">        separation : Array, radians = None</span>
<span class="sd">            The separation of the two sources in radians.</span>
<span class="sd">        position_angle : Array, radians = np.pi/2</span>
<span class="sd">            The position angle between the two sources measured clockwise from</span>
<span class="sd">            the vertical axis.</span>
<span class="sd">        contrast : Array = np.array(1.)</span>
<span class="sd">            The contrast ratio between the two sources.</span>
<span class="sd">        spectrum : CombinedSpectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a CombinedSpectrum.</span>
<span class="sd">        wavelengths : Array, metres = None</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)))</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span>
                         <span class="n">separation</span><span class="o">=</span><span class="n">separation</span><span class="p">,</span> <span class="n">position_angle</span><span class="o">=</span><span class="n">position_angle</span><span class="p">,</span>
                         <span class="n">contrast</span><span class="o">=</span><span class="n">contrast</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to model the psf of the point source through the optics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source objects.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psf : Array</span>
<span class="sd">            The PSF of the source modelled through the optics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxes</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">propagator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">propagator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.sources.BinarySource.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">flux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">separation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position_angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.sources.BinarySource.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code>Array, radians = np.array([0., 0.])</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) on-sky position of this object.</p>
            </div>
          </td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code>Array, photons = np.array(1.)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The mean flux of the sources.</p>
            </div>
          </td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>separation</code></td>
          <td>
                <code>Array, radians = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The separation of the two sources in radians.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>position_angle</code></td>
          <td>
                <code>Array, radians = np.pi/2</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The position angle between the two sources measured clockwise from
the vertical axis.</p>
            </div>
          </td>
          <td>
                <code>np.pi / 2</code>
          </td>
        </tr>
        <tr>
          <td><code>contrast</code></td>
          <td>
                <code>Array = np.array(1.)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The contrast ratio between the two sources.</p>
            </div>
          </td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code>CombinedSpectrum = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a CombinedSpectrum.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>wavelengths</code></td>
          <td>
                <code>Array, metres = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array of wavelengths at which the spectrum is defined.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
             <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">separation</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">position_angle</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
             <span class="n">contrast</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians = np.array([0., 0.])</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : Array, photons = np.array(1.)</span>
<span class="sd">        The mean flux of the sources.</span>
<span class="sd">    separation : Array, radians = None</span>
<span class="sd">        The separation of the two sources in radians.</span>
<span class="sd">    position_angle : Array, radians = np.pi/2</span>
<span class="sd">        The position angle between the two sources measured clockwise from</span>
<span class="sd">        the vertical axis.</span>
<span class="sd">    contrast : Array = np.array(1.)</span>
<span class="sd">        The contrast ratio between the two sources.</span>
<span class="sd">    spectrum : CombinedSpectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a CombinedSpectrum.</span>
<span class="sd">    wavelengths : Array, metres = None</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)))</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span>
                     <span class="n">separation</span><span class="o">=</span><span class="n">separation</span><span class="p">,</span> <span class="n">position_angle</span><span class="o">=</span><span class="n">position_angle</span><span class="p">,</span>
                     <span class="n">contrast</span><span class="o">=</span><span class="n">contrast</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.sources.BinarySource.model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">)</span></code>

<a href="#dLux.sources.BinarySource.model" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Method to model the psf of the point source through the optics.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>optics</code></td>
          <td>
                <code>Optics</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The optics through which to model the source objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>psf</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The PSF of the source modelled through the optics.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to model the psf of the point source through the optics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source objects.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psf : Array</span>
<span class="sd">        The PSF of the source modelled through the optics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxes</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">propagator</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">propagator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.sources.BinarySource"><a class="headerlink" href="#dLux.sources.BinarySource" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.BinarySource.__init__"><a class="headerlink" href="#dLux.sources.BinarySource.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.BinarySource.model"><a class="headerlink" href="#dLux.sources.BinarySource.model" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>ResolvedSource</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.sources.ResolvedSource"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.sources.Source">Source</span></code></p>

  
      <p>A class for modelling resolved sources that parametrise their resolved
component using an array of intensities.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) on-sky position of this object.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, photons</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The flux of the object.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.spectra.Spectrum" href="../spectra/#dLux.spectra.Spectrum">Spectrum</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a Spectrum object.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>distribution</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array of intensities representing the resolved source.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/sources.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ResolvedSource</span><span class="p">(</span><span class="n">Source</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for modelling resolved sources that parametrise their resolved</span>
<span class="sd">    component using an array of intensities.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : Array, photons</span>
<span class="sd">        The flux of the object.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    distribution : Array</span>
<span class="sd">        The array of intensities representing the resolved source.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
                 <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                 <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
                 <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the ResolvedSource class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : Array, radians = np.array([0., 0.])</span>
<span class="sd">            The (x, y) on-sky position of this object.</span>
<span class="sd">        flux : Array, photons = np.array(1.)</span>
<span class="sd">            The flux of the object.</span>
<span class="sd">        distribution : Array = np.ones((3, 3))</span>
<span class="sd">            The array of intensities representing the resolved source.</span>
<span class="sd">        spectrum : Spectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        wavelengths : Array, metres = None</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span> <span class="o">/</span> <span class="n">distribution</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;distribution must be a 2d array.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
                         <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Source</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for returning a new source object with a normalised total</span>
<span class="sd">        spectrum and source distribution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        source : Source</span>
<span class="sd">            The source object with the normalised spectrum and distribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">distribution_floor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution_floor</span> <span class="o">/</span> <span class="n">distribution_floor</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="s1">&#39;distribution&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">distribution</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to model the psf of the source through the optics. Implements a</span>
<span class="sd">        basic convolution with the psf and source distribution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source objects.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psf : Array</span>
<span class="sd">            The psf of the source modelled through the optics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Normalise and get parameters</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">psf</span> <span class="o">=</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">convolved</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">*</span> <span class="n">convolved</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.sources.ResolvedSource.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">flux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">distribution</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.sources.ResolvedSource.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the ResolvedSource class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code>Array, radians = np.array([0., 0.])</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) on-sky position of this object.</p>
            </div>
          </td>
          <td>
                <code>np.zeros(2)</code>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code>Array, photons = np.array(1.)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The flux of the object.</p>
            </div>
          </td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>distribution</code></td>
          <td>
                <code>Array = np.ones((3, 3))</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array of intensities representing the resolved source.</p>
            </div>
          </td>
          <td>
                <code>np.ones((3, 3))</code>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code>Spectrum = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a Spectrum object.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>wavelengths</code></td>
          <td>
                <code>Array, metres = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array of wavelengths at which the spectrum is defined.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
             <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
             <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
             <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the ResolvedSource class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians = np.array([0., 0.])</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : Array, photons = np.array(1.)</span>
<span class="sd">        The flux of the object.</span>
<span class="sd">    distribution : Array = np.ones((3, 3))</span>
<span class="sd">        The array of intensities representing the resolved source.</span>
<span class="sd">    spectrum : Spectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    wavelengths : Array, metres = None</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span> <span class="o">/</span> <span class="n">distribution</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;distribution must be a 2d array.&quot;</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span>
                     <span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.sources.ResolvedSource.model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">)</span></code>

<a href="#dLux.sources.ResolvedSource.model" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Method to model the psf of the source through the optics. Implements a
basic convolution with the psf and source distribution.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>optics</code></td>
          <td>
                <code>Optics</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The optics through which to model the source objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>psf</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The psf of the source modelled through the optics.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to model the psf of the source through the optics. Implements a</span>
<span class="sd">    basic convolution with the psf and source distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source objects.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psf : Array</span>
<span class="sd">        The psf of the source modelled through the optics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Normalise and get parameters</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">psf</span> <span class="o">=</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">convolved</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">*</span> <span class="n">convolved</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.sources.ResolvedSource.normalise" class="doc doc-heading">
<code class="highlight language-python"><span class="n">normalise</span><span class="p">()</span></code>

<a href="#dLux.sources.ResolvedSource.normalise" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Method for returning a new source object with a normalised total
spectrum and source distribution.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>source</code></td>          <td>
                <code><span title="dLux.sources.Source">Source</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The source object with the normalised spectrum and distribution.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Source</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method for returning a new source object with a normalised total</span>
<span class="sd">    spectrum and source distribution.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    source : Source</span>
<span class="sd">        The source object with the normalised spectrum and distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">distribution_floor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution_floor</span> <span class="o">/</span> <span class="n">distribution_floor</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="s1">&#39;distribution&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">distribution</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.sources.ResolvedSource"><a class="headerlink" href="#dLux.sources.ResolvedSource" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.ResolvedSource.__init__"><a class="headerlink" href="#dLux.sources.ResolvedSource.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.ResolvedSource.model"><a class="headerlink" href="#dLux.sources.ResolvedSource.model" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.ResolvedSource.normalise"><a class="headerlink" href="#dLux.sources.ResolvedSource.normalise" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>PointResolvedSource</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.sources.PointResolvedSource"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.sources.RelativeFluxSource">RelativeFluxSource</span></code>, <code><a class="autorefs autorefs-internal" title="dLux.sources.ResolvedSource" href="#dLux.sources.ResolvedSource">ResolvedSource</a></code></p>

  
      <p>A class for modelling a point source and a resolved source that is defined
relative to the point source. An example would be an unresolved star with
a resolved dust shell or debris disk. These two objects share the same
spectra but have their fluxes defined by flux (the mean flux) and the flux
ratio (contrast) between the point source and resolved distribution. The
resolved component is defined by an array (ie this class inherits from
ResolvedSource).</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, radians</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) on-sky position of this object.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code><span title="jax.Array">Array</span>, photons</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The mean flux of the point and resolved source.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>distribution</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array of intensities representing the resolved source.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>contrast</code></td>
          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The contrast ratio between the point source and the resolved
source.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="dLux.spectra.Spectrum" href="../spectra/#dLux.spectra.Spectrum">Spectrum</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a Spectrum object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/sources.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PointResolvedSource</span><span class="p">(</span><span class="n">RelativeFluxSource</span><span class="p">,</span> <span class="n">ResolvedSource</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for modelling a point source and a resolved source that is defined</span>
<span class="sd">    relative to the point source. An example would be an unresolved star with</span>
<span class="sd">    a resolved dust shell or debris disk. These two objects share the same</span>
<span class="sd">    spectra but have their fluxes defined by flux (the mean flux) and the flux</span>
<span class="sd">    ratio (contrast) between the point source and resolved distribution. The</span>
<span class="sd">    resolved component is defined by an array (ie this class inherits from</span>
<span class="sd">    ResolvedSource).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : Array, photons</span>
<span class="sd">        The mean flux of the point and resolved source.</span>
<span class="sd">    distribution : Array</span>
<span class="sd">        The array of intensities representing the resolved source.</span>
<span class="sd">    contrast : Array</span>
<span class="sd">        The contrast ratio between the point source and the resolved</span>
<span class="sd">        source.</span>
<span class="sd">    spectrum : Spectrum</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
                 <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
                 <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
                 <span class="n">contrast</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Source</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : Array, radians = np.array([0., 0.])</span>
<span class="sd">            The (x, y) on-sky position of this object.</span>
<span class="sd">        flux : Array, photons = np.array(1.)</span>
<span class="sd">            The mean flux of the point and resolved source.</span>
<span class="sd">        distribution : Array = np.ones((3, 3))</span>
<span class="sd">            The array of intensities representing the resolved source.</span>
<span class="sd">        contrast : Array = np.array(1.)</span>
<span class="sd">            The contrast ratio between the point source and the resolved</span>
<span class="sd">            source.</span>
<span class="sd">        spectrum : Spectrum = None</span>
<span class="sd">            The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">        wavelengths : Array, metres = None</span>
<span class="sd">            The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span>
                         <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
                         <span class="n">contrast</span><span class="o">=</span><span class="n">contrast</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to model the psf of the source through the optics. Implements a</span>
<span class="sd">        basic convolution with the psf and source distribution, while also</span>
<span class="sd">        modelling the single point source psf.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        optics : Optics</span>
<span class="sd">            The optics through which to model the source objects.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psf : Array</span>
<span class="sd">            The psf of the source modelled through the optics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Normalise and get parameters</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
        <span class="n">psf</span> <span class="o">=</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">convolved</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">psf</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">convolved</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.sources.PointResolvedSource.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">flux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">distribution</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">contrast</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">spectrum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.sources.PointResolvedSource.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>position</code></td>
          <td>
                <code>Array, radians = np.array([0., 0.])</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (x, y) on-sky position of this object.</p>
            </div>
          </td>
          <td>
                <code>np.zeros(2)</code>
          </td>
        </tr>
        <tr>
          <td><code>flux</code></td>
          <td>
                <code>Array, photons = np.array(1.)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The mean flux of the point and resolved source.</p>
            </div>
          </td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>distribution</code></td>
          <td>
                <code>Array = np.ones((3, 3))</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array of intensities representing the resolved source.</p>
            </div>
          </td>
          <td>
                <code>np.ones((3, 3))</code>
          </td>
        </tr>
        <tr>
          <td><code>contrast</code></td>
          <td>
                <code>Array = np.array(1.)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The contrast ratio between the point source and the resolved
source.</p>
            </div>
          </td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td>
                <code>Spectrum = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spectrum of this object, represented by a Spectrum object.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>wavelengths</code></td>
          <td>
                <code>Array, metres = None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The array of wavelengths at which the spectrum is defined.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span>
             <span class="n">wavelengths</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">position</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
             <span class="n">flux</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">distribution</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
             <span class="n">contrast</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Source</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    position : Array, radians = np.array([0., 0.])</span>
<span class="sd">        The (x, y) on-sky position of this object.</span>
<span class="sd">    flux : Array, photons = np.array(1.)</span>
<span class="sd">        The mean flux of the point and resolved source.</span>
<span class="sd">    distribution : Array = np.ones((3, 3))</span>
<span class="sd">        The array of intensities representing the resolved source.</span>
<span class="sd">    contrast : Array = np.array(1.)</span>
<span class="sd">        The contrast ratio between the point source and the resolved</span>
<span class="sd">        source.</span>
<span class="sd">    spectrum : Spectrum = None</span>
<span class="sd">        The spectrum of this object, represented by a Spectrum object.</span>
<span class="sd">    wavelengths : Array, metres = None</span>
<span class="sd">        The array of wavelengths at which the spectrum is defined.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">wavelengths</span><span class="o">=</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span>
                     <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
                     <span class="n">contrast</span><span class="o">=</span><span class="n">contrast</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.sources.PointResolvedSource.model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">)</span></code>

<a href="#dLux.sources.PointResolvedSource.model" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Method to model the psf of the source through the optics. Implements a
basic convolution with the psf and source distribution, while also
modelling the single point source psf.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>optics</code></td>
          <td>
                <code>Optics</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The optics through which to model the source objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>psf</code></td>          <td>
                <code><span title="jax.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The psf of the source modelled through the optics.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/sources.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Source</span><span class="p">,</span> <span class="n">optics</span><span class="p">:</span> <span class="n">Optics</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to model the psf of the source through the optics. Implements a</span>
<span class="sd">    basic convolution with the psf and source distribution, while also</span>
<span class="sd">    modelling the single point source psf.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    optics : Optics</span>
<span class="sd">        The optics through which to model the source objects.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    psf : Array</span>
<span class="sd">        The psf of the source modelled through the optics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Normalise and get parameters</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalise</span><span class="p">()</span>
    <span class="n">psf</span> <span class="o">=</span> <span class="n">optics</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">convolved</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">psf</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluxes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">convolved</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.sources.PointResolvedSource"><a class="headerlink" href="#dLux.sources.PointResolvedSource" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.PointResolvedSource.__init__"><a class="headerlink" href="#dLux.sources.PointResolvedSource.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.sources.PointResolvedSource.model"><a class="headerlink" href="#dLux.sources.PointResolvedSource.model" title="Permanent link">¤</a></h2>
</div>
</details>
<hr />
<h1 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">¤</a></h1>
<p>Let's look at how to construct all these different classes. First, we construct some optics to model the sources through.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">dLux</span> <span class="k">as</span> <span class="nn">dl</span>

<span class="c1"># Define the optical parameters</span>
<span class="n">wf_npixels</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">diameter</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># metres</span>
<span class="n">psf_npixels</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">psf_pixel_scale</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># arcseconds</span>
<span class="n">psf_oversample</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># Use ApertureFactory class to make a simple circular aperture</span>
<span class="n">aperture</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">ApertureFactory</span><span class="p">(</span><span class="n">wf_npixels</span><span class="p">)</span>

<span class="c1"># Construct the optics class</span>
<span class="n">optics</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">AngularOptics</span><span class="p">(</span><span class="n">wf_npixels</span><span class="p">,</span> <span class="n">diameter</span><span class="p">,</span> <span class="n">aperture</span><span class="p">,</span> 
    <span class="n">psf_npixels</span><span class="p">,</span> <span class="n">psf_pixel_scale</span><span class="p">,</span> <span class="n">psf_oversample</span><span class="p">)</span>
</code></pre></div>
<p>Now, we define the different source classes.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Define wavelengths</span>
<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1.2e-6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># metres</span>

<span class="c1"># Construct PointSource</span>
<span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">dl</span><span class="o">.</span><span class="n">PointSource</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)]</span>

<span class="c1"># Construct PointSources</span>
<span class="n">positions</span> <span class="o">=</span> <span class="mf">3e-6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dl</span><span class="o">.</span><span class="n">PointSources</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">positions</span><span class="p">))</span>

<span class="c1"># Construct BinarySource</span>
<span class="n">separation</span> <span class="o">=</span> <span class="mf">2e-6</span> <span class="c1"># radians</span>
<span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dl</span><span class="o">.</span><span class="n">BinarySource</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="n">separation</span><span class="p">))</span>

<span class="c1"># Construct ResolvedSource</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dl</span><span class="o">.</span><span class="n">ResolvedSource</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">))</span>

<span class="c1"># Construct PointResolvedSource</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dl</span><span class="o">.</span><span class="n">PointResolvedSource</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span> 
    <span class="n">contrast</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</code></pre></div>
<details class="abstract">
<summary>Plotting Code</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PointSource&quot;</span><span class="p">,</span> <span class="s2">&quot;PointSources&quot;</span><span class="p">,</span> <span class="s2">&quot;BinarySource&quot;</span><span class="p">,</span> <span class="s2">&quot;ResolvedSource&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PointResolvedSource&quot;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">psf</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">optics</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">psf</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;assets/sources.png&#39;</span><span class="p">)</span>
</code></pre></div>
</details>
<p><img alt="sources" src="../../assets/sources.png" /></p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a51614de.min.js"></script>
      
        
          <script src="../../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>