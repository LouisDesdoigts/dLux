
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for dLux.">
      
      
        <meta name="author" content="Louis Desdoigts">
      
      
        <link rel="canonical" href="https://louisdesdoigts.github.io/dlux/docs/API/apertures/">
      
      
        <link rel="prev" href="../optics/">
      
      
        <link rel="next" href="../aberrations/">
      
      <link rel="icon" href="../../../material/telescope">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.6">
    
    
      
        <title>Apertures - dLux</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#an-overview-of-the-apertures" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="dLux" class="md-header__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dLux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Apertures
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="dLux" class="md-nav__button md-logo" aria-label="dLux" data-md-component="logo">
      
  <img src="../../../assets/logo.jpg" alt="logo">

    </a>
    dLux
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LouisDesdoigts/dlux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    louisdesdoigts/dlux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../creating_a_layer/" class="md-nav__link">
        Creating a Layer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/phase_retrieval_demo/" class="md-nav__link">
        Phase Retrieval in dLux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/designing_a_mask/" class="md-nav__link">
        Phase Mask Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/flatfield_calibration/" class="md-nav__link">
        Pixel Level Calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/fisher_information/" class="md-nav__link">
        Fisher Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/HMC/" class="md-nav__link">
        Numpyro and Hamiltonian Monte Carlo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          dLux API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          dLux API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Apertures
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aberrations/" class="md-nav__link">
        Aberrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../propagators/" class="md-nav__link">
        Propagators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wavefronts/" class="md-nav__link">
        Wavefronts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../detectors/" class="md-nav__link">
        Detectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/" class="md-nav__link">
        Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spectrums/" class="md-nav__link">
        Spectrums
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observations/" class="md-nav__link">
        Observations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Utils API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Utils API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../optics_util/" class="md-nav__link">
        Optics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../math.md" class="md-nav__link">
        Math
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coordinates/" class="md-nav__link">
        Coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../interpolation/" class="md-nav__link">
        Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bayes/" class="md-nav__link">
        Bayes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/" class="md-nav__link">
        Helpers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        Change Log
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="an-overview-of-the-apertures">An Overview of the Apertures<a class="headerlink" href="#an-overview-of-the-apertures" title="Permanent link">¤</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¤</a></h2>
<p><code>dLux</code> implements a number of aperture components for telescopes. Because <code>dLux</code> is powered by autodiff, the shape of the aperture can be learned. Theoretically, you could learn the value of every pixel in the aperture. Learning by pixel would be computationally expensive and the model could chase noise making the results meaningless. Instead the apertures that we have implemented are <strong>parametrised</strong>. In general the apertures can be, <em>translated</em>, <em>sheared, compressed androtated</em>, all in a differentiable manner by softening the hard bounary using a sigmoid.</p>
<p>There are four different aperture types: Dynamic, Static, Aberrated and Composite. The dynamic apertures are the most flexible and can be used to learn the shape of the aperture. The static apertures pre-compute the aperture and use the fixed array representation. The aberrated apertures are used to learn the shape of the aperture and the basis functions for phase retrieval. The compound apertures are used to combine multiple apertures into a single aperture. There are also spider apertures that are used to model secondary mirror supports.</p>
<h2 id="dynamic-apertures">Dynamic Apertures<a class="headerlink" href="#dynamic-apertures" title="Permanent link">¤</a></h2>
<p>The dynamic apertures are form the basis for the rest of the apertures and contains 7 classes: <code>CircularAperture</code>, <code>AnnularAperture</code>, <code>HexagonalAperture</code>, <code>RectangularAperture</code>, <code>SquareAperture</code>, <code>RegularPolygonAperture</code>, <code>IrregularPolygonAperture</code>. Each of these classes has a seriers of common parameters: <code>translation</code>, <code>rotation</code>, <code>shear</code>, <code>compression</code>, <code>softening</code> and <code>occulting</code>. The <code>translation</code> and <code>rotation</code> parameters are used to move and rotate the aperture. The <code>shear</code> and <code>compression</code> parameters are used to change the shape of the aperture. The <code>softening</code> parameter is used to soften the hard boundary of the aperture, and <code>occulting</code> controls if the aperture is transmissive or occulting.</p>
<p>Each of these classes then has a different parameterisation of the aperture itself, for example the <code>CircularAperture</code> has a <code>radius</code> parameter, the <code>AnnularAperture</code> has <code>inner_radius</code> and <code>outer_radius</code> parameters.</p>
<details class="info">
<summary>Circular Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.CircularAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.DynamicAperture">DynamicAperture</span></code></p>

  
      <p>A circular aperture parameterised by its radius.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>radius</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The radius of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a tranmissive
aperture, and True results in an occulting aperture.</p></td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, pixels</code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CircularAperture</span><span class="p">(</span><span class="n">DynamicAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A circular aperture parameterised by its radius.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    radius: Array, meters</span>
<span class="sd">        The radius of the aperture. </span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    occulting: bool</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a tranmissive</span>
<span class="sd">        aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">radius</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">radius</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                 <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CircularAperture&quot;</span><span class="p">,</span>
                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the CircularAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        radius: Array, meters </span>
<span class="sd">            The radius of the aperture.</span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        occulting: bool = False</span>
<span class="sd">            Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">            tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">        softening: Array, pixels = np.array(1.)</span>
<span class="sd">            The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">            aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">        name: str = &#39;CircularAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span> 
                         <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span> 
                         <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;radius&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_soft_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the soft edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The softed edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="o">-</span> <span class="n">coordinates</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_hard_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the hard edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The hard edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">coordinates</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_extent</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the largest distance to the outer edge of the aperture from the</span>
<span class="sd">        centre.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        extent : float</span>
<span class="sd">            The maximum distance from the centre to edge of aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Circular Aperture with radius &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.CircularAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CircularAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.CircularAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the CircularAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>radius</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The radius of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a 
tranmissive aperture, and True results in an occulting aperture.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;CircularAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">radius</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
             <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CircularAperture&quot;</span><span class="p">,</span>
             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the CircularAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    radius: Array, meters </span>
<span class="sd">        The radius of the aperture.</span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    occulting: bool = False</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">        tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels = np.array(1.)</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str = &#39;CircularAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span> 
                     <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span> 
                     <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span> 

    <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;radius&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.CircularAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.CircularAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Circular Aperture with radius &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.CircularAperture"><a class="headerlink" href="#dLux.apertures.CircularAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.CircularAperture.__init__"><a class="headerlink" href="#dLux.apertures.CircularAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.CircularAperture.summary"><a class="headerlink" href="#dLux.apertures.CircularAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Annular Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.AnnularAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.DynamicAperture">DynamicAperture</span></code></p>

  
      <p>An annular aperture defined by its inner and outer radii.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rmax</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>Outer radius of aperture.</p></td>
        </tr>
        <tr>
          <td><code>rmin</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>Inner radius of aperture.</p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a tranmissive
aperture, and True results in an occulting aperture.</p></td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, pixels</code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AnnularAperture</span><span class="p">(</span><span class="n">DynamicAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An annular aperture defined by its inner and outer radii.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    rmax: Array, meters</span>
<span class="sd">        Outer radius of aperture.</span>
<span class="sd">    rmin: Array, meters</span>
<span class="sd">        Inner radius of aperture.</span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    occulting: bool</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a tranmissive</span>
<span class="sd">        aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rmin</span> <span class="p">:</span> <span class="n">Array</span>
    <span class="n">rmax</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">rmax</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
                 <span class="n">rmin</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                 <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;AnnularAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the AnnularAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rmax : Array, meters</span>
<span class="sd">            The outer radius of the aperture. </span>
<span class="sd">        rmin : Array, meters</span>
<span class="sd">            The inner radius of the aperture. </span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        occulting: bool = False</span>
<span class="sd">            Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">            tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">        softening: Array, pixels = np.array(1.)</span>
<span class="sd">            The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">            aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">        name: str = &#39;AnnularAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span> 
                         <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span> 
                         <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rmax</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rmin</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;rmax&quot;</span><span class="p">)</span>
        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmin</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;rmin&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_soft_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the soft edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The softed edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="n">coordinates</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmin</span><span class="p">)</span> <span class="o">*</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="o">-</span> <span class="n">coordinates</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_hard_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the hard edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The hard edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">coordinates</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmin</span><span class="p">)</span> <span class="o">*</span> \
            <span class="p">(</span><span class="n">coordinates</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_extent</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the largest distance to the outer edge of the aperture from the</span>
<span class="sd">        centre.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        extent : float</span>
<span class="sd">            The maximum distance from the centre to edge of aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rmin</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmin</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">rmax</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Annular Aperture with inner &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;radius </span><span class="si">{</span><span class="n">rmin</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> and outer radius </span><span class="si">{</span><span class="n">rmax</span><span class="si">}</span><span class="s2"> &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.AnnularAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="n">rmin</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;AnnularAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.AnnularAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the AnnularAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rmax</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The outer radius of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rmin</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The inner radius of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a 
tranmissive aperture, and True results in an occulting aperture.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;AnnularAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">rmax</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
             <span class="n">rmin</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
             <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;AnnularAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the AnnularAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rmax : Array, meters</span>
<span class="sd">        The outer radius of the aperture. </span>
<span class="sd">    rmin : Array, meters</span>
<span class="sd">        The inner radius of the aperture. </span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    occulting: bool = False</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">        tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels = np.array(1.)</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str = &#39;AnnularAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span> 
                     <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span> 
                     <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rmax</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rmin</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;rmax&quot;</span><span class="p">)</span>
    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmin</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;rmin&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.AnnularAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.AnnularAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rmin</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmin</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">rmax</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Annular Aperture with inner &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;radius </span><span class="si">{</span><span class="n">rmin</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> and outer radius </span><span class="si">{</span><span class="n">rmax</span><span class="si">}</span><span class="s2"> &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.AnnularAperture"><a class="headerlink" href="#dLux.apertures.AnnularAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.AnnularAperture.__init__"><a class="headerlink" href="#dLux.apertures.AnnularAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.AnnularAperture.summary"><a class="headerlink" href="#dLux.apertures.AnnularAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Hexagonal Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.HexagonalAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="dLux.apertures.RegularPolygonalAperture" href="#dLux.apertures.RegularPolygonalAperture">RegularPolygonalAperture</a></code></p>

  
      <p>A hexagonal aperture parameterised by the maximum radius to the vertices 
from its center.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rmax</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The maximum radius to the vertices from its center.</p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, radians</code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a tranmissive
aperture, and True results in an occulting aperture.</p></td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, pixels</code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HexagonalAperture</span><span class="p">(</span><span class="n">RegularPolygonalAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hexagonal aperture parameterised by the maximum radius to the vertices </span>
<span class="sd">    from its center.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    rmax : Array, meters</span>
<span class="sd">        The maximum radius to the vertices from its center.</span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a tranmissive</span>
<span class="sd">        aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rmax</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">rmax</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                 <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;HexagonalAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the HexagonalAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rmax : Array, meters</span>
<span class="sd">            The maximum radius to the vertices from its center.</span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        rotation: Array, radians = np.array(0.)</span>
<span class="sd">            The clockwise rotation of the aperture.</span>
<span class="sd">        occulting: bool = False</span>
<span class="sd">            Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">            tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">        softening: Array, pixels = np.array(1.)</span>
<span class="sd">            The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">            aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">        name: str = &#39;HexagonalAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">nsides</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                         <span class="n">rmax</span> <span class="o">=</span> <span class="n">rmax</span><span class="p">,</span>
                         <span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                         <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                         <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span>
                         <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rmax</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
        <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Hexagonal Aperture of max radius &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rmax</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.HexagonalAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">rmax</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;HexagonalAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.HexagonalAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the HexagonalAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rmax</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The maximum radius to the vertices from its center.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
          <td>
                <code>np.array(0.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a 
tranmissive aperture, and True results in an occulting aperture.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;HexagonalAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">rmax</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
             <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
             <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;HexagonalAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the HexagonalAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rmax : Array, meters</span>
<span class="sd">        The maximum radius to the vertices from its center.</span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians = np.array(0.)</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool = False</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">        tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels = np.array(1.)</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str = &#39;HexagonalAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">nsides</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                     <span class="n">rmax</span> <span class="o">=</span> <span class="n">rmax</span><span class="p">,</span>
                     <span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                     <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                     <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span>
                     <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.HexagonalAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.HexagonalAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rmax</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
    <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Hexagonal Aperture of max radius &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rmax</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.HexagonalAperture"><a class="headerlink" href="#dLux.apertures.HexagonalAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.HexagonalAperture.__init__"><a class="headerlink" href="#dLux.apertures.HexagonalAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.HexagonalAperture.summary"><a class="headerlink" href="#dLux.apertures.HexagonalAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Rectangular Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.RectangularAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.DynamicAperture">DynamicAperture</span></code></p>

  
      <p>A rectangular aperture parameterised by it height and width.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>height</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The length of the aperture in the y-direction. </p></td>
        </tr>
        <tr>
          <td><code>width</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The length of the aperture in the x-direction. </p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, radians</code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a tranmissive
aperture, and True results in an occulting aperture.</p></td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, pixels</code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RectangularAperture</span><span class="p">(</span><span class="n">DynamicAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A rectangular aperture parameterised by it height and width.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    height: Array, meters</span>
<span class="sd">        The length of the aperture in the y-direction. </span>
<span class="sd">    width: Array, meters</span>
<span class="sd">        The length of the aperture in the x-direction. </span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a tranmissive</span>
<span class="sd">        aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">height</span> <span class="p">:</span> <span class="n">Array</span>
    <span class="n">width</span>  <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">height</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
                 <span class="n">width</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                 <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;RectangularAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the RectangularAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        height: Array, meters </span>
<span class="sd">            The length of the aperture in the y-direction.</span>
<span class="sd">        width: Array, meters</span>
<span class="sd">            The length of the aperture in the x-direction.</span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        rotation: Array, radians = np.array(0.)</span>
<span class="sd">            The clockwise rotation of the aperture.</span>
<span class="sd">        occulting: bool = False</span>
<span class="sd">            Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">            tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">        softening: Array, pixels = np.array(1.)</span>
<span class="sd">            The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">            aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">        name: str = &#39;RectangularAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span>
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                         <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span> 
                         <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span> 
                         <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">)</span>
        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_soft_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the soft edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The softed edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
        <span class="n">x_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x_mask</span> <span class="o">*</span> <span class="n">y_mask</span>


    <span class="k">def</span> <span class="nf">_hard_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the hard edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The hard edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="n">x_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_mask</span> <span class="o">*</span> <span class="n">y_mask</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_extent</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the largest distance to the outer edge of the aperture from the</span>
<span class="sd">        centre.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        extent : float</span>
<span class="sd">            The maximum distance from the centre to edge of aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
        <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Rectangular Aperture with height &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> and width </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.RectangularAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;RectangularAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.RectangularAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the RectangularAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>height</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The length of the aperture in the y-direction.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>width</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The length of the aperture in the x-direction.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
          <td>
                <code>np.array(0.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a 
tranmissive aperture, and True results in an occulting aperture.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;RectangularAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">height</span>      <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
             <span class="n">width</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
             <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
             <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;RectangularAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the RectangularAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    height: Array, meters </span>
<span class="sd">        The length of the aperture in the y-direction.</span>
<span class="sd">    width: Array, meters</span>
<span class="sd">        The length of the aperture in the x-direction.</span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians = np.array(0.)</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool = False</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">        tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels = np.array(1.)</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str = &#39;RectangularAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span>
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                     <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span> 
                     <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span> 
                     <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">)</span>
    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.RectangularAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.RectangularAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
    <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Rectangular Aperture with height &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2"> and width </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.RectangularAperture"><a class="headerlink" href="#dLux.apertures.RectangularAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.RectangularAperture.__init__"><a class="headerlink" href="#dLux.apertures.RectangularAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.RectangularAperture.summary"><a class="headerlink" href="#dLux.apertures.RectangularAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Square Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.SquareAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.DynamicAperture">DynamicAperture</span></code></p>

  
      <p>A square aperture parameterised by its width.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>width</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The side length of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, radians</code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a tranmissive
aperture, and True results in an occulting aperture.</p></td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, pixels</code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SquareAperture</span><span class="p">(</span><span class="n">DynamicAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A square aperture parameterised by its width.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    width: Array, meters</span>
<span class="sd">        The side length of the aperture. </span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a tranmissive</span>
<span class="sd">        aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">width</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                 <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;SquareAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the SquareAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        width: Array, meters</span>
<span class="sd">            The side length of the aperture. </span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        rotation: Array, radians = np.array(0.)</span>
<span class="sd">            The clockwise rotation of the aperture.</span>
<span class="sd">        occulting: bool = False</span>
<span class="sd">            Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">            tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">        softening: Array, pixels = np.array(1.)</span>
<span class="sd">            The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">            aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">        name: str = &#39;SquareAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span>
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                         <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span> 
                         <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span> 
                         <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_soft_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the soft edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The softed edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
        <span class="n">y_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x_mask</span> <span class="o">*</span> <span class="n">y_mask</span>


    <span class="k">def</span> <span class="nf">_hard_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the hard edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The hard edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="n">y_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_mask</span> <span class="o">*</span> <span class="n">y_mask</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_extent</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the largest distance to the outer edge of the aperture from the</span>
<span class="sd">        centre.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        extent : float</span>
<span class="sd">            The maximum distance from the centre to edge of aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
        <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Rectangular Aperture with width &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.SquareAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SquareAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.SquareAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the SquareAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>width</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The side length of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
          <td>
                <code>np.array(0.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a 
tranmissive aperture, and True results in an occulting aperture.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;SquareAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span>
<span class="normal">997</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">width</span>       <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
             <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
             <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;SquareAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the SquareAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    width: Array, meters</span>
<span class="sd">        The side length of the aperture. </span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians = np.array(0.)</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool = False</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">        tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels = np.array(1.)</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str = &#39;SquareAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span>
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                     <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span> 
                     <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span> 
                     <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.SquareAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.SquareAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
    <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Rectangular Aperture with width &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.SquareAperture"><a class="headerlink" href="#dLux.apertures.SquareAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.SquareAperture.__init__"><a class="headerlink" href="#dLux.apertures.SquareAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.SquareAperture.summary"><a class="headerlink" href="#dLux.apertures.SquareAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Regular Polygonal Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.RegularPolygonalAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.PolygonalAperture">PolygonalAperture</span></code></p>

  
      <p>A regular polygonal aperture defined by its number of sides and the maximum 
radius to the vertices from its center.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nsides</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of sides of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rmax</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The maximum radius to the vertices from its center.</p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, radians</code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a tranmissive
aperture, and True results in an occulting aperture.</p></td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, pixels</code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RegularPolygonalAperture</span><span class="p">(</span><span class="n">PolygonalAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A regular polygonal aperture defined by its number of sides and the maximum </span>
<span class="sd">    radius to the vertices from its center.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    nsides: int</span>
<span class="sd">        The number of sides of the aperture. </span>
<span class="sd">    rmax: Array, meters</span>
<span class="sd">        The maximum radius to the vertices from its center.</span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a tranmissive</span>
<span class="sd">        aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nsides</span> <span class="p">:</span> <span class="nb">int</span>
    <span class="n">rmax</span>   <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">nsides</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">rmax</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                 <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;RegularPolygonalAperture&quot;</span>
                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the RegularPolygonalAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nsides: int</span>
<span class="sd">            The number of sides of the aperture.  </span>
<span class="sd">        rmax: Array, meters</span>
<span class="sd">            The maximum radius to the vertices from its center.</span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        rotation: Array, radians = np.array(0.)</span>
<span class="sd">            The clockwise rotation of the aperture.</span>
<span class="sd">        occulting: bool = False</span>
<span class="sd">            Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">            tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">        softening: Array, pixels = np.array(1.)</span>
<span class="sd">            The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">            aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">        name: str = &#39;RegularPolygonalAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                         <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                         <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span>
                         <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nsides</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nsides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rmax</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;rmax&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_extent</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the largest distance to the outer edge of the aperture from the</span>
<span class="sd">        centre.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        extent : float</span>
<span class="sd">            The maximum distance from the centre to edge of aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span>


    <span class="k">def</span> <span class="nf">_soft_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the soft edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The softed edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">neg_pi_to_pi_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nsides</span>

        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsides</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="c1"># Dummy index</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">alpha</span>

        <span class="n">ms</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_perp_dists_from_lines</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_orig_left_of_edge</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="n">inside</span> <span class="o">*</span> <span class="n">dists</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_hard_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the hard edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The hard edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">neg_pi_to_pi_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nsides</span>

        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsides</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="c1"># Dummy index</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">alpha</span>

        <span class="n">ms</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_perp_dists_from_lines</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_orig_left_of_edge</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">inside</span> <span class="o">*</span> <span class="n">dists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.</span>
        <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rmax</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
        <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nsides</span><span class="si">}</span><span class="s2"> sided Regular &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;Polygonal Aperture of max radius </span><span class="si">{</span><span class="n">rmax</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.RegularPolygonalAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nsides</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;RegularPolygonalAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.RegularPolygonalAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the RegularPolygonalAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nsides</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of sides of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rmax</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The maximum radius to the vertices from its center.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
          <td>
                <code>np.array(0.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a 
tranmissive aperture, and True results in an occulting aperture.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;RegularPolygonalAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">nsides</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">rmax</span>        <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
             <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
             <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;RegularPolygonalAperture&quot;</span>
             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the RegularPolygonalAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nsides: int</span>
<span class="sd">        The number of sides of the aperture.  </span>
<span class="sd">    rmax: Array, meters</span>
<span class="sd">        The maximum radius to the vertices from its center.</span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians = np.array(0.)</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool = False</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">        tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels = np.array(1.)</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str = &#39;RegularPolygonalAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                     <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                     <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span>
                     <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">nsides</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nsides</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rmax</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">((),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;rmax&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.RegularPolygonalAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.RegularPolygonalAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rmax</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmax</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
    <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nsides</span><span class="si">}</span><span class="s2"> sided Regular &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;Polygonal Aperture of max radius </span><span class="si">{</span><span class="n">rmax</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">sigfigs</span><span class="si">}}</span><span class="s2"> &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.RegularPolygonalAperture"><a class="headerlink" href="#dLux.apertures.RegularPolygonalAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.RegularPolygonalAperture.__init__"><a class="headerlink" href="#dLux.apertures.RegularPolygonalAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.RegularPolygonalAperture.summary"><a class="headerlink" href="#dLux.apertures.RegularPolygonalAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Irregular Polygonal Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.IrregularPolygonalAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.PolygonalAperture">PolygonalAperture</span></code></p>

  
      <p>An arbitrary aperture parameterised by a set of vertices.</p>
<p>TODO: Check if the verticies need to be defined in a specific way, based on
the methods this looks like the case (ie, ordered).</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>vertices</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The location of the vertices of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, radians</code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a tranmissive
aperture, and True results in an occulting aperture.</p></td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, pixels</code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IrregularPolygonalAperture</span><span class="p">(</span><span class="n">PolygonalAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An arbitrary aperture parameterised by a set of vertices.</span>

<span class="sd">    TODO: Check if the verticies need to be defined in a specific way, based on</span>
<span class="sd">    the methods this looks like the case (ie, ordered).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    vertices: Array, meters</span>
<span class="sd">        The location of the vertices of the aperture.</span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a tranmissive</span>
<span class="sd">        aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vertices</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">vertices</span>    <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                 <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;IrregularPolygonalAperture&quot;</span>
                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the IrregularPolygonalAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vertices: Array, meters</span>
<span class="sd">            The location of the vertices of the aperture.</span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        rotation: Array, radians = np.array(0.)</span>
<span class="sd">            The clockwise rotation of the aperture.</span>
<span class="sd">        occulting: bool = False</span>
<span class="sd">            Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">            tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">        softening: Array, pixels = np.array(1.)</span>
<span class="sd">            The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">            aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">        name: str = &#39;IrregularPolygonalAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                         <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                         <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span>
                         <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_bc_attr_dims</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;vertices&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_grads_from_many_points</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                                <span class="n">xs</span>   <span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
                                <span class="n">ys</span>   <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a set of points, calculate the gradient of the line that connects </span>
<span class="sd">        those points. This function assumes that the points are provided in the </span>
<span class="sd">        order they are to be connected together. Notice that we also assume </span>
<span class="sd">        there are more than two points, but more can be provided in which case </span>
<span class="sd">        the shape is assumed to be closed. The output has the same shape as the </span>
<span class="sd">        input and does not check for infinite (vertical) gradients.</span>

<span class="sd">        Note: Due to the intensly vectorised nature of this code it is ofen </span>
<span class="sd">        necessary to provide the parameters with expanded dimensions. This may </span>
<span class="sd">        be achieved using `x1[:, None, None]` or `x1.reshape((-1, 1, 1))` or </span>
<span class="sd">        `np.expand_dims(x1, (1, 2))`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xs: float, meters</span>
<span class="sd">            The x coordinates of the points that are to be connected. </span>
<span class="sd">        ys: float, meters</span>
<span class="sd">            The y coordinates of the points that are to be connected. </span>
<span class="sd">            Must have the same shape as x. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ms: float</span>
<span class="sd">            The gradients of the lines that connect the vertices. The vertices </span>
<span class="sd">            wrap around to form a closed shape whatever it may look like. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_diffs</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">y_diffs</span> <span class="o">=</span> <span class="n">ys</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y_diffs</span> <span class="o">/</span> <span class="n">x_diffs</span>


    <span class="k">def</span> <span class="nf">_extent</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the largest distance to the outer edge of the aperture from the</span>
<span class="sd">        centre.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        extent : float</span>
<span class="sd">            The maximum distance from the centre to edge of aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
        <span class="n">dist_to_verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">verts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">verts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dist_to_verts</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_soft_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the soft edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The softed edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE: see class docs.</span>
        <span class="n">bc_x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">bc_y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

        <span class="n">bc_x</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
        <span class="n">bc_y</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">bc_y1</span><span class="p">,</span> <span class="n">bc_x1</span><span class="p">)</span>
        <span class="n">offset_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

        <span class="n">sorted_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">offset_theta</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

        <span class="n">sorted_x1</span> <span class="o">=</span> <span class="n">bc_x1</span><span class="p">[</span><span class="n">sorted_inds</span><span class="p">]</span>
        <span class="n">sorted_y1</span> <span class="o">=</span> <span class="n">bc_y1</span><span class="p">[</span><span class="n">sorted_inds</span><span class="p">]</span>
        <span class="n">sorted_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grads_from_many_points</span><span class="p">(</span><span class="n">sorted_x1</span><span class="p">,</span> <span class="n">sorted_y1</span><span class="p">)</span>

        <span class="n">dist_from_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_perp_dists_from_lines</span><span class="p">(</span><span class="n">sorted_m</span><span class="p">,</span> <span class="n">sorted_x1</span><span class="p">,</span> \
            <span class="n">sorted_y1</span><span class="p">,</span> <span class="n">bc_x</span><span class="p">,</span> <span class="n">bc_y</span><span class="p">)</span>  
        <span class="n">dist_sgn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_orig_left_of_edge</span><span class="p">(</span><span class="n">sorted_m</span><span class="p">,</span> <span class="n">sorted_x1</span><span class="p">,</span> <span class="n">sorted_y1</span><span class="p">)</span>
        <span class="n">soft_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="n">dist_sgn</span> <span class="o">*</span> <span class="n">dist_from_edges</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">soft_edges</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_hard_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the hard edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The hard edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE: see class docs.</span>
        <span class="n">bc_x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">bc_y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

        <span class="n">bc_x</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
        <span class="n">bc_y</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">bc_y1</span><span class="p">,</span> <span class="n">bc_x1</span><span class="p">)</span>
        <span class="n">offset_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

        <span class="n">sorted_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">offset_theta</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

        <span class="n">sorted_x1</span> <span class="o">=</span> <span class="n">bc_x1</span><span class="p">[</span><span class="n">sorted_inds</span><span class="p">]</span>
        <span class="n">sorted_y1</span> <span class="o">=</span> <span class="n">bc_y1</span><span class="p">[</span><span class="n">sorted_inds</span><span class="p">]</span>
        <span class="n">sorted_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grads_from_many_points</span><span class="p">(</span><span class="n">sorted_x1</span><span class="p">,</span> <span class="n">sorted_y1</span><span class="p">)</span>

        <span class="n">dist_from_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_perp_dists_from_lines</span><span class="p">(</span><span class="n">sorted_m</span><span class="p">,</span> <span class="n">sorted_x1</span><span class="p">,</span> \
            <span class="n">sorted_y1</span><span class="p">,</span> <span class="n">bc_x</span><span class="p">,</span> <span class="n">bc_y</span><span class="p">)</span>  
        <span class="n">dist_sgn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_orig_left_of_edge</span><span class="p">(</span><span class="n">sorted_m</span><span class="p">,</span> <span class="n">sorted_x1</span><span class="p">,</span> <span class="n">sorted_y1</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">(</span><span class="n">dist_from_edges</span> <span class="o">*</span> <span class="n">dist_sgn</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">edges</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
        <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Irregular Polygonal Aperture&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.IrregularPolygonalAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;IrregularPolygonalAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.IrregularPolygonalAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the IrregularPolygonalAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>vertices</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The location of the vertices of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
          <td>
                <code>np.array(0.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>occulting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Is the aperture occulting or tranmissive. False results in a 
tranmissive aperture, and True results in an occulting aperture.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;IrregularPolygonalAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">vertices</span>    <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
             <span class="n">occulting</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
             <span class="n">softening</span>   <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;IrregularPolygonalAperture&quot;</span>
             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the IrregularPolygonalAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vertices: Array, meters</span>
<span class="sd">        The location of the vertices of the aperture.</span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians = np.array(0.)</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    occulting: bool = False</span>
<span class="sd">        Is the aperture occulting or tranmissive. False results in a </span>
<span class="sd">        tranmissive aperture, and True results in an occulting aperture.</span>
<span class="sd">    softening: Array, pixels = np.array(1.)</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str = &#39;IrregularPolygonalAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                     <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                     <span class="n">occulting</span> <span class="o">=</span> <span class="n">occulting</span><span class="p">,</span>
                     <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_bc_attr_dims</span><span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;vertices&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.IrregularPolygonalAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.IrregularPolygonalAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>
    <span class="n">transmissive</span> <span class="o">=</span> <span class="s2">&quot;transmissive&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulting</span> <span class="k">else</span> <span class="s2">&quot;occulting&quot;</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="n">transmissive</span><span class="si">}</span><span class="s2"> Irregular Polygonal Aperture&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.IrregularPolygonalAperture"><a class="headerlink" href="#dLux.apertures.IrregularPolygonalAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.IrregularPolygonalAperture.__init__"><a class="headerlink" href="#dLux.apertures.IrregularPolygonalAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.IrregularPolygonalAperture.summary"><a class="headerlink" href="#dLux.apertures.IrregularPolygonalAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<h2 id="static-apertures">Static Apertures<a class="headerlink" href="#static-apertures" title="Permanent link">¤</a></h2>
<p>The inbuild flexibility of the <code>dLux.apertures</code> module is very powerful but unlikely to be needed in most cases. For this reason Dynamic apertures can be turned into static apertures where the array of tranmission values are calculated once, and then kept fixed to avoid re-calculation of the aperture every evaluation.</p>
<details class="info">
<summary>Static Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.StaticAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.AbstractStaticAperture">AbstractStaticAperture</span></code></p>

  
      <p>A class for static pre-calculated apertures, without aberrations. Static
apertures with aberrations can be instantiated using the 
StaticAberratedAberrated class.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>aperture</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The aperture represented as an array.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span>
<span class="normal">3336</span>
<span class="normal">3337</span>
<span class="normal">3338</span>
<span class="normal">3339</span>
<span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StaticAperture</span><span class="p">(</span><span class="n">AbstractStaticAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for static pre-calculated apertures, without aberrations. Static</span>
<span class="sd">    apertures with aberrations can be instantiated using the </span>
<span class="sd">    StaticAberratedAberrated class.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    aperture: Array</span>
<span class="sd">        The aperture represented as an array.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">aperture</span>    <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">npixels</span>     <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                 <span class="n">diameter</span>    <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;StaticAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the StaticAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aperture: ApertureLayer</span>
<span class="sd">            An instance of DynamicAperture. </span>
<span class="sd">        npixels : int = None</span>
<span class="sd">            The number of pixels accross one edge of the aperture.  </span>
<span class="sd">        diameter : float, meters = None</span>
<span class="sd">            The diameter of the aperture in meters. </span>
<span class="sd">        coordinates : Array, meters = None</span>
<span class="sd">            The coordinate system to calculate the aperture on.</span>
<span class="sd">        name: str = &#39;StaticAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">AbstractStaticAperture</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This Aperture is already static, please &quot;</span> <span class="o">+</span> \
                <span class="s2">&quot;provide a dynamic aperture.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="p">(</span><span class="n">CompoundAperture</span><span class="p">,</span> <span class="n">MultiAperture</span><span class="p">))</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aberrated_apertures</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> \
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">AberratedAperture</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This Aperture contains aberrated apertures, &quot;</span> <span class="o">+</span> \
                <span class="s2">&quot;please use the StaticAberratedAperture class.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">aperture</span> <span class="o">=</span> <span class="n">aperture</span><span class="p">,</span> 
                         <span class="n">npixels</span> <span class="o">=</span> <span class="n">npixels</span><span class="p">,</span> 
                         <span class="n">diameter</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">,</span> 
                         <span class="n">coordinates</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">,</span> 
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;Applies a pre-calculated Static Aperture.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.StaticAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">npixels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;StaticAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.StaticAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the StaticAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>aperture</code></td>
          <td>
                <code><span title="dLux.apertures.ApertureLayer">ApertureLayer</span></code>
          </td>
          <td><p>An instance of DynamicAperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels accross one edge of the aperture.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>diameter</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The diameter of the aperture in meters.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>coordinates</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The coordinate system to calculate the aperture on.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;StaticAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">aperture</span>    <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">npixels</span>     <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
             <span class="n">diameter</span>    <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;StaticAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the StaticAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    aperture: ApertureLayer</span>
<span class="sd">        An instance of DynamicAperture. </span>
<span class="sd">    npixels : int = None</span>
<span class="sd">        The number of pixels accross one edge of the aperture.  </span>
<span class="sd">    diameter : float, meters = None</span>
<span class="sd">        The diameter of the aperture in meters. </span>
<span class="sd">    coordinates : Array, meters = None</span>
<span class="sd">        The coordinate system to calculate the aperture on.</span>
<span class="sd">    name: str = &#39;StaticAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">AbstractStaticAperture</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This Aperture is already static, please &quot;</span> <span class="o">+</span> \
            <span class="s2">&quot;provide a dynamic aperture.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="p">(</span><span class="n">CompoundAperture</span><span class="p">,</span> <span class="n">MultiAperture</span><span class="p">))</span> <span class="ow">and</span> \
        <span class="nb">len</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aberrated_apertures</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> \
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">AberratedAperture</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This Aperture contains aberrated apertures, &quot;</span> <span class="o">+</span> \
            <span class="s2">&quot;please use the StaticAberratedAperture class.&quot;</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">aperture</span> <span class="o">=</span> <span class="n">aperture</span><span class="p">,</span> 
                     <span class="n">npixels</span> <span class="o">=</span> <span class="n">npixels</span><span class="p">,</span> 
                     <span class="n">diameter</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">,</span> 
                     <span class="n">coordinates</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">,</span> 
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.StaticAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.StaticAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3338</span>
<span class="normal">3339</span>
<span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;Applies a pre-calculated Static Aperture.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.StaticAperture"><a class="headerlink" href="#dLux.apertures.StaticAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.StaticAperture.__init__"><a class="headerlink" href="#dLux.apertures.StaticAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.StaticAperture.summary"><a class="headerlink" href="#dLux.apertures.StaticAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<h2 id="aberrated-apertures">Aberrated Apertures<a class="headerlink" href="#aberrated-apertures" title="Permanent link">¤</a></h2>
<p>Both dynamic and static apertures can have aberations applied to them using the <code>AberratedAperture</code> class. This class takes an aperture as an argument and then applies a set of basis vectors to the aperture. The basis vectors are derived from the <em>Zernike</em> polynomials and calculated to be orthonormal on all regular-polygon apertures. The underlying aberrations are generated in the aberations module.</p>
<details class="info">
<summary>Aberrated Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.AberratedAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.AbstractAberratedAperture">AbstractAberratedAperture</span></code></p>

  
      <p>A class for generating apertures with aberrations. This class generates the
basis vectors of the aberrations at run time, allowing for the aperture and
aberrations to be recovered simultaneously.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>aperture</code></td>
          <td>
                <code><span title="dLux.apertures.ApertureLayer">ApertureLayer</span></code>
          </td>
          <td><p>The aperture on which the aberration basis is defined.</p></td>
        </tr>
        <tr>
          <td><code>basis</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="dLux.aberrations.Zernike" href="../aberrations/#dLux.aberrations.Zernike">Zernike</a>]</code>
          </td>
          <td><p>A list of basis functions that represent the basis. The exact 
polynomials that are represented will depend on the aperture shape. </p></td>
        </tr>
        <tr>
          <td><code>coefficients</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The amplitude of each basis vector of the aberrations.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AberratedAperture</span><span class="p">(</span><span class="n">AbstractAberratedAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for generating apertures with aberrations. This class generates the</span>
<span class="sd">    basis vectors of the aberrations at run time, allowing for the aperture and</span>
<span class="sd">    aberrations to be recovered simultaneously.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    aperture: ApertureLayer</span>
<span class="sd">        The aperture on which the aberration basis is defined.</span>
<span class="sd">    basis: list[Zernike]</span>
<span class="sd">        A list of basis functions that represent the basis. The exact </span>
<span class="sd">        polynomials that are represented will depend on the aperture shape. </span>
<span class="sd">    coefficients: Array</span>
<span class="sd">        The amplitude of each basis vector of the aberrations.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aperture</span> <span class="p">:</span> <span class="n">ApertureLayer</span>
    <span class="n">basis</span>    <span class="p">:</span> <span class="n">dLux</span><span class="o">.</span><span class="n">aberrations</span><span class="o">.</span><span class="n">ZernikeBasis</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">aperture</span>     <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">noll_inds</span>    <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">coefficients</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;AberratedAperture&quot;</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the AberratedAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aperture: ApertureLayer</span>
<span class="sd">            The aperture on which the aberration basis is defined.</span>
<span class="sd">        noll_inds: List[int]</span>
<span class="sd">            The noll indices are a scheme for indexing the Zernike</span>
<span class="sd">            polynomials. Normally these polynomials have two </span>
<span class="sd">            indices but the noll indices prevent an order to </span>
<span class="sd">            these pairs. All basis can be indexed using the noll</span>
<span class="sd">            indices based on `n` and `m`. </span>
<span class="sd">        coefficients: Array = None</span>
<span class="sd">            The amplitude of each basis vector of the aberrations. If nothing </span>
<span class="sd">            is provided, then the coefficients are set to zero.</span>
<span class="sd">        name: str = &#39;AberratedAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">aperture</span><span class="o">.</span><span class="n">occulting</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AberratedApertures can not be occulting.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">DynamicAperture</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AberratedApertures can not contain Static, &quot;</span> <span class="o">+</span> \
                <span class="s2">&quot;Compound or Multi Apertures. AberratedApertures can be &quot;</span> <span class="o">+</span> \
                <span class="s2">&quot;placed in Compound or Multi Apertures, which can then be &quot;</span> <span class="o">+</span> \
                <span class="s2">&quot;promoted to Static.&quot;</span><span class="p">)</span>

        <span class="c1"># Set Aperture</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span> <span class="o">=</span> <span class="n">aperture</span>

        <span class="c1"># Set Basis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">dLux</span><span class="o">.</span><span class="n">aberrations</span><span class="o">.</span><span class="n">ZernikeBasis</span><span class="p">(</span><span class="n">noll_inds</span><span class="p">)</span>

        <span class="c1"># Initialise the coefficinets</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">noll_inds</span><span class="p">))</span> <span class="k">if</span> <span class="n">coefficients</span> <span class="ow">is</span> <span class="kc">None</span> \
            <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Dimensionality check</span>
        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_bc_attr_dims</span><span class="p">(</span>
            <span class="n">noll_inds</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;coefficients&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the aperture and the abberations to the wavefront.  </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront: Wavefront</span>
<span class="sd">            The wavefront that is passing through the aperture.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront: Wavefront</span>
<span class="sd">            The wavefront after passing through the aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate aperture and opd</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">pixel_coordinates</span>
        <span class="n">opd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="n">aperture</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aperture</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

        <span class="c1"># Calculate and update amplitude and phase</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span> <span class="o">+</span> <span class="n">opd_to_phase</span><span class="p">(</span><span class="n">opd</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">amplitude</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">aperture</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_aperture</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the array representing the aperture on the provided coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : Array, meters</span>
<span class="sd">            The coordinate system to calculate the aperture on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture : Array </span>
<span class="sd">            The array representing the transmission of the aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aperture</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_aperture</span><span class="p">(</span><span class="bp">self</span>     <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                     <span class="n">npixels</span>  <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                     <span class="n">diameter</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the array representing the aperture on a set of coordinates </span>
<span class="sd">        with the specified number of pixels and diameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels accross one edge of the aperture.  </span>
<span class="sd">        diameter : float, meters</span>
<span class="sd">            The diameter of the aperture in meters. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture : Array </span>
<span class="sd">            The array representing the transmission of the aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npixels_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">pixel_scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aperture</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_basis</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the basis vectors of the aperture aberrations on the provided </span>
<span class="sd">        coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : Array, meters</span>
<span class="sd">            The coordinate system to calculate the basis vectors on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the basis vectors of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="o">.</span><span class="n">_normalised_coordinates</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="p">,</span> <span class="n">RegularPolygonalAperture</span><span class="p">):</span>
            <span class="n">ikes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">calculate_basis</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="o">.</span><span class="n">nsides</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ikes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">calculate_basis</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

        <span class="n">is_reg_pol</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="p">,</span> <span class="n">RegularPolygonalAperture</span><span class="p">)</span>
        <span class="n">is_circ</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="p">,</span> <span class="n">CircularAperture</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_circ</span> <span class="ow">or</span> <span class="n">is_reg_pol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ikes</span>

        <span class="n">aperture</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aperture</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="n">ikes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthonormalise</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">ikes</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ikes</span> 


    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">self</span>     <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                  <span class="n">npixels</span>  <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                  <span class="n">diameter</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the basis vectors of the aperture aberrations on the provided </span>
<span class="sd">        coordinates with the specified number of pixels and diameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels accross one edge of the aperture.  </span>
<span class="sd">        diameter : float, meters</span>
<span class="sd">            The diameter of the aperture in meters. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the basis vectors of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npixels_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">pixel_scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the total optical path difference of the aperture aberrations </span>
<span class="sd">        on the provided coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : Array, meters</span>
<span class="sd">            The coordinate system to calculate the opd on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the total opd of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">basis</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">npixels</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">diameter</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the total optical path difference of the aperture aberrations </span>
<span class="sd">        on the provided coordinates with the specified number of pixels and </span>
<span class="sd">        diameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            The number of pixels accross one edge of the aperture.  </span>
<span class="sd">        diameter : float, meters</span>
<span class="sd">            The diameter of the aperture in meters. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the total opd of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">npixels_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">pixel_scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_orthonormalise</span><span class="p">(</span><span class="bp">self</span>     <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                        <span class="n">aperture</span> <span class="p">:</span> <span class="n">Array</span><span class="p">,</span> 
                        <span class="n">zernikes</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Orthonomalises the zernike polynomials on the aperture.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aperture : Array</span>
<span class="sd">            An array representing the aperture.</span>
<span class="sd">        zernikes : Array</span>
<span class="sd">            The zernike polynomials to orthonormalise on the aperture.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array</span>
<span class="sd">            The orthonormalised zernike polynomials evaluated on the aperture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pixel_area</span> <span class="o">=</span> <span class="n">aperture</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">zernikes</span><span class="o">.</span><span class="n">shapediameter</span>
        <span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">aperture</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">):</span>
            <span class="n">intermediate</span> <span class="o">=</span> <span class="n">zernikes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">aperture</span>
            <span class="n">coefficient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nterms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

            <span class="n">coefficient</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">pixel_area</span> <span class="o">*</span> \
                <span class="p">(</span><span class="n">zernikes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">basis</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="n">aperture</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>\
                <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 

            <span class="n">intermediate</span> <span class="o">+=</span> <span class="p">(</span><span class="n">coefficient</span> <span class="o">*</span> <span class="n">basis</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

            <span class="n">basis</span> <span class="o">=</span> <span class="n">basis</span>\
                <span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>\
                <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">intermediate</span> <span class="o">/</span> \
                    <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">intermediate</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">pixel_area</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">basis</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">,</span> <span class="n">sigfigs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">summary</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span><span class="si">}</span><span class="s2"> aberrations.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.AberratedAperture.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.apertures.AberratedAperture.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Apply the aperture and the abberations to the wavefront.  </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code><span title="dLux.apertures.Wavefront">Wavefront</span></code>
          </td>
          <td><p>The wavefront that is passing through the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="dLux.apertures.Wavefront">Wavefront</span></code>
          </td>
          <td><p>The wavefront after passing through the aperture.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the aperture and the abberations to the wavefront.  </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront: Wavefront</span>
<span class="sd">        The wavefront that is passing through the aperture.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront: Wavefront</span>
<span class="sd">        The wavefront after passing through the aperture.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate aperture and opd</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">pixel_coordinates</span>
    <span class="n">opd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
    <span class="n">aperture</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aperture</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

    <span class="c1"># Calculate and update amplitude and phase</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span> <span class="o">+</span> <span class="n">opd_to_phase</span><span class="p">(</span><span class="n">opd</span><span class="p">,</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>
    <span class="n">amplitude</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">aperture</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.AberratedAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">noll_inds</span><span class="p">,</span> <span class="n">coefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;AberratedAperture&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#dLux.apertures.AberratedAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the AberratedAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>aperture</code></td>
          <td>
                <code><span title="dLux.apertures.ApertureLayer">ApertureLayer</span></code>
          </td>
          <td><p>The aperture on which the aberration basis is defined.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>noll_inds</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The noll indices are a scheme for indexing the Zernike
polynomials. Normally these polynomials have two 
indices but the noll indices prevent an order to 
these pairs. All basis can be indexed using the noll
indices based on <code>n</code> and <code>m</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>coefficients</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The amplitude of each basis vector of the aberrations. If nothing 
is provided, then the coefficients are set to zero.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;AberratedAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">aperture</span>     <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">noll_inds</span>    <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">coefficients</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;AberratedAperture&quot;</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the AberratedAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    aperture: ApertureLayer</span>
<span class="sd">        The aperture on which the aberration basis is defined.</span>
<span class="sd">    noll_inds: List[int]</span>
<span class="sd">        The noll indices are a scheme for indexing the Zernike</span>
<span class="sd">        polynomials. Normally these polynomials have two </span>
<span class="sd">        indices but the noll indices prevent an order to </span>
<span class="sd">        these pairs. All basis can be indexed using the noll</span>
<span class="sd">        indices based on `n` and `m`. </span>
<span class="sd">    coefficients: Array = None</span>
<span class="sd">        The amplitude of each basis vector of the aberrations. If nothing </span>
<span class="sd">        is provided, then the coefficients are set to zero.</span>
<span class="sd">    name: str = &#39;AberratedAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">aperture</span><span class="o">.</span><span class="n">occulting</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AberratedApertures can not be occulting.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">DynamicAperture</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AberratedApertures can not contain Static, &quot;</span> <span class="o">+</span> \
            <span class="s2">&quot;Compound or Multi Apertures. AberratedApertures can be &quot;</span> <span class="o">+</span> \
            <span class="s2">&quot;placed in Compound or Multi Apertures, which can then be &quot;</span> <span class="o">+</span> \
            <span class="s2">&quot;promoted to Static.&quot;</span><span class="p">)</span>

    <span class="c1"># Set Aperture</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span> <span class="o">=</span> <span class="n">aperture</span>

    <span class="c1"># Set Basis</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">dLux</span><span class="o">.</span><span class="n">aberrations</span><span class="o">.</span><span class="n">ZernikeBasis</span><span class="p">(</span><span class="n">noll_inds</span><span class="p">)</span>

    <span class="c1"># Initialise the coefficinets</span>
    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">noll_inds</span><span class="p">))</span> <span class="k">if</span> <span class="n">coefficients</span> <span class="ow">is</span> <span class="kc">None</span> \
        <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Dimensionality check</span>
    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_bc_attr_dims</span><span class="p">(</span>
        <span class="n">noll_inds</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;coefficients&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.AberratedAperture.get_aperture" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_aperture</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span><span class="p">)</span></code>

<a href="#dLux.apertures.AberratedAperture.get_aperture" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute the array representing the aperture on a set of coordinates 
with the specified number of pixels and diameter.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels accross one edge of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>diameter</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The diameter of the aperture in meters.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>aperture</code></td>          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The array representing the transmission of the aperture.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_aperture</span><span class="p">(</span><span class="bp">self</span>     <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">npixels</span>  <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                 <span class="n">diameter</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the array representing the aperture on a set of coordinates </span>
<span class="sd">    with the specified number of pixels and diameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels accross one edge of the aperture.  </span>
<span class="sd">    diameter : float, meters</span>
<span class="sd">        The diameter of the aperture in meters. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    aperture : Array </span>
<span class="sd">        The array representing the transmission of the aperture.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npixels_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">pixel_scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aperture</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.AberratedAperture.get_basis" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_basis</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span><span class="p">)</span></code>

<a href="#dLux.apertures.AberratedAperture.get_basis" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute the basis vectors of the aperture aberrations on the provided 
coordinates with the specified number of pixels and diameter.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels accross one edge of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>diameter</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The diameter of the aperture in meters.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>basis</code></td>          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The array of the basis vectors of the aperture aberrations.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">self</span>     <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
              <span class="n">npixels</span>  <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
              <span class="n">diameter</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the basis vectors of the aperture aberrations on the provided </span>
<span class="sd">    coordinates with the specified number of pixels and diameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels accross one edge of the aperture.  </span>
<span class="sd">    diameter : float, meters</span>
<span class="sd">        The diameter of the aperture in meters. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    basis : Array </span>
<span class="sd">        The array of the basis vectors of the aperture aberrations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npixels_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">pixel_scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.AberratedAperture.get_opd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_opd</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span><span class="p">)</span></code>

<a href="#dLux.apertures.AberratedAperture.get_opd" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute the total optical path difference of the aperture aberrations 
on the provided coordinates with the specified number of pixels and 
diameter.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels accross one edge of the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>diameter</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The diameter of the aperture in meters.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>basis</code></td>          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The array of the total opd of the aperture aberrations.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">npixels</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">diameter</span> <span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the total optical path difference of the aperture aberrations </span>
<span class="sd">    on the provided coordinates with the specified number of pixels and </span>
<span class="sd">    diameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        The number of pixels accross one edge of the aperture.  </span>
<span class="sd">    diameter : float, meters</span>
<span class="sd">        The diameter of the aperture in meters. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    basis : Array </span>
<span class="sd">        The array of the total opd of the aperture aberrations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npixels_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">pixel_scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.AberratedAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.AberratedAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">,</span> <span class="n">sigfigs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">summary</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span><span class="si">}</span><span class="s2"> aberrations.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.AberratedAperture"><a class="headerlink" href="#dLux.apertures.AberratedAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.AberratedAperture.__call__"><a class="headerlink" href="#dLux.apertures.AberratedAperture.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.AberratedAperture.__init__"><a class="headerlink" href="#dLux.apertures.AberratedAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.AberratedAperture.get_aperture"><a class="headerlink" href="#dLux.apertures.AberratedAperture.get_aperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.AberratedAperture.get_basis"><a class="headerlink" href="#dLux.apertures.AberratedAperture.get_basis" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.AberratedAperture.get_opd"><a class="headerlink" href="#dLux.apertures.AberratedAperture.get_opd" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.AberratedAperture.summary"><a class="headerlink" href="#dLux.apertures.AberratedAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Static Aberrated Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.StaticAberratedAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.AbstractAberratedAperture">AbstractAberratedAperture</span></code>, <code><span title="dLux.apertures.AbstractStaticAperture">AbstractStaticAperture</span></code></p>

  
      <p>A class for static pre-calculated apertures with aberrations. This 
pre-calcaultes both the aperture and the basis at init time and can not 
have the aperture properties optimised.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>aperture</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The aperture represented as an array.</p></td>
        </tr>
        <tr>
          <td><code>basis</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The basis represented as an array.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3365</span>
<span class="normal">3366</span>
<span class="normal">3367</span>
<span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span>
<span class="normal">3372</span>
<span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span>
<span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span>
<span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span>
<span class="normal">3464</span>
<span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span>
<span class="normal">3470</span>
<span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span>
<span class="normal">3488</span>
<span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span>
<span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StaticAberratedAperture</span><span class="p">(</span><span class="n">AbstractAberratedAperture</span><span class="p">,</span> <span class="n">AbstractStaticAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for static pre-calculated apertures with aberrations. This </span>
<span class="sd">    pre-calcaultes both the aperture and the basis at init time and can not </span>
<span class="sd">    have the aperture properties optimised.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    aperture: Array</span>
<span class="sd">        The aperture represented as an array.</span>
<span class="sd">    basis: Array </span>
<span class="sd">        The basis represented as an array.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basis</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">aperture</span>    <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">npixels</span>     <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                 <span class="n">diameter</span>    <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;StaticAberratedAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the StaticAberratedAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aperture: AberratedAperture</span>
<span class="sd">            An instance of AberratedAperture. </span>
<span class="sd">        npixels : int = None</span>
<span class="sd">            The number of pixels accross one edge of the aperture.  </span>
<span class="sd">        diameter : float, meters = None</span>
<span class="sd">            The diameter of the aperture in meters. </span>
<span class="sd">        coordinates : Array, meters = None</span>
<span class="sd">            The coordinate system to calculate the aperture on.</span>
<span class="sd">        name: str = &#39;StaticAberratedAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ensure correct aperture types</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> 
            <span class="p">(</span><span class="n">AberratedAperture</span><span class="p">,</span> <span class="n">CompoundAperture</span><span class="p">,</span> <span class="n">MultiAperture</span><span class="p">))</span> <span class="ow">and</span> \
                <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="p">(</span><span class="n">CompoundAperture</span><span class="p">,</span> <span class="n">MultiAperture</span><span class="p">))</span> <span class="ow">and</span> \
                    <span class="nb">len</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aberrated_apertures</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided aperture must have aberrations.&quot;</span><span class="p">)</span>

        <span class="c1"># Input check: Coordinates provided</span>
        <span class="k">if</span> <span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
            <span class="p">(</span><span class="n">npixels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">diameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;If coordinates is specified npixels and &quot;</span> <span class="o">+</span> \
                <span class="s2">&quot;diameter can not be provided.&quot;</span><span class="p">)</span>
        <span class="c1"># Input check: Coordinates not provided</span>
        <span class="k">elif</span> <span class="n">coordinates</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> \
            <span class="p">(</span><span class="n">npixels</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">diameter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;both npixels and diameter must be provided.&quot;</span><span class="p">)</span>

        <span class="c1"># Generate coordinates if not provided</span>
        <span class="k">if</span> <span class="n">coordinates</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">npixels_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">pixel_scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">)</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">aperture</span><span class="o">=</span><span class="n">aperture</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span> 
            <span class="n">coefficients</span><span class="o">=</span><span class="n">aperture</span><span class="o">.</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">aperture</span><span class="o">.</span><span class="n">_basis</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the aperture to the wavefront.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavefront: Wavefront</span>
<span class="sd">            The wavefront that is passing through the aperture.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wavefront: Wavefront</span>
<span class="sd">            The wavefront after passing through the aperture</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate and update amplitude and phase</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span> <span class="o">+</span> <span class="n">opd_to_phase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">(),</span> 
                                               <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">amplitude</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span>
        <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_basis</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the basis vectors of the aperture aberrations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : Array, meters</span>
<span class="sd">            The coordinate system to calculate the basis vectors on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the basis vectors of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span>


    <span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the basis vectors of the aperture aberrations.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the basis vectors of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the total optical path difference of the aperture aberrations.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the total opd of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">get_opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the total optical path difference of the aperture aberrations.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the total opd of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">()</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the total optical path difference of the aperture aberrations.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        basis : Array </span>
<span class="sd">            The array of the total opd of the aperture aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a pre-calculated Static Aperture with &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span><span class="si">}</span><span class="s2"> aberrations.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="dLux.apertures.StaticAberratedAperture.opd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">opd</span><span class="p">:</span> <span class="n">Array</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#dLux.apertures.StaticAberratedAperture.opd" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Return the total optical path difference of the aperture aberrations.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>basis</code></td>          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The array of the total opd of the aperture aberrations.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.StaticAberratedAperture.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">wavefront</span><span class="p">)</span></code>

<a href="#dLux.apertures.StaticAberratedAperture.__call__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Apply the aperture to the wavefront.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>wavefront</code></td>
          <td>
                <code><span title="dLux.apertures.Wavefront">Wavefront</span></code>
          </td>
          <td><p>The wavefront that is passing through the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>wavefront</code></td>          <td>
                <code><span title="dLux.apertures.Wavefront">Wavefront</span></code>
          </td>
          <td><p>The wavefront after passing through the aperture</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">wavefront</span> <span class="p">:</span> <span class="n">Wavefront</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Wavefront</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the aperture to the wavefront.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wavefront: Wavefront</span>
<span class="sd">        The wavefront that is passing through the aperture.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wavefront: Wavefront</span>
<span class="sd">        The wavefront after passing through the aperture</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate and update amplitude and phase</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">phase</span> <span class="o">+</span> <span class="n">opd_to_phase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">(),</span> 
                                           <span class="n">wavefront</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>
    <span class="n">amplitude</span> <span class="o">=</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">amplitude</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">aperture</span>
    <span class="k">return</span> <span class="n">wavefront</span><span class="o">.</span><span class="n">set_phasor</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.StaticAberratedAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">npixels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;StaticAberratedAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.StaticAberratedAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the StaticAberratedAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>aperture</code></td>
          <td>
                <code><span title="dLux.apertures.ApertureLayer">ApertureLayer</span></code>
          </td>
          <td><p>An instance of AberratedAperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of pixels accross one edge of the aperture.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>diameter</code></td>
          <td>
                <code>float, meters</code>
          </td>
          <td><p>The diameter of the aperture in meters.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>coordinates</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The coordinate system to calculate the aperture on.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;StaticAberratedAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span>
<span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">aperture</span>    <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">npixels</span>     <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
             <span class="n">diameter</span>    <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;StaticAberratedAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the StaticAberratedAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    aperture: AberratedAperture</span>
<span class="sd">        An instance of AberratedAperture. </span>
<span class="sd">    npixels : int = None</span>
<span class="sd">        The number of pixels accross one edge of the aperture.  </span>
<span class="sd">    diameter : float, meters = None</span>
<span class="sd">        The diameter of the aperture in meters. </span>
<span class="sd">    coordinates : Array, meters = None</span>
<span class="sd">        The coordinate system to calculate the aperture on.</span>
<span class="sd">    name: str = &#39;StaticAberratedAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure correct aperture types</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> 
        <span class="p">(</span><span class="n">AberratedAperture</span><span class="p">,</span> <span class="n">CompoundAperture</span><span class="p">,</span> <span class="n">MultiAperture</span><span class="p">))</span> <span class="ow">and</span> \
            <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="p">(</span><span class="n">CompoundAperture</span><span class="p">,</span> <span class="n">MultiAperture</span><span class="p">))</span> <span class="ow">and</span> \
                <span class="nb">len</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">_aberrated_apertures</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided aperture must have aberrations.&quot;</span><span class="p">)</span>

    <span class="c1"># Input check: Coordinates provided</span>
    <span class="k">if</span> <span class="n">coordinates</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
        <span class="p">(</span><span class="n">npixels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">diameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;If coordinates is specified npixels and &quot;</span> <span class="o">+</span> \
            <span class="s2">&quot;diameter can not be provided.&quot;</span><span class="p">)</span>
    <span class="c1"># Input check: Coordinates not provided</span>
    <span class="k">elif</span> <span class="n">coordinates</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> \
        <span class="p">(</span><span class="n">npixels</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">diameter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;both npixels and diameter must be provided.&quot;</span><span class="p">)</span>

    <span class="c1"># Generate coordinates if not provided</span>
    <span class="k">if</span> <span class="n">coordinates</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">npixels_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">pixel_scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">,</span> <span class="n">diameter</span> <span class="o">/</span> <span class="n">npixels</span><span class="p">)</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">get_pixel_positions</span><span class="p">(</span><span class="n">npixels_in</span><span class="p">,</span> <span class="n">pixel_scales</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">aperture</span><span class="o">=</span><span class="n">aperture</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="p">,</span> 
        <span class="n">coefficients</span><span class="o">=</span><span class="n">aperture</span><span class="o">.</span><span class="n">coefficients</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">aperture</span><span class="o">.</span><span class="n">_basis</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.StaticAberratedAperture.get_basis" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_basis</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#dLux.apertures.StaticAberratedAperture.get_basis" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute the basis vectors of the aperture aberrations.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>basis</code></td>          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The array of the basis vectors of the aperture aberrations.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_basis</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the basis vectors of the aperture aberrations.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    basis : Array </span>
<span class="sd">        The array of the basis vectors of the aperture aberrations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basis</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.StaticAberratedAperture.get_opd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_opd</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#dLux.apertures.StaticAberratedAperture.get_opd" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute the total optical path difference of the aperture aberrations.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>basis</code></td>          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The array of the total opd of the aperture aberrations.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_opd</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the total optical path difference of the aperture aberrations.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    basis : Array </span>
<span class="sd">        The array of the total opd of the aperture aberrations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opd</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.StaticAberratedAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.StaticAberratedAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a pre-calculated Static Aperture with &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">)</span><span class="si">}</span><span class="s2"> aberrations.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.StaticAberratedAperture"><a class="headerlink" href="#dLux.apertures.StaticAberratedAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="attr" id="dLux.apertures.StaticAberratedAperture.opd"><a class="headerlink" href="#dLux.apertures.StaticAberratedAperture.opd" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.StaticAberratedAperture.__call__"><a class="headerlink" href="#dLux.apertures.StaticAberratedAperture.__call__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.StaticAberratedAperture.__init__"><a class="headerlink" href="#dLux.apertures.StaticAberratedAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.StaticAberratedAperture.get_basis"><a class="headerlink" href="#dLux.apertures.StaticAberratedAperture.get_basis" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.StaticAberratedAperture.get_opd"><a class="headerlink" href="#dLux.apertures.StaticAberratedAperture.get_opd" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.StaticAberratedAperture.summary"><a class="headerlink" href="#dLux.apertures.StaticAberratedAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<h2 id="composite-apertures">Composite Apertures<a class="headerlink" href="#composite-apertures" title="Permanent link">¤</a></h2>
<p>The Composite apertures are designed to take in a series of dynamic aperture and combine them to create arbirary aperture shapes. There are two types of composite aperture, Compound and Multi apertures. The CompoundAperture is used to combine apertures that are overlapping, and the MultiAperture is used to combine apertures that are not overlapping. For example if we wanted to create a HST-like aperture we would combine an annular aperture with a spiders class. If we wanted to create an aperture mask, we would combine a series of circular apertures in a MultiAperture class.</p>
<details class="info">
<summary>Compound Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.CompoundAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.CompositeAperture">CompositeAperture</span></code></p>

  
      <p>A  class used to combine multiple apertures into a single coherent aperture.
An example would be an aperture with spiders holding a secondary mirror.</p>
<p>This class is distinct from the MultiAperture class in that the 
sub-apertures are combined by mulitplying their respective tranmissions 
together, ie the sub-apertures are overlapping.</p>
<p>This class should not contain a MulitAperture, but MultiApertures can 
contain CompoundApertures.</p>
<p>A single aberrated aperture can be placed into the set of apertures.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>apertures</code></td>
          <td>
                <code>dict(str, Aperture)</code>
          </td>
          <td><p>The sub-apertures that make up the full aperture.</p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, radians</code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CompoundAperture</span><span class="p">(</span><span class="n">CompositeAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A  class used to combine multiple apertures into a single coherent aperture.</span>
<span class="sd">    An example would be an aperture with spiders holding a secondary mirror.</span>

<span class="sd">    This class is distinct from the MultiAperture class in that the </span>
<span class="sd">    sub-apertures are combined by mulitplying their respective tranmissions </span>
<span class="sd">    together, ie the sub-apertures are overlapping.</span>

<span class="sd">    This class should not contain a MulitAperture, but MultiApertures can </span>
<span class="sd">    contain CompoundApertures.</span>

<span class="sd">    A single aberrated aperture can be placed into the set of apertures.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    apertures: dict(str, Aperture)</span>
<span class="sd">        The sub-apertures that make up the full aperture.</span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span>
                 <span class="n">apertures</span>   <span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;CompoundAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the CompoundAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        apertures: list[Aperture]</span>
<span class="sd">            The sub-apertures that make up the full aperture.</span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        rotation: Array, radians = np.array(0.)</span>
<span class="sd">            The clockwise rotation of the aperture.</span>
<span class="sd">        name: str = &#39;CompoundAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check for more than one aberration</span>
        <span class="n">naberrated</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">aperture</span> <span class="ow">in</span> <span class="n">apertures</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">CompositeAperture</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CompositeApertures cannot be nested. To &quot;</span> <span class="o">+</span>\
                    <span class="s2">&quot;combine multiple CompositeApertures, use MultiAperture.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">AberratedAperture</span><span class="p">):</span>
                <span class="n">naberrated</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">naberrated</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CompoundAperture can only have one &quot;</span> <span class="o">+</span> \
                             <span class="s2">&quot;AberratedAperture.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">apertures</span><span class="p">,</span>
                         <span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span>
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span>
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                         <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_aperture</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the array representing the aperture on the provided coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : Array, meters</span>
<span class="sd">            The coordinate system to calculate the aperture on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture : Array </span>
<span class="sd">            The array representing the transmission of the combined </span>
<span class="sd">            sub-apertures. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stacked_apertures</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aps</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Applies a Compound Aperture with the following &quot;</span>
                   <span class="s2">&quot;sub-apertures: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">apertures</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">ap_summary</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">,</span> <span class="n">sigfigs</span><span class="p">)</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="n">ap_summary</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.CompoundAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">apertures</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CompoundAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.CompoundAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the CompoundAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>apertures</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>The sub-apertures that make up the full aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
          <td>
                <code>np.array(0.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;CompoundAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span>
             <span class="n">apertures</span>   <span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;CompoundAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the CompoundAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    apertures: list[Aperture]</span>
<span class="sd">        The sub-apertures that make up the full aperture.</span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians = np.array(0.)</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    name: str = &#39;CompoundAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check for more than one aberration</span>
    <span class="n">naberrated</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">aperture</span> <span class="ow">in</span> <span class="n">apertures</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">CompositeAperture</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CompositeApertures cannot be nested. To &quot;</span> <span class="o">+</span>\
                <span class="s2">&quot;combine multiple CompositeApertures, use MultiAperture.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aperture</span><span class="p">,</span> <span class="n">AberratedAperture</span><span class="p">):</span>
            <span class="n">naberrated</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">naberrated</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CompoundAperture can only have one &quot;</span> <span class="o">+</span> \
                         <span class="s2">&quot;AberratedAperture.&quot;</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">apertures</span><span class="p">,</span>
                     <span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span>
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span>
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                     <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.CompoundAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.CompoundAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Applies a Compound Aperture with the following &quot;</span>
               <span class="s2">&quot;sub-apertures: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">apertures</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">ap_summary</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">,</span> <span class="n">sigfigs</span><span class="p">)</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="n">ap_summary</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.CompoundAperture"><a class="headerlink" href="#dLux.apertures.CompoundAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.CompoundAperture.__init__"><a class="headerlink" href="#dLux.apertures.CompoundAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.CompoundAperture.summary"><a class="headerlink" href="#dLux.apertures.CompoundAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<details class="info">
<summary>Multi Aperture API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.MultiAperture"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.CompositeAperture">CompositeAperture</span></code></p>

  
      <p>A  class used to combine multiple apertures into a single coherent aperture.
An example would be an aperture mask.</p>
<p>This class is distinct from the CompoundAperture class in that the 
sub-apertures are combined by adding their respective tranmissions 
together, ie the sub-apertures are not overlapping.</p>
<p>This class can contain multiple CompoundApertures.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>apertures</code></td>
          <td>
                <code>dict(str, Aperture)</code>
          </td>
          <td><p>The sub-apertures that make up the full aperture.</p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, radians</code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span>
<span class="normal">3140</span>
<span class="normal">3141</span>
<span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MultiAperture</span><span class="p">(</span><span class="n">CompositeAperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A  class used to combine multiple apertures into a single coherent aperture.</span>
<span class="sd">    An example would be an aperture mask.</span>

<span class="sd">    This class is distinct from the CompoundAperture class in that the </span>
<span class="sd">    sub-apertures are combined by adding their respective tranmissions </span>
<span class="sd">    together, ie the sub-apertures are not overlapping.</span>

<span class="sd">    This class can contain multiple CompoundApertures.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    apertures: dict(str, Aperture)</span>
<span class="sd">        The sub-apertures that make up the full aperture.</span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span>
                 <span class="n">apertures</span>   <span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                 <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
                 <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;MultiAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the MultiAperture class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        apertures: list[Aperture]</span>
<span class="sd">            The sub-apertures that make up the full aperture.</span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        rotation: Array, radians = np.array(0.)</span>
<span class="sd">            The clockwise rotation of the aperture.</span>
<span class="sd">        name: str = &#39;MultiAperture&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">apertures</span><span class="p">,</span>
                         <span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span>
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span>
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                         <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_aperture</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the array representing the aperture on the provided coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : Array, meters</span>
<span class="sd">            The coordinate system to calculate the aperture on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture : Array </span>
<span class="sd">            The array representing the transmission of the combined </span>
<span class="sd">            sub-apertures. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stacked_apertures</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aps</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_aberrated_apertures</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the individual apertures with aberrations.</span>
<span class="sd">        Note: This method returns CompoundApertures if it contains apertures</span>
<span class="sd">        with aberrations in them.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        apertures: list[Union[AberratedAperture, CompoundAperture]]</span>
<span class="sd">            The list of apertures with aberrations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define leaf fn</span>
        <span class="k">def</span> <span class="nf">is_aberrated</span><span class="p">(</span><span class="n">leaf</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">AberratedAperture</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">CompoundAperture</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">leaf</span><span class="o">.</span><span class="n">_aberrated_apertures</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Get aberrated apertures</span>
        <span class="n">filter_map</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="n">is_aberrated</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apertures</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_aberrated</span><span class="p">)</span>
        <span class="n">aberrated</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apertures</span><span class="p">,</span> <span class="n">filter_map</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tree_flatten</span><span class="p">(</span><span class="n">aberrated</span><span class="p">,</span> <span class="n">is_leaf</span><span class="o">=</span><span class="n">is_aberrated</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Applies a Multi Aperture with the following &quot;</span>
                   <span class="s2">&quot;sub-apertures: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">apertures</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">ap_summary</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">,</span> <span class="n">sigfigs</span><span class="p">)</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="n">ap_summary</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.MultiAperture.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">apertures</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;MultiAperture&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.MultiAperture.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the MultiAperture class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>apertures</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>The sub-apertures that make up the full aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
          <td>
                <code>np.array(0.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;MultiAperture&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>        <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span>
             <span class="n">apertures</span>   <span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
             <span class="n">centre</span>      <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
             <span class="n">shear</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span> <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">rotation</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
             <span class="n">name</span>        <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;MultiAperture&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the MultiAperture class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    apertures: list[Aperture]</span>
<span class="sd">        The sub-apertures that make up the full aperture.</span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians = np.array(0.)</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    name: str = &#39;MultiAperture&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">apertures</span><span class="p">,</span>
                     <span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span>
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span>
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                     <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.MultiAperture.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.MultiAperture.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3139</span>
<span class="normal">3140</span>
<span class="normal">3141</span>
<span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Applies a Multi Aperture with the following &quot;</span>
               <span class="s2">&quot;sub-apertures: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">apertures</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">ap_summary</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">,</span> <span class="n">sigfigs</span><span class="p">)</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="n">ap_summary</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.MultiAperture"><a class="headerlink" href="#dLux.apertures.MultiAperture" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.MultiAperture.__init__"><a class="headerlink" href="#dLux.apertures.MultiAperture.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.MultiAperture.summary"><a class="headerlink" href="#dLux.apertures.MultiAperture.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<h2 id="spiders">Spiders<a class="headerlink" href="#spiders" title="Permanent link">¤</a></h2>
<p>The spiders class are just a specific parametrisation of rectangular apertures for simplicity.</p>
<details class="info">
<summary>Uniform Spider API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.UniformSpider"></a>
  <div class="doc doc-contents first">
      <p class="doc doc-class-bases">
        Bases: <code><span title="dLux.apertures.Spider">Spider</span></code></p>

  
      <p>A set of spider struts with equally-spaced, equal-width struts.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nstruts</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of spider struts.</p></td>
        </tr>
        <tr>
          <td><code>strut_width</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The width of each strut. </p></td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, meters</code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture. </p></td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, radians</code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span>, pixels</code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">UniformSpider</span><span class="p">(</span><span class="n">Spider</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of spider struts with equally-spaced, equal-width struts.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    nstruts: int </span>
<span class="sd">        The number of spider struts.</span>
<span class="sd">    strut_width: Array, meters</span>
<span class="sd">        The width of each strut. </span>
<span class="sd">    centre: Array, meters</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    softening: Array, pixels</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nstruts</span>     <span class="p">:</span> <span class="nb">int</span>
    <span class="n">strut_width</span> <span class="p">:</span> <span class="n">Array</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
                 <span class="n">nstruts</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">strut_width</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
                 <span class="n">centre</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
                 <span class="n">shear</span>        <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
                 <span class="n">compression</span>  <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                 <span class="n">rotation</span>     <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">softening</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                 <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;UniformSpider&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the UniformSpider class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nstruts: int </span>
<span class="sd">            The number of struts to equally space around the circle. This is not </span>
<span class="sd">            a differentiable parameter. </span>
<span class="sd">        strut_width: Array, meters</span>
<span class="sd">            The width of each strut. </span>
<span class="sd">        centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">            The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">        shear: Array = np.array([0., 0.])</span>
<span class="sd">            The (x, y) linear shear of the aperutre.</span>
<span class="sd">        compression: Array  = np.array([1., 1.]) </span>
<span class="sd">            The (x, y) compression of the aperture. </span>
<span class="sd">        rotation: Array, radians = np.array(0.)</span>
<span class="sd">            The clockwise rotation of the aperture.</span>
<span class="sd">        softening: Array, pixels = np.array(1.)</span>
<span class="sd">            The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">            aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">        name: str = &#39;UniformSpider&#39;</span>
<span class="sd">            The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                         <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                         <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                         <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                         <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                         <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nstruts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nstruts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strut_width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">strut_width</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">(</span>
            <span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">strut_width</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;Width_of_struts&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_stacked_struts</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates an array of individual struts comprising the full spider </span>
<span class="sd">        aperture on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinate system to calculate the struts on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        struts: Array</span>
<span class="sd">            The array of all the individual struts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coordinates</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">two_pi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nstruts</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">angles</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span>
        <span class="k">return</span> <span class="n">vmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_strut</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span><span class="n">angles</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span> 


    <span class="k">def</span> <span class="nf">_soft_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the soft edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The softed edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">struts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stacked_struts</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">strut_width</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="n">softened</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_soften</span><span class="p">(</span><span class="n">struts</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">softened</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_hard_edged</span><span class="p">(</span><span class="bp">self</span> <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> <span class="n">coordinates</span> <span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtes the hard edged aperture shape on the input coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates: Array, meters</span>
<span class="sd">            The coordinates to calculate the aperture shape on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture: Array</span>
<span class="sd">            The hard edged aperture shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">struts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stacked_struts</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">strut_width</span> <span class="o">/</span> <span class="mf">2.</span> 
        <span class="k">return</span> <span class="n">struts</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
                <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
                <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
                <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a summary of the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angular_units : str = &#39;radians&#39;</span>
<span class="sd">            The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">            &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">        cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">            The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">            &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">        sigfigs : int = 4</span>
<span class="sd">            The number of significant figures to use in the summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : str</span>
<span class="sd">            A summary of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strut_width</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
        <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nstrut</span><span class="si">}</span><span class="s2"> strut spider with widths </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> &quot;</span>
                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
            <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.UniformSpider.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nstruts</span><span class="p">,</span> <span class="n">strut_width</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">shear</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">compression</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">softening</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;UniformSpider&#39;</span><span class="p">)</span></code>

<a href="#dLux.apertures.UniformSpider.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructor for the UniformSpider class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nstruts</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of struts to equally space around the circle. This is not 
a differentiable parameter.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>strut_width</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The width of each strut.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centre</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) coordinates of the centre of the aperture.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>shear</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) linear shear of the aperutre.</p></td>
          <td>
                <code>np.array([0.0, 0.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>compression</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The (x, y) compression of the aperture.</p></td>
          <td>
                <code>np.array([1.0, 1.0])</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The clockwise rotation of the aperture.</p></td>
          <td>
                <code>np.array(0.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>softening</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The approximate pixel width of the soft boundary applied to the 
aperture. Hard edges can be achieved by setting the softening to 0.</p></td>
          <td>
                <code>np.array(1.0)</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the layer, which is used to index the layers dictionary.</p></td>
          <td>
                <code>&#39;UniformSpider&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>         <span class="p">:</span> <span class="n">ApertureLayer</span><span class="p">,</span> 
             <span class="n">nstruts</span>      <span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">strut_width</span>  <span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
             <span class="n">centre</span>       <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span> 
             <span class="n">shear</span>        <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]),</span>
             <span class="n">compression</span>  <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
             <span class="n">rotation</span>     <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span>
             <span class="n">softening</span>    <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
             <span class="n">name</span>         <span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s2">&quot;UniformSpider&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApertureLayer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for the UniformSpider class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nstruts: int </span>
<span class="sd">        The number of struts to equally space around the circle. This is not </span>
<span class="sd">        a differentiable parameter. </span>
<span class="sd">    strut_width: Array, meters</span>
<span class="sd">        The width of each strut. </span>
<span class="sd">    centre: Array, meters = np.array([0., 0.])</span>
<span class="sd">        The (x, y) coordinates of the centre of the aperture.</span>
<span class="sd">    shear: Array = np.array([0., 0.])</span>
<span class="sd">        The (x, y) linear shear of the aperutre.</span>
<span class="sd">    compression: Array  = np.array([1., 1.]) </span>
<span class="sd">        The (x, y) compression of the aperture. </span>
<span class="sd">    rotation: Array, radians = np.array(0.)</span>
<span class="sd">        The clockwise rotation of the aperture.</span>
<span class="sd">    softening: Array, pixels = np.array(1.)</span>
<span class="sd">        The approximate pixel width of the soft boundary applied to the </span>
<span class="sd">        aperture. Hard edges can be achieved by setting the softening to 0.</span>
<span class="sd">    name: str = &#39;UniformSpider&#39;</span>
<span class="sd">        The name of the layer, which is used to index the layers dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span><span class="p">,</span> 
                     <span class="n">shear</span> <span class="o">=</span> <span class="n">shear</span><span class="p">,</span> 
                     <span class="n">compression</span> <span class="o">=</span> <span class="n">compression</span><span class="p">,</span>
                     <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">,</span>
                     <span class="n">softening</span> <span class="o">=</span> <span class="n">softening</span><span class="p">,</span>
                     <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">nstruts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nstruts</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strut_width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">strut_width</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">dLux</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">validate_eq_attr_dims</span><span class="p">(</span>
        <span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">strut_width</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;Width_of_struts&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.UniformSpider.summary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summary</span><span class="p">(</span><span class="n">angular_units</span><span class="o">=</span><span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#dLux.apertures.UniformSpider.summary" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns a summary of the class.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>angular_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The angular units to use in the summary. Options are 'radians', 
'degrees', 'arcseconds' and 'arcminutes'.</p></td>
          <td>
                <code>&#39;radians&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cartesian_units</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The cartesian units to use in the summary. Options are 'meters',
'millimeters' and 'microns'.</p></td>
          <td>
                <code>&#39;meters&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>sigfigs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of significant figures to use in the summary.</p></td>
          <td>
                <code>4</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>A summary of the class.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span>            <span class="p">:</span> <span class="n">OpticalLayer</span><span class="p">,</span> 
            <span class="n">angular_units</span>   <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> 
            <span class="n">cartesian_units</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
            <span class="n">sigfigs</span>         <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a summary of the class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angular_units : str = &#39;radians&#39;</span>
<span class="sd">        The angular units to use in the summary. Options are &#39;radians&#39;, </span>
<span class="sd">        &#39;degrees&#39;, &#39;arcseconds&#39; and &#39;arcminutes&#39;.</span>
<span class="sd">    cartesian_units : str = &#39;meters&#39;</span>
<span class="sd">        The cartesian units to use in the summary. Options are &#39;meters&#39;,</span>
<span class="sd">        &#39;millimeters&#39; and &#39;microns&#39;.</span>
<span class="sd">    sigfigs : int = 4</span>
<span class="sd">        The number of significant figures to use in the summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : str</span>
<span class="sd">        A summary of the class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strut_width</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">convert_cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">cartesian_units</span><span class="p">)</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">convert_angular</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span> <span class="s1">&#39;radians&#39;</span><span class="p">,</span> <span class="n">angular_units</span><span class="p">)</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applies a </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nstrut</span><span class="si">}</span><span class="s2"> strut spider with widths </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> &quot;</span>
               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cartesian_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">softening</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; softened by ~</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">softening</span><span class="si">}</span><span class="s2"> pixels&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; centred at </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; rotated by </span><span class="si">{</span><span class="n">rotation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">angular_units</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; sheared by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compression</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
        <span class="n">summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; compressed by </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">compression</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">summary</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.UniformSpider"><a class="headerlink" href="#dLux.apertures.UniformSpider" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.UniformSpider.__init__"><a class="headerlink" href="#dLux.apertures.UniformSpider.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.UniformSpider.summary"><a class="headerlink" href="#dLux.apertures.UniformSpider.summary" title="Permanent link">¤</a></h2>
</div>
</details>
<h1 id="usage-and-examples">Usage and Examples<a class="headerlink" href="#usage-and-examples" title="Permanent link">¤</a></h1>
<p>Now let's write some code. We can create a basic circular aperture at the centre of the coordinate system with a 1m radius like so:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">dLux</span> <span class="k">as</span> <span class="nn">dl</span>

<span class="n">apertures</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">dl</span><span class="o">.</span><span class="n">CircularAperture</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
    <span class="n">dl</span><span class="o">.</span><span class="n">CircularAperture</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">centre</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">]),</span>
    <span class="n">dl</span><span class="o">.</span><span class="n">CircularAperture</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">shear</span><span class="o">=</span><span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.05</span><span class="p">]),</span>
    <span class="n">dl</span><span class="o">.</span><span class="n">CircularAperture</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="p">[</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">]),</span>
    <span class="n">dl</span><span class="o">.</span><span class="n">CircularAperture</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
    <span class="n">dl</span><span class="o">.</span><span class="n">CircularAperture</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div>
<details class="abstract">
<summary>Plotting code</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">apertures</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">apertures</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_aperture</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;assets/apertures.png&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<p><img alt="apertures" src="../../assets/apertures.png" /></p>
<h2 id="aperture-factory">Aperture Factory<a class="headerlink" href="#aperture-factory" title="Permanent link">¤</a></h2>
<p>Most users will not need to use the dynamic apertures, so the <code>ApertureFactory</code> class is designed to provide a simple interface to generate the most common apertures. It is able to construct hard-edged circular or regular poygonal apertures. Secondary mirrors obscurations with the same aperture shape can be constructed, along with uniformly spaced struts. Aberrations can also be applied to the aperture. The ratio of the primary aperture opening to the array size is determined by the aperture_ratio parameter, with secondary mirror obscurations and struts being scaled relative to the aperture diameter.</p>
<details class="info">
<summary>Aperture Factory API</summary>
<div class="mkdocstrings">

<div class="doc doc-object doc-class">


<a id="dLux.apertures.ApertureFactory"></a>
  <div class="doc doc-contents first">

  
      <p>This class is not actually ever instatiated, but is rather a class used to 
give a simple constructor interface that is used to construct the most
commonly used apertures. It is able to construct hard-edged circular or 
regular poygonalal apertures. Secondary mirrors obscurations with the same
aperture shape can be constructed, along with uniformly spaced struts. 
Aberrations can also be applied to the aperture. The ratio of the primary
aperture opening to the array size is determined by the <code>aperture_ratio</code>
parameter, with secondary mirror obscurations and struts being scaled
relative to the aperture diameter. </p>
<p>Lets look at an example of how to construct a simple circular aperture with
a secondary mirror obscurtion held by 4 struts and some low-order 
aberrations. For this example lets take a 2m diameter aperutre, with a 20cm 
secondary mirror held by 3 struts with a width of 2cm. In this example the
secondary mirror is 10% of the primary aperture diameter and the struts are
1% of the primary aperture diameter, giving us values of 0.1 and 0.01 for
the <code>secondary_ratio</code> and <code>strut_ratio</code> parameters. Let calcualte this for
a 512x512 array with the aperture spanning the full array.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">dLux</span> <span class="kn">import</span> <span class="n">SimpleAperture</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">jax.random</span> <span class="k">as</span> <span class="nn">jr</span>

<span class="c1"># Construct Zernikes</span>
<span class="n">zernikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">zernikes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>

<span class="c1"># Construct aperture</span>
<span class="n">aperture</span> <span class="o">=</span> <span class="n">SimpleAperture</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">secondary_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">nstruts</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
                          <span class="n">strut_ratio</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">zernikes</span><span class="o">=</span><span class="n">zernikes</span><span class="p">,</span> 
                          <span class="n">coefficients</span><span class="o">=</span><span class="n">coefficients</span><span class="p">)</span>
</code></pre></div>
<p>The resulting aperture class has three parameters, <code>.aperture</code>, <code>.basis</code>
and <code>.coefficients</code>. We can examine the aperture and opd like so:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">aperture</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">opd</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>We can also easily change this to a hexagonal aperture with 3 struts:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Make aperture</span>
<span class="n">aperture</span> <span class="o">=</span> <span class="n">SimpleAperture</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">nsides</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">secondary_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">nstruts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                          <span class="n">strut_ratio</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">zernikes</span><span class="o">=</span><span class="n">zernikes</span><span class="p">,</span> 
                          <span class="n">coefficients</span><span class="o">=</span><span class="n">coefficients</span><span class="p">)</span>

<span class="c1"># Examine</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">aperture</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">opd</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>dLux/apertures.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span>
<span class="normal">3616</span>
<span class="normal">3617</span>
<span class="normal">3618</span>
<span class="normal">3619</span>
<span class="normal">3620</span>
<span class="normal">3621</span>
<span class="normal">3622</span>
<span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span>
<span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span>
<span class="normal">3639</span>
<span class="normal">3640</span>
<span class="normal">3641</span>
<span class="normal">3642</span>
<span class="normal">3643</span>
<span class="normal">3644</span>
<span class="normal">3645</span>
<span class="normal">3646</span>
<span class="normal">3647</span>
<span class="normal">3648</span>
<span class="normal">3649</span>
<span class="normal">3650</span>
<span class="normal">3651</span>
<span class="normal">3652</span>
<span class="normal">3653</span>
<span class="normal">3654</span>
<span class="normal">3655</span>
<span class="normal">3656</span>
<span class="normal">3657</span>
<span class="normal">3658</span>
<span class="normal">3659</span>
<span class="normal">3660</span>
<span class="normal">3661</span>
<span class="normal">3662</span>
<span class="normal">3663</span>
<span class="normal">3664</span>
<span class="normal">3665</span>
<span class="normal">3666</span>
<span class="normal">3667</span>
<span class="normal">3668</span>
<span class="normal">3669</span>
<span class="normal">3670</span>
<span class="normal">3671</span>
<span class="normal">3672</span>
<span class="normal">3673</span>
<span class="normal">3674</span>
<span class="normal">3675</span>
<span class="normal">3676</span>
<span class="normal">3677</span>
<span class="normal">3678</span>
<span class="normal">3679</span>
<span class="normal">3680</span>
<span class="normal">3681</span>
<span class="normal">3682</span>
<span class="normal">3683</span>
<span class="normal">3684</span>
<span class="normal">3685</span>
<span class="normal">3686</span>
<span class="normal">3687</span>
<span class="normal">3688</span>
<span class="normal">3689</span>
<span class="normal">3690</span>
<span class="normal">3691</span>
<span class="normal">3692</span>
<span class="normal">3693</span>
<span class="normal">3694</span>
<span class="normal">3695</span>
<span class="normal">3696</span>
<span class="normal">3697</span>
<span class="normal">3698</span>
<span class="normal">3699</span>
<span class="normal">3700</span>
<span class="normal">3701</span>
<span class="normal">3702</span>
<span class="normal">3703</span>
<span class="normal">3704</span>
<span class="normal">3705</span>
<span class="normal">3706</span>
<span class="normal">3707</span>
<span class="normal">3708</span>
<span class="normal">3709</span>
<span class="normal">3710</span>
<span class="normal">3711</span>
<span class="normal">3712</span>
<span class="normal">3713</span>
<span class="normal">3714</span>
<span class="normal">3715</span>
<span class="normal">3716</span>
<span class="normal">3717</span>
<span class="normal">3718</span>
<span class="normal">3719</span>
<span class="normal">3720</span>
<span class="normal">3721</span>
<span class="normal">3722</span>
<span class="normal">3723</span>
<span class="normal">3724</span>
<span class="normal">3725</span>
<span class="normal">3726</span>
<span class="normal">3727</span>
<span class="normal">3728</span>
<span class="normal">3729</span>
<span class="normal">3730</span>
<span class="normal">3731</span>
<span class="normal">3732</span>
<span class="normal">3733</span>
<span class="normal">3734</span>
<span class="normal">3735</span>
<span class="normal">3736</span>
<span class="normal">3737</span>
<span class="normal">3738</span>
<span class="normal">3739</span>
<span class="normal">3740</span>
<span class="normal">3741</span>
<span class="normal">3742</span>
<span class="normal">3743</span>
<span class="normal">3744</span>
<span class="normal">3745</span>
<span class="normal">3746</span>
<span class="normal">3747</span>
<span class="normal">3748</span>
<span class="normal">3749</span>
<span class="normal">3750</span>
<span class="normal">3751</span>
<span class="normal">3752</span>
<span class="normal">3753</span>
<span class="normal">3754</span>
<span class="normal">3755</span>
<span class="normal">3756</span>
<span class="normal">3757</span>
<span class="normal">3758</span>
<span class="normal">3759</span>
<span class="normal">3760</span>
<span class="normal">3761</span>
<span class="normal">3762</span>
<span class="normal">3763</span>
<span class="normal">3764</span>
<span class="normal">3765</span>
<span class="normal">3766</span>
<span class="normal">3767</span>
<span class="normal">3768</span>
<span class="normal">3769</span>
<span class="normal">3770</span>
<span class="normal">3771</span>
<span class="normal">3772</span>
<span class="normal">3773</span>
<span class="normal">3774</span>
<span class="normal">3775</span>
<span class="normal">3776</span>
<span class="normal">3777</span>
<span class="normal">3778</span>
<span class="normal">3779</span>
<span class="normal">3780</span>
<span class="normal">3781</span>
<span class="normal">3782</span>
<span class="normal">3783</span>
<span class="normal">3784</span>
<span class="normal">3785</span>
<span class="normal">3786</span>
<span class="normal">3787</span>
<span class="normal">3788</span>
<span class="normal">3789</span>
<span class="normal">3790</span>
<span class="normal">3791</span>
<span class="normal">3792</span>
<span class="normal">3793</span>
<span class="normal">3794</span>
<span class="normal">3795</span>
<span class="normal">3796</span>
<span class="normal">3797</span>
<span class="normal">3798</span>
<span class="normal">3799</span>
<span class="normal">3800</span>
<span class="normal">3801</span>
<span class="normal">3802</span>
<span class="normal">3803</span>
<span class="normal">3804</span>
<span class="normal">3805</span>
<span class="normal">3806</span>
<span class="normal">3807</span>
<span class="normal">3808</span>
<span class="normal">3809</span>
<span class="normal">3810</span>
<span class="normal">3811</span>
<span class="normal">3812</span>
<span class="normal">3813</span>
<span class="normal">3814</span>
<span class="normal">3815</span>
<span class="normal">3816</span>
<span class="normal">3817</span>
<span class="normal">3818</span>
<span class="normal">3819</span>
<span class="normal">3820</span>
<span class="normal">3821</span>
<span class="normal">3822</span>
<span class="normal">3823</span>
<span class="normal">3824</span>
<span class="normal">3825</span>
<span class="normal">3826</span>
<span class="normal">3827</span>
<span class="normal">3828</span>
<span class="normal">3829</span>
<span class="normal">3830</span>
<span class="normal">3831</span>
<span class="normal">3832</span>
<span class="normal">3833</span>
<span class="normal">3834</span>
<span class="normal">3835</span>
<span class="normal">3836</span>
<span class="normal">3837</span>
<span class="normal">3838</span>
<span class="normal">3839</span>
<span class="normal">3840</span>
<span class="normal">3841</span>
<span class="normal">3842</span>
<span class="normal">3843</span>
<span class="normal">3844</span>
<span class="normal">3845</span>
<span class="normal">3846</span>
<span class="normal">3847</span>
<span class="normal">3848</span>
<span class="normal">3849</span>
<span class="normal">3850</span>
<span class="normal">3851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ApertureFactory</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is not actually ever instatiated, but is rather a class used to </span>
<span class="sd">    give a simple constructor interface that is used to construct the most</span>
<span class="sd">    commonly used apertures. It is able to construct hard-edged circular or </span>
<span class="sd">    regular poygonalal apertures. Secondary mirrors obscurations with the same</span>
<span class="sd">    aperture shape can be constructed, along with uniformly spaced struts. </span>
<span class="sd">    Aberrations can also be applied to the aperture. The ratio of the primary</span>
<span class="sd">    aperture opening to the array size is determined by the `aperture_ratio`</span>
<span class="sd">    parameter, with secondary mirror obscurations and struts being scaled</span>
<span class="sd">    relative to the aperture diameter. </span>

<span class="sd">    Lets look at an example of how to construct a simple circular aperture with</span>
<span class="sd">    a secondary mirror obscurtion held by 4 struts and some low-order </span>
<span class="sd">    aberrations. For this example lets take a 2m diameter aperutre, with a 20cm </span>
<span class="sd">    secondary mirror held by 3 struts with a width of 2cm. In this example the</span>
<span class="sd">    secondary mirror is 10% of the primary aperture diameter and the struts are</span>
<span class="sd">    1% of the primary aperture diameter, giving us values of 0.1 and 0.01 for</span>
<span class="sd">    the `secondary_ratio` and `strut_ratio` parameters. Let calcualte this for</span>
<span class="sd">    a 512x512 array with the aperture spanning the full array.</span>

<span class="sd">    ```python</span>
<span class="sd">    from dLux import SimpleAperture</span>
<span class="sd">    import jax.numpy as np</span>
<span class="sd">    import jax.random as jr</span>

<span class="sd">    # Construct Zernikes</span>
<span class="sd">    zernikes = np.arange(4, 11)</span>
<span class="sd">    coefficients = jr.normal(jr.PRNGKey(0), (zernikes.shape[0],))</span>

<span class="sd">    # Construct aperture</span>
<span class="sd">    aperture = SimpleAperture(512, secondary_ratio=0.1, nstruts=4, </span>
<span class="sd">                              strut_ratio=0.01, zernikes=zernikes, </span>
<span class="sd">                              coefficients=coefficients)</span>
<span class="sd">    ```</span>

<span class="sd">    The resulting aperture class has three parameters, `.aperture`, `.basis`</span>
<span class="sd">    and `.coefficients`. We can examine the aperture and opd like so:</span>

<span class="sd">    ```python</span>
<span class="sd">    import matplotlib.pyplot as plt</span>

<span class="sd">    plt.figure(figsize=(10, 5))</span>
<span class="sd">    plt.subplot(1, 2, 1)</span>
<span class="sd">    plt.imshow(aperture.aperture)</span>
<span class="sd">    plt.colorbar()</span>

<span class="sd">    plt.subplot(1, 2, 2)</span>
<span class="sd">    plt.imshow(aperture.opd)</span>
<span class="sd">    plt.colorbar()</span>
<span class="sd">    plt.show()</span>
<span class="sd">    ```</span>

<span class="sd">    We can also easily change this to a hexagonal aperture with 3 struts:</span>

<span class="sd">    ```python</span>
<span class="sd">    # Make aperture</span>
<span class="sd">    aperture = SimpleAperture(512, nsides=6, secondary_ratio=0.1, nstruts=3, </span>
<span class="sd">                              strut_ratio=0.01, zernikes=zernikes, </span>
<span class="sd">                              coefficients=coefficients)</span>

<span class="sd">    # Examine</span>
<span class="sd">    plt.figure(figsize=(10, 5))</span>
<span class="sd">    plt.subplot(1, 2, 1)</span>
<span class="sd">    plt.imshow(aperture.aperture)</span>
<span class="sd">    plt.colorbar()</span>

<span class="sd">    plt.subplot(1, 2, 2)</span>
<span class="sd">    plt.imshow(aperture.opd)</span>
<span class="sd">    plt.colorbar()</span>
<span class="sd">    plt.show()</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span>              <span class="p">:</span> <span class="n">ApertureFactory</span><span class="p">,</span> 
                <span class="n">npixels</span>          <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                <span class="n">nsides</span>           <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">rotation</span>         <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> 

                <span class="c1"># Sizing</span>
                <span class="n">aperture_ratio</span>   <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="n">secondary_ratio</span>  <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
                <span class="n">secondary_nsides</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

                <span class="c1"># Spiders</span>
                <span class="n">nstruts</span>          <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">strut_ratio</span>      <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
                <span class="n">strut_rotation</span>   <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>

                <span class="c1"># Aberrations</span>
                <span class="n">zernikes</span>         <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                <span class="n">coefficients</span>     <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 

                <span class="c1"># name</span>
                <span class="n">name</span>             <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a basic single static aperture, either with or without </span>
<span class="sd">        aberrations.</span>

<span class="sd">        TODO: Add link to the zenike noll indicies</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            Number of pixels used to represent the aperture.</span>
<span class="sd">        nsides : int = 0</span>
<span class="sd">            Number of sides of the aperture. A zero input results in a circular</span>
<span class="sd">            aperture. All other other values of three and above are supported.</span>
<span class="sd">        rotation : float, radians = 0</span>
<span class="sd">            The global rotation of the aperture in radians.</span>
<span class="sd">        aperture_ratio : float = 1.</span>
<span class="sd">            The ratio of the aperture size to the array size. A value of 1. </span>
<span class="sd">            results in an aperture that fully spans the array, a value of 0.5 </span>
<span class="sd">            retuls in an aperure that is half the size of the array, which is </span>
<span class="sd">            equivilent to a padding factor of 2.</span>
<span class="sd">        secondary_ratio : float = 0.</span>
<span class="sd">            The ratio of the secondary mirror obsuration diameter to the </span>
<span class="sd">            aperture diameter. A value of 0. results in no secondary mirror </span>
<span class="sd">            obsuration.</span>
<span class="sd">        secondary_nsides : int = 0</span>
<span class="sd">            The number of sides of the secondary mirror obsuration. A zero input</span>
<span class="sd">            results in a circular aperture. All other other values of three and </span>
<span class="sd">            above are supported.</span>
<span class="sd">        nstruts : int = 0</span>
<span class="sd">            The number of uniformly spaced struts holding the secondary mirror. </span>
<span class="sd">        strut_ratio : float = 0.</span>
<span class="sd">            The ratio of the width of the strut to the aperture diameter.</span>
<span class="sd">        strut_rotation : float = 0</span>
<span class="sd">            The rotation of the struts in radians.</span>
<span class="sd">        zernikes : Array = None</span>
<span class="sd">            The zernike noll indices to be used for the aberrations. Please </span>
<span class="sd">            refer to (this)[Add this link] docstring to see which indicides </span>
<span class="sd">            correspond to which aberrations. Typical values are range(4, 11).</span>
<span class="sd">        coefficients : Array = None</span>
<span class="sd">            The zernike cofficients to be applied to the aberrations. Defaults </span>
<span class="sd">            to an array of zeros.</span>
<span class="sd">        name : str = None</span>
<span class="sd">            The name of the aperture used to index the layers dictionary. If </span>
<span class="sd">            not supplied, the aperture will be named based on the number of</span>
<span class="sd">            sides. However this is only supported up to 8 sides, and a name</span>
<span class="sd">            must be supplied for apertures with more than 8 sides.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture : Union[StaticAperture, StaticAberratedAperture]</span>
<span class="sd">            Returns an appropriately constructed StaticAperture or </span>
<span class="sd">            StaticAberratedAperture, depending on if zernikes are provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check vaid inputs</span>
        <span class="k">if</span> <span class="n">nsides</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">nsides</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nsides must be either 0 or &gt;=3&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">secondary_nsides</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">secondary_nsides</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;secondary_nsides must be either 0 or &gt;=3&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">aperture_ratio</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;aperture_ratio must be &gt; 0&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">secondary_ratio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;secondary_ratio must be &gt;= 0&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">strut_ratio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;strut_ratio must be &gt;= 0&quot;</span><span class="p">)</span>


        <span class="c1"># Auto-name</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nsides</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Warning: Auto-naming not supported for &quot;</span> <span class="o">+</span> \
                <span class="s2">&quot;nsides &gt; 8. Please provide a name.&quot;</span><span class="p">)</span>
            <span class="n">sides</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Circular&quot;</span><span class="p">,</span> <span class="s2">&quot;Triangular&quot;</span><span class="p">,</span> <span class="s2">&quot;Square&quot;</span><span class="p">,</span> <span class="s2">&quot;Pentagonal&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;Hexagonal&quot;</span><span class="p">,</span> <span class="s2">&quot;Heptagonal&quot;</span><span class="p">,</span> <span class="s2">&quot;Octagonal&quot;</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">sides</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">nsides</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">+</span> <span class="s2">&quot;Aperture&quot;</span>


        <span class="c1"># Construct components</span>
        <span class="n">apertures</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Circular Primary</span>
        <span class="k">if</span> <span class="n">nsides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CircularAperture</span><span class="p">(</span><span class="n">aperture_ratio</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="c1"># Polygonal Primary</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegularPolygonalAperture</span><span class="p">(</span>
                <span class="n">nsides</span><span class="p">,</span> <span class="n">aperture_ratio</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">))</span>

        <span class="c1"># Secondary</span>
        <span class="k">if</span> <span class="n">secondary_ratio</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">secondary_rel</span> <span class="o">=</span> <span class="n">aperture_ratio</span> <span class="o">*</span> <span class="n">secondary_ratio</span>

            <span class="c1"># Circular</span>
            <span class="k">if</span> <span class="n">secondary_nsides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CircularAperture</span><span class="p">(</span>
                    <span class="n">secondary_rel</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="c1"># Polygonal</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegularPolygonalAperture</span><span class="p">(</span><span class="n">secondary_nsides</span><span class="p">,</span> 
                    <span class="n">secondary_rel</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">,</span> 
                        <span class="n">occulting</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="c1"># Spiders</span>
        <span class="k">if</span> <span class="n">nstruts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">strut_ratio</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;strut_ratio must be &gt; 0 if nstruts &gt; 0&quot;</span><span class="p">)</span>
            <span class="n">strut_rel</span> <span class="o">=</span> <span class="n">aperture_ratio</span> <span class="o">*</span> <span class="n">strut_ratio</span>
            <span class="n">full_rotation</span> <span class="o">=</span> <span class="n">strut_rotation</span> <span class="o">+</span> <span class="n">rotation</span>
            <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">UniformSpider</span><span class="p">(</span>
                <span class="n">nstruts</span><span class="p">,</span> <span class="n">strut_rel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">full_rotation</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>


        <span class="c1"># Add aberrations and make static</span>
        <span class="k">if</span> <span class="n">zernikes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Construct Aberrations</span>
            <span class="n">apertures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">AberratedAperture</span><span class="p">(</span><span class="n">apertures</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zernikes</span><span class="p">,</span> 
                                                <span class="n">coefficients</span><span class="p">)</span>

            <span class="c1"># Construct CompoundAperture</span>
            <span class="n">full_aperture</span> <span class="o">=</span> <span class="n">CompoundAperture</span><span class="p">(</span><span class="n">apertures</span><span class="p">)</span>
            <span class="n">static</span> <span class="o">=</span> <span class="n">StaticAberratedAperture</span><span class="p">(</span><span class="n">full_aperture</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> 
                                                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Construct CompoundAperture</span>
            <span class="n">full_aperture</span> <span class="o">=</span> <span class="n">CompoundAperture</span><span class="p">(</span><span class="n">apertures</span><span class="p">)</span>
            <span class="n">static</span> <span class="o">=</span> <span class="n">StaticAperture</span><span class="p">(</span><span class="n">full_aperture</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">static</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>             <span class="p">:</span> <span class="n">ApertureFactory</span><span class="p">,</span> 
                 <span class="n">npixels</span>          <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                 <span class="n">nsides</span>           <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="n">rotation</span>         <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> 

                 <span class="c1"># Sizing</span>
                 <span class="n">aperture_ratio</span>   <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                 <span class="n">secondary_ratio</span>  <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
                 <span class="n">secondary_nsides</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

                 <span class="c1"># Spiders</span>
                 <span class="n">nstruts</span>          <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="n">strut_ratio</span>      <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
                 <span class="n">strut_rotation</span>   <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>

                 <span class="c1"># Aberrations</span>
                 <span class="n">zernikes</span>         <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                 <span class="n">coefficients</span>     <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 

                 <span class="c1"># name</span>
                 <span class="n">name</span>             <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a basic single static aperture, either with or without </span>
<span class="sd">        aberrations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npixels : int</span>
<span class="sd">            Number of pixels used to represent the aperture.</span>
<span class="sd">        nsides : int = 0</span>
<span class="sd">            Number of sides of the aperture. A zero input results in a circular</span>
<span class="sd">            aperture. All other other values of three and above are supported.</span>
<span class="sd">        rotation : float, radians = 0</span>
<span class="sd">            The global rotation of the aperture in radians.</span>
<span class="sd">        aperture_ratio : float = 1.</span>
<span class="sd">            The ratio of the aperture size to the array size. A value of 1. </span>
<span class="sd">            results in an aperture that fully spans the array, a value of 0.5 </span>
<span class="sd">            retuls in an aperure that is half the size of the array, which is </span>
<span class="sd">            equivilent to a padding factor of 2.</span>
<span class="sd">        secondary_ratio : float = 0.</span>
<span class="sd">            The ratio of the secondary mirror obsuration diameter to the </span>
<span class="sd">            aperture diameter. A value of 0. results in no secondary mirror </span>
<span class="sd">            obsuration.</span>
<span class="sd">        nstruts : int = 0</span>
<span class="sd">            The number of uniformly spaced struts holding the secondary mirror. </span>
<span class="sd">        strut_ratio : float = 0.</span>
<span class="sd">            The ratio of the width of the strut to the aperture diameter.</span>
<span class="sd">        strut_rotation : float = 0</span>
<span class="sd">            The rotation of the struts in radians.</span>
<span class="sd">        zernikes : Array = None</span>
<span class="sd">            The zernike noll indices to be used for the aberrations. Please </span>
<span class="sd">            refer to (this)[Add this link] docstring to see which indicides </span>
<span class="sd">            correspond to which aberrations. Typical values are range(4, 11).</span>
<span class="sd">        coefficients : Array = None</span>
<span class="sd">            The zernike cofficients to be applied to the aberrations. Defaults </span>
<span class="sd">            to an array of zeros.</span>
<span class="sd">        name : str = None</span>
<span class="sd">            The name of the aperture used to index the layers dictionary. If </span>
<span class="sd">            not supplied, the aperture will be named based on the number of</span>
<span class="sd">            sides. However this is only supported up to 8 sides, and a name</span>
<span class="sd">            must be supplied for apertures with more than 8 sides.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aperture : Union[StaticAperture, StaticAberratedAperture]</span>
<span class="sd">            Returns an appropriately constructed StaticAperture or </span>
<span class="sd">            StaticAberratedAperture, depending on if zernikes are provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.ApertureFactory.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">nsides</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">aperture_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">secondary_ratio</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">secondary_nsides</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nstruts</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">strut_ratio</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">strut_rotation</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">zernikes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.apertures.ApertureFactory.__init__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructs a basic single static aperture, either with or without 
aberrations.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of pixels used to represent the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nsides</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of sides of the aperture. A zero input results in a circular
aperture. All other other values of three and above are supported.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code>float, radians</code>
          </td>
          <td><p>The global rotation of the aperture in radians.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>aperture_ratio</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The ratio of the aperture size to the array size. A value of 1. 
results in an aperture that fully spans the array, a value of 0.5 
retuls in an aperure that is half the size of the array, which is 
equivilent to a padding factor of 2.</p></td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>secondary_ratio</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The ratio of the secondary mirror obsuration diameter to the 
aperture diameter. A value of 0. results in no secondary mirror 
obsuration.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>nstruts</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of uniformly spaced struts holding the secondary mirror.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>strut_ratio</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The ratio of the width of the strut to the aperture diameter.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>strut_rotation</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The rotation of the struts in radians.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>zernikes</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The zernike noll indices to be used for the aberrations. Please 
refer to (this)[Add this link] docstring to see which indicides 
correspond to which aberrations. Typical values are range(4, 11).</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>coefficients</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The zernike cofficients to be applied to the aberrations. Defaults 
to an array of zeros.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the aperture used to index the layers dictionary. If 
not supplied, the aperture will be named based on the number of
sides. However this is only supported up to 8 sides, and a name
must be supplied for apertures with more than 8 sides.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>aperture</code></td>          <td>
                <code>Union[<a class="autorefs autorefs-internal" title="dLux.apertures.StaticAperture" href="#dLux.apertures.StaticAperture">StaticAperture</a>, <a class="autorefs autorefs-internal" title="dLux.apertures.StaticAberratedAperture" href="#dLux.apertures.StaticAberratedAperture">StaticAberratedAperture</a>]</code>
          </td>
          <td><p>Returns an appropriately constructed StaticAperture or 
StaticAberratedAperture, depending on if zernikes are provided.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3784</span>
<span class="normal">3785</span>
<span class="normal">3786</span>
<span class="normal">3787</span>
<span class="normal">3788</span>
<span class="normal">3789</span>
<span class="normal">3790</span>
<span class="normal">3791</span>
<span class="normal">3792</span>
<span class="normal">3793</span>
<span class="normal">3794</span>
<span class="normal">3795</span>
<span class="normal">3796</span>
<span class="normal">3797</span>
<span class="normal">3798</span>
<span class="normal">3799</span>
<span class="normal">3800</span>
<span class="normal">3801</span>
<span class="normal">3802</span>
<span class="normal">3803</span>
<span class="normal">3804</span>
<span class="normal">3805</span>
<span class="normal">3806</span>
<span class="normal">3807</span>
<span class="normal">3808</span>
<span class="normal">3809</span>
<span class="normal">3810</span>
<span class="normal">3811</span>
<span class="normal">3812</span>
<span class="normal">3813</span>
<span class="normal">3814</span>
<span class="normal">3815</span>
<span class="normal">3816</span>
<span class="normal">3817</span>
<span class="normal">3818</span>
<span class="normal">3819</span>
<span class="normal">3820</span>
<span class="normal">3821</span>
<span class="normal">3822</span>
<span class="normal">3823</span>
<span class="normal">3824</span>
<span class="normal">3825</span>
<span class="normal">3826</span>
<span class="normal">3827</span>
<span class="normal">3828</span>
<span class="normal">3829</span>
<span class="normal">3830</span>
<span class="normal">3831</span>
<span class="normal">3832</span>
<span class="normal">3833</span>
<span class="normal">3834</span>
<span class="normal">3835</span>
<span class="normal">3836</span>
<span class="normal">3837</span>
<span class="normal">3838</span>
<span class="normal">3839</span>
<span class="normal">3840</span>
<span class="normal">3841</span>
<span class="normal">3842</span>
<span class="normal">3843</span>
<span class="normal">3844</span>
<span class="normal">3845</span>
<span class="normal">3846</span>
<span class="normal">3847</span>
<span class="normal">3848</span>
<span class="normal">3849</span>
<span class="normal">3850</span>
<span class="normal">3851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span>             <span class="p">:</span> <span class="n">ApertureFactory</span><span class="p">,</span> 
             <span class="n">npixels</span>          <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
             <span class="n">nsides</span>           <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">rotation</span>         <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> 

             <span class="c1"># Sizing</span>
             <span class="n">aperture_ratio</span>   <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
             <span class="n">secondary_ratio</span>  <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="n">secondary_nsides</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

             <span class="c1"># Spiders</span>
             <span class="n">nstruts</span>          <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">strut_ratio</span>      <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="n">strut_rotation</span>   <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>

             <span class="c1"># Aberrations</span>
             <span class="n">zernikes</span>         <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
             <span class="n">coefficients</span>     <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 

             <span class="c1"># name</span>
             <span class="n">name</span>             <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs a basic single static aperture, either with or without </span>
<span class="sd">    aberrations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        Number of pixels used to represent the aperture.</span>
<span class="sd">    nsides : int = 0</span>
<span class="sd">        Number of sides of the aperture. A zero input results in a circular</span>
<span class="sd">        aperture. All other other values of three and above are supported.</span>
<span class="sd">    rotation : float, radians = 0</span>
<span class="sd">        The global rotation of the aperture in radians.</span>
<span class="sd">    aperture_ratio : float = 1.</span>
<span class="sd">        The ratio of the aperture size to the array size. A value of 1. </span>
<span class="sd">        results in an aperture that fully spans the array, a value of 0.5 </span>
<span class="sd">        retuls in an aperure that is half the size of the array, which is </span>
<span class="sd">        equivilent to a padding factor of 2.</span>
<span class="sd">    secondary_ratio : float = 0.</span>
<span class="sd">        The ratio of the secondary mirror obsuration diameter to the </span>
<span class="sd">        aperture diameter. A value of 0. results in no secondary mirror </span>
<span class="sd">        obsuration.</span>
<span class="sd">    nstruts : int = 0</span>
<span class="sd">        The number of uniformly spaced struts holding the secondary mirror. </span>
<span class="sd">    strut_ratio : float = 0.</span>
<span class="sd">        The ratio of the width of the strut to the aperture diameter.</span>
<span class="sd">    strut_rotation : float = 0</span>
<span class="sd">        The rotation of the struts in radians.</span>
<span class="sd">    zernikes : Array = None</span>
<span class="sd">        The zernike noll indices to be used for the aberrations. Please </span>
<span class="sd">        refer to (this)[Add this link] docstring to see which indicides </span>
<span class="sd">        correspond to which aberrations. Typical values are range(4, 11).</span>
<span class="sd">    coefficients : Array = None</span>
<span class="sd">        The zernike cofficients to be applied to the aberrations. Defaults </span>
<span class="sd">        to an array of zeros.</span>
<span class="sd">    name : str = None</span>
<span class="sd">        The name of the aperture used to index the layers dictionary. If </span>
<span class="sd">        not supplied, the aperture will be named based on the number of</span>
<span class="sd">        sides. However this is only supported up to 8 sides, and a name</span>
<span class="sd">        must be supplied for apertures with more than 8 sides.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    aperture : Union[StaticAperture, StaticAberratedAperture]</span>
<span class="sd">        Returns an appropriately constructed StaticAperture or </span>
<span class="sd">        StaticAberratedAperture, depending on if zernikes are provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="dLux.apertures.ApertureFactory.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="n">npixels</span><span class="p">,</span> <span class="n">nsides</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">aperture_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">secondary_ratio</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">secondary_nsides</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nstruts</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">strut_ratio</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">strut_rotation</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">zernikes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coefficients</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dLux.apertures.ApertureFactory.__new__" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">
  
      <p>Constructs a basic single static aperture, either with or without 
aberrations.</p>
<p>TODO: Add link to the zenike noll indicies</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>npixels</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of pixels used to represent the aperture.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>nsides</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of sides of the aperture. A zero input results in a circular
aperture. All other other values of three and above are supported.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code>float, radians</code>
          </td>
          <td><p>The global rotation of the aperture in radians.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>aperture_ratio</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The ratio of the aperture size to the array size. A value of 1. 
results in an aperture that fully spans the array, a value of 0.5 
retuls in an aperure that is half the size of the array, which is 
equivilent to a padding factor of 2.</p></td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>secondary_ratio</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The ratio of the secondary mirror obsuration diameter to the 
aperture diameter. A value of 0. results in no secondary mirror 
obsuration.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>secondary_nsides</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of sides of the secondary mirror obsuration. A zero input
results in a circular aperture. All other other values of three and 
above are supported.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>nstruts</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of uniformly spaced struts holding the secondary mirror.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>strut_ratio</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The ratio of the width of the strut to the aperture diameter.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>strut_rotation</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The rotation of the struts in radians.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>zernikes</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The zernike noll indices to be used for the aberrations. Please 
refer to (this)[Add this link] docstring to see which indicides 
correspond to which aberrations. Typical values are range(4, 11).</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>coefficients</code></td>
          <td>
                <code><span title="dLux.apertures.Array">Array</span></code>
          </td>
          <td><p>The zernike cofficients to be applied to the aberrations. Defaults 
to an array of zeros.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the aperture used to index the layers dictionary. If 
not supplied, the aperture will be named based on the number of
sides. However this is only supported up to 8 sides, and a name
must be supplied for apertures with more than 8 sides.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>aperture</code></td>          <td>
                <code>Union[<a class="autorefs autorefs-internal" title="dLux.apertures.StaticAperture" href="#dLux.apertures.StaticAperture">StaticAperture</a>, <a class="autorefs autorefs-internal" title="dLux.apertures.StaticAberratedAperture" href="#dLux.apertures.StaticAberratedAperture">StaticAberratedAperture</a>]</code>
          </td>
          <td><p>Returns an appropriately constructed StaticAperture or 
StaticAberratedAperture, depending on if zernikes are provided.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>dLux/apertures.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span>
<span class="normal">3639</span>
<span class="normal">3640</span>
<span class="normal">3641</span>
<span class="normal">3642</span>
<span class="normal">3643</span>
<span class="normal">3644</span>
<span class="normal">3645</span>
<span class="normal">3646</span>
<span class="normal">3647</span>
<span class="normal">3648</span>
<span class="normal">3649</span>
<span class="normal">3650</span>
<span class="normal">3651</span>
<span class="normal">3652</span>
<span class="normal">3653</span>
<span class="normal">3654</span>
<span class="normal">3655</span>
<span class="normal">3656</span>
<span class="normal">3657</span>
<span class="normal">3658</span>
<span class="normal">3659</span>
<span class="normal">3660</span>
<span class="normal">3661</span>
<span class="normal">3662</span>
<span class="normal">3663</span>
<span class="normal">3664</span>
<span class="normal">3665</span>
<span class="normal">3666</span>
<span class="normal">3667</span>
<span class="normal">3668</span>
<span class="normal">3669</span>
<span class="normal">3670</span>
<span class="normal">3671</span>
<span class="normal">3672</span>
<span class="normal">3673</span>
<span class="normal">3674</span>
<span class="normal">3675</span>
<span class="normal">3676</span>
<span class="normal">3677</span>
<span class="normal">3678</span>
<span class="normal">3679</span>
<span class="normal">3680</span>
<span class="normal">3681</span>
<span class="normal">3682</span>
<span class="normal">3683</span>
<span class="normal">3684</span>
<span class="normal">3685</span>
<span class="normal">3686</span>
<span class="normal">3687</span>
<span class="normal">3688</span>
<span class="normal">3689</span>
<span class="normal">3690</span>
<span class="normal">3691</span>
<span class="normal">3692</span>
<span class="normal">3693</span>
<span class="normal">3694</span>
<span class="normal">3695</span>
<span class="normal">3696</span>
<span class="normal">3697</span>
<span class="normal">3698</span>
<span class="normal">3699</span>
<span class="normal">3700</span>
<span class="normal">3701</span>
<span class="normal">3702</span>
<span class="normal">3703</span>
<span class="normal">3704</span>
<span class="normal">3705</span>
<span class="normal">3706</span>
<span class="normal">3707</span>
<span class="normal">3708</span>
<span class="normal">3709</span>
<span class="normal">3710</span>
<span class="normal">3711</span>
<span class="normal">3712</span>
<span class="normal">3713</span>
<span class="normal">3714</span>
<span class="normal">3715</span>
<span class="normal">3716</span>
<span class="normal">3717</span>
<span class="normal">3718</span>
<span class="normal">3719</span>
<span class="normal">3720</span>
<span class="normal">3721</span>
<span class="normal">3722</span>
<span class="normal">3723</span>
<span class="normal">3724</span>
<span class="normal">3725</span>
<span class="normal">3726</span>
<span class="normal">3727</span>
<span class="normal">3728</span>
<span class="normal">3729</span>
<span class="normal">3730</span>
<span class="normal">3731</span>
<span class="normal">3732</span>
<span class="normal">3733</span>
<span class="normal">3734</span>
<span class="normal">3735</span>
<span class="normal">3736</span>
<span class="normal">3737</span>
<span class="normal">3738</span>
<span class="normal">3739</span>
<span class="normal">3740</span>
<span class="normal">3741</span>
<span class="normal">3742</span>
<span class="normal">3743</span>
<span class="normal">3744</span>
<span class="normal">3745</span>
<span class="normal">3746</span>
<span class="normal">3747</span>
<span class="normal">3748</span>
<span class="normal">3749</span>
<span class="normal">3750</span>
<span class="normal">3751</span>
<span class="normal">3752</span>
<span class="normal">3753</span>
<span class="normal">3754</span>
<span class="normal">3755</span>
<span class="normal">3756</span>
<span class="normal">3757</span>
<span class="normal">3758</span>
<span class="normal">3759</span>
<span class="normal">3760</span>
<span class="normal">3761</span>
<span class="normal">3762</span>
<span class="normal">3763</span>
<span class="normal">3764</span>
<span class="normal">3765</span>
<span class="normal">3766</span>
<span class="normal">3767</span>
<span class="normal">3768</span>
<span class="normal">3769</span>
<span class="normal">3770</span>
<span class="normal">3771</span>
<span class="normal">3772</span>
<span class="normal">3773</span>
<span class="normal">3774</span>
<span class="normal">3775</span>
<span class="normal">3776</span>
<span class="normal">3777</span>
<span class="normal">3778</span>
<span class="normal">3779</span>
<span class="normal">3780</span>
<span class="normal">3781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span>              <span class="p">:</span> <span class="n">ApertureFactory</span><span class="p">,</span> 
            <span class="n">npixels</span>          <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
            <span class="n">nsides</span>           <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">rotation</span>         <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> 

            <span class="c1"># Sizing</span>
            <span class="n">aperture_ratio</span>   <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="n">secondary_ratio</span>  <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
            <span class="n">secondary_nsides</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

            <span class="c1"># Spiders</span>
            <span class="n">nstruts</span>          <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">strut_ratio</span>      <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
            <span class="n">strut_rotation</span>   <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>

            <span class="c1"># Aberrations</span>
            <span class="n">zernikes</span>         <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">coefficients</span>     <span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 

            <span class="c1"># name</span>
            <span class="n">name</span>             <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs a basic single static aperture, either with or without </span>
<span class="sd">    aberrations.</span>

<span class="sd">    TODO: Add link to the zenike noll indicies</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npixels : int</span>
<span class="sd">        Number of pixels used to represent the aperture.</span>
<span class="sd">    nsides : int = 0</span>
<span class="sd">        Number of sides of the aperture. A zero input results in a circular</span>
<span class="sd">        aperture. All other other values of three and above are supported.</span>
<span class="sd">    rotation : float, radians = 0</span>
<span class="sd">        The global rotation of the aperture in radians.</span>
<span class="sd">    aperture_ratio : float = 1.</span>
<span class="sd">        The ratio of the aperture size to the array size. A value of 1. </span>
<span class="sd">        results in an aperture that fully spans the array, a value of 0.5 </span>
<span class="sd">        retuls in an aperure that is half the size of the array, which is </span>
<span class="sd">        equivilent to a padding factor of 2.</span>
<span class="sd">    secondary_ratio : float = 0.</span>
<span class="sd">        The ratio of the secondary mirror obsuration diameter to the </span>
<span class="sd">        aperture diameter. A value of 0. results in no secondary mirror </span>
<span class="sd">        obsuration.</span>
<span class="sd">    secondary_nsides : int = 0</span>
<span class="sd">        The number of sides of the secondary mirror obsuration. A zero input</span>
<span class="sd">        results in a circular aperture. All other other values of three and </span>
<span class="sd">        above are supported.</span>
<span class="sd">    nstruts : int = 0</span>
<span class="sd">        The number of uniformly spaced struts holding the secondary mirror. </span>
<span class="sd">    strut_ratio : float = 0.</span>
<span class="sd">        The ratio of the width of the strut to the aperture diameter.</span>
<span class="sd">    strut_rotation : float = 0</span>
<span class="sd">        The rotation of the struts in radians.</span>
<span class="sd">    zernikes : Array = None</span>
<span class="sd">        The zernike noll indices to be used for the aberrations. Please </span>
<span class="sd">        refer to (this)[Add this link] docstring to see which indicides </span>
<span class="sd">        correspond to which aberrations. Typical values are range(4, 11).</span>
<span class="sd">    coefficients : Array = None</span>
<span class="sd">        The zernike cofficients to be applied to the aberrations. Defaults </span>
<span class="sd">        to an array of zeros.</span>
<span class="sd">    name : str = None</span>
<span class="sd">        The name of the aperture used to index the layers dictionary. If </span>
<span class="sd">        not supplied, the aperture will be named based on the number of</span>
<span class="sd">        sides. However this is only supported up to 8 sides, and a name</span>
<span class="sd">        must be supplied for apertures with more than 8 sides.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    aperture : Union[StaticAperture, StaticAberratedAperture]</span>
<span class="sd">        Returns an appropriately constructed StaticAperture or </span>
<span class="sd">        StaticAberratedAperture, depending on if zernikes are provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check vaid inputs</span>
    <span class="k">if</span> <span class="n">nsides</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">nsides</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nsides must be either 0 or &gt;=3&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">secondary_nsides</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">secondary_nsides</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;secondary_nsides must be either 0 or &gt;=3&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">aperture_ratio</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;aperture_ratio must be &gt; 0&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">secondary_ratio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;secondary_ratio must be &gt;= 0&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">strut_ratio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;strut_ratio must be &gt;= 0&quot;</span><span class="p">)</span>


    <span class="c1"># Auto-name</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nsides</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Warning: Auto-naming not supported for &quot;</span> <span class="o">+</span> \
            <span class="s2">&quot;nsides &gt; 8. Please provide a name.&quot;</span><span class="p">)</span>
        <span class="n">sides</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Circular&quot;</span><span class="p">,</span> <span class="s2">&quot;Triangular&quot;</span><span class="p">,</span> <span class="s2">&quot;Square&quot;</span><span class="p">,</span> <span class="s2">&quot;Pentagonal&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Hexagonal&quot;</span><span class="p">,</span> <span class="s2">&quot;Heptagonal&quot;</span><span class="p">,</span> <span class="s2">&quot;Octagonal&quot;</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">sides</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">nsides</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">+</span> <span class="s2">&quot;Aperture&quot;</span>


    <span class="c1"># Construct components</span>
    <span class="n">apertures</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Circular Primary</span>
    <span class="k">if</span> <span class="n">nsides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CircularAperture</span><span class="p">(</span><span class="n">aperture_ratio</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="c1"># Polygonal Primary</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegularPolygonalAperture</span><span class="p">(</span>
            <span class="n">nsides</span><span class="p">,</span> <span class="n">aperture_ratio</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">))</span>

    <span class="c1"># Secondary</span>
    <span class="k">if</span> <span class="n">secondary_ratio</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">secondary_rel</span> <span class="o">=</span> <span class="n">aperture_ratio</span> <span class="o">*</span> <span class="n">secondary_ratio</span>

        <span class="c1"># Circular</span>
        <span class="k">if</span> <span class="n">secondary_nsides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CircularAperture</span><span class="p">(</span>
                <span class="n">secondary_rel</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">occulting</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="c1"># Polygonal</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegularPolygonalAperture</span><span class="p">(</span><span class="n">secondary_nsides</span><span class="p">,</span> 
                <span class="n">secondary_rel</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">,</span> 
                    <span class="n">occulting</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="c1"># Spiders</span>
    <span class="k">if</span> <span class="n">nstruts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">strut_ratio</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;strut_ratio must be &gt; 0 if nstruts &gt; 0&quot;</span><span class="p">)</span>
        <span class="n">strut_rel</span> <span class="o">=</span> <span class="n">aperture_ratio</span> <span class="o">*</span> <span class="n">strut_ratio</span>
        <span class="n">full_rotation</span> <span class="o">=</span> <span class="n">strut_rotation</span> <span class="o">+</span> <span class="n">rotation</span>
        <span class="n">apertures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">UniformSpider</span><span class="p">(</span>
            <span class="n">nstruts</span><span class="p">,</span> <span class="n">strut_rel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">full_rotation</span><span class="p">,</span> <span class="n">softening</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>


    <span class="c1"># Add aberrations and make static</span>
    <span class="k">if</span> <span class="n">zernikes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Construct Aberrations</span>
        <span class="n">apertures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">AberratedAperture</span><span class="p">(</span><span class="n">apertures</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zernikes</span><span class="p">,</span> 
                                            <span class="n">coefficients</span><span class="p">)</span>

        <span class="c1"># Construct CompoundAperture</span>
        <span class="n">full_aperture</span> <span class="o">=</span> <span class="n">CompoundAperture</span><span class="p">(</span><span class="n">apertures</span><span class="p">)</span>
        <span class="n">static</span> <span class="o">=</span> <span class="n">StaticAberratedAperture</span><span class="p">(</span><span class="n">full_aperture</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> 
                                            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Construct CompoundAperture</span>
        <span class="n">full_aperture</span> <span class="o">=</span> <span class="n">CompoundAperture</span><span class="p">(</span><span class="n">apertures</span><span class="p">)</span>
        <span class="n">static</span> <span class="o">=</span> <span class="n">StaticAperture</span><span class="p">(</span><span class="n">full_aperture</span><span class="p">,</span> <span class="n">npixels</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">static</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 data-role="class" id="dLux.apertures.ApertureFactory"><a class="headerlink" href="#dLux.apertures.ApertureFactory" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.ApertureFactory.__init__"><a class="headerlink" href="#dLux.apertures.ApertureFactory.__init__" title="Permanent link">¤</a></h2>
<h2 class="doc doc-heading" data-role="function" id="dLux.apertures.ApertureFactory.__new__"><a class="headerlink" href="#dLux.apertures.ApertureFactory.__new__" title="Permanent link">¤</a></h2>
</div>
</details>
<p>Lets look at an example of how to construct a simple circular aperture with a secondary mirror obscurtion held by 4 struts and some low-order aberrations. For this example lets take a 2m diameter aperutre, with a 20cm secondary mirror held by 3 struts with a width of 2cm. In this example the secondary mirror is 10% of the primary aperture diameter and the struts are 1% of the primary aperture diameter, giving us values of 0.1 and 0.01 for the secondary_ratio and strut_ratio parameters. Let calcualte this for a 512x512 array with the aperture spanning the full array.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">dLux</span> <span class="k">as</span> <span class="nn">dl</span>
<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span><span class="p">,</span> <span class="n">random</span> <span class="k">as</span> <span class="n">jr</span>

<span class="c1"># Construct Zernikes</span>
<span class="n">zernikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">zernikes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>

<span class="c1"># Construct aperture</span>
<span class="n">aperture</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">ApertureFactory</span><span class="p">(</span>
    <span class="n">npixels</span>         <span class="o">=</span> <span class="mi">512</span><span class="p">,</span>
    <span class="n">secondary_ratio</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> 
    <span class="n">nstruts</span>         <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> 
    <span class="n">strut_ratio</span>     <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> 
    <span class="n">zernikes</span>        <span class="o">=</span> <span class="n">zernikes</span><span class="p">,</span> 
    <span class="n">coefficients</span>    <span class="o">=</span> <span class="n">coefficients</span><span class="p">,</span>
    <span class="n">name</span>            <span class="o">=</span> <span class="s1">&#39;Aperture&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">aperture</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span> <span class="n">StaticAberratedAperture</span><span class="p">(</span>
<span class="o">&gt;</span>   <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Aperture&#39;</span><span class="p">,</span>
<span class="o">&gt;</span>   <span class="n">aperture</span><span class="o">=</span><span class="n">f32</span><span class="p">[</span><span class="mi">512</span><span class="p">,</span><span class="mi">512</span><span class="p">],</span>
<span class="o">&gt;</span>   <span class="n">coefficients</span><span class="o">=</span><span class="n">f32</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>
<span class="o">&gt;</span>   <span class="n">basis</span><span class="o">=</span><span class="n">f32</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">512</span><span class="p">]</span>
<span class="o">&gt;</span> <span class="p">)</span>
</code></pre></div>
<p>As we can see the resulting aperture class has three parameters, <code>aperture</code>, <code>basis</code> and <code>coefficients</code>. Lets have a look at the resulting aperture and aberrations.</p>
<details class="abstract">
<summary>Plotting code</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">aperture</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aperture</span><span class="o">.</span><span class="n">opd</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;assets/aperture_factory.png&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<p><img alt="aperture_factory" src="../../assets/aperture_factory.png" /></p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "content.code.copy", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>